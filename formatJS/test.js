(function(E0,r0){var m0=E0.document,g=(function(){var I=function(_,A){return new I.fn.init(_,A,B);},C=E0.jQuery,H=E0.$,B,N=/^(?:[^<]*(<[\w\W]+>)[^>]*$|#([\w\-]+)$)/,d=/\S/,O=/^\s+/,R=/\s+$/,S=/\d/,G=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,J=/^[\],:{}\s]*$/,c=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,T=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,Z=/(?:^|:|,)(?:\s*\[)+/g,b=/(webkit)[ \/]([\w.]+)/,F=/(opera)(?:.*version)?[ \/]([\w.]+)/,M=/(msie) ([\w.]+)/,a=/(mozilla)(?:.*? rv:([\w.]+))?/,U=navigator.userAgent,_,e=false,V,Q="then done fail isResolved isRejected promise".split(" "),X,E=Object.prototype.toString,L=Object.prototype.hasOwnProperty,W=Array.prototype.push,P=Array.prototype.slice,D=String.prototype.trim,A=Array.prototype.indexOf,Y={};I.fn=I.prototype={constructor:I,init:function(D,E,C){var _,B,F,A;if(!D){return this;}if(D.nodeType){this.context=this[0]=D;this.length=1;return this;}if(D==="body"&&!E&&m0.body){this.context=m0;this[0]=m0.body;this.selector="body";this.length=1;return this;}if(typeof D==="string"){_=N.exec(D);if(_&&(_[1]||!E)){if(_[1]){E=E instanceof I?E[0]:E;A=(E?E.ownerDocument||E:m0);F=G.exec(D);if(F){if(I.isPlainObject(E)){D=[m0.createElement(F[1])];I.fn.attr.call(D,E,true);}else{D=[A.createElement(F[1])];}}else{F=I.buildFragment([_[1]],[A]);D=(F.cacheable?I.clone(F.fragment):F.fragment).childNodes;}return I.merge(this,D);}else{B=m0.getElementById(_[2]);if(B&&B.parentNode){if(B.id!==_[2]){return C.find(D);}this.length=1;this[0]=B;}this.context=m0;this.selector=D;return this;}}else{if(!E||E.jquery){return(E||C).find(D);}else{return this.constructor(E).find(D);}}}else{if(I.isFunction(D)){return C.ready(D);}}if(D.selector!==r0){this.selector=D.selector;this.context=D.context;}return I.makeArray(D,this);},selector:"",jquery:"1.5.1",length:0,size:function(){return this.length;},toArray:function(){return P.call(this,0);},get:function(_){return _==null?this.toArray():(_<0?this[this.length+_]:this[_]);},pushStack:function(A,C,_){var B=this.constructor();if(I.isArray(A)){W.apply(B,A);}else{I.merge(B,A);}B.prevObject=this;B.context=this.context;if(C==="find"){B.selector=this.selector+(this.selector?" ":"")+_;}else{if(C){B.selector=this.selector+"."+C+"("+_+")";}}return B;},each:function(_,A){return I.each(this,_,A);},ready:function(_){I.bindReady();V.done(_);return this;},eq:function(_){return _===-1?this.slice(_):this.slice(_,+_+1);},first:function(){return this.eq(0);},last:function(){return this.eq(-1);},slice:function(){return this.pushStack(P.apply(this,arguments),"slice",P.call(arguments).join(","));},map:function(_){return this.pushStack(I.map(this,function(B,A){return _.call(B,A,B);}));},end:function(){return this.prevObject||this.constructor(null);},push:W,sort:[].sort,splice:[].splice};I.fn.init.prototype=I.fn;I.extend=I.fn.extend=function(){var J,H,D,C,G,E,B=arguments[0]||{},_=1,A=arguments.length,F=false;if(typeof B==="boolean"){F=B;B=arguments[1]||{};_=2;}if(typeof B!=="object"&&!I.isFunction(B)){B={};}if(A===_){B=this;--_;}for(;_<A;_++){if((J=arguments[_])!=null){for(H in J){D=B[H];C=J[H];if(B===C){continue;}if(F&&C&&(I.isPlainObject(C)||(G=I.isArray(C)))){if(G){G=false;E=D&&I.isArray(D)?D:[];}else{E=D&&I.isPlainObject(D)?D:{};}B[H]=I.extend(F,E,C);}else{if(C!==r0){B[H]=C;}}}}}return B;};I.extend({noConflict:function(_){E0.$=H;if(_){E0.jQuery=C;}return I;},isReady:false,readyWait:1,ready:function(_){if(_===true){I.readyWait--;}if(!I.readyWait||(_!==true&&!I.isReady)){if(!m0.body){return setTimeout(I.ready,1);}I.isReady=true;if(_!==true&&--I.readyWait>0){return;}V.resolveWith(m0,[I]);if(I.fn.trigger){I(m0).trigger("ready").unbind("ready");}}},bindReady:function(){if(e){return;}e=true;if(m0.readyState==="complete"){return setTimeout(I.ready,1);}if(m0.addEventListener){m0.addEventListener("DOMContentLoaded",X,false);E0.addEventListener("load",I.ready,false);}else{if(m0.attachEvent){m0.attachEvent("onreadystatechange",X);E0.attachEvent("onload",I.ready);var _=false;try{_=E0.frameElement==null;}catch(A){}if(m0.documentElement.doScroll&&_){K();}}}},isFunction:function(_){return I.type(_)==="function";},isArray:Array.isArray||function(_){return I.type(_)==="array";},isWindow:function(_){return _&&typeof _==="object"&&"setInterval"in _;},isNaN:function(_){return _==null||!S.test(_)||isNaN(_);},type:function(_){return _==null?String(_):Y[E.call(_)]||"object";},isPlainObject:function(A){if(!A||I.type(A)!=="object"||A.nodeType||I.isWindow(A)){return false;}if(A.constructor&&!L.call(A,"constructor")&&!L.call(A.constructor.prototype,"isPrototypeOf")){return false;}var _;for(_ in A){}return _===r0||L.call(A,_);},isEmptyObject:function(_){for(var A in _){return false;}return true;},error:function(_){throw _;},parseJSON:function(_){if(typeof _!=="string"||!_){return null;}_=I.trim(_);if(J.test(_.replace(c,"@").replace(T,"]").replace(Z,""))){return E0.JSON&&E0.JSON.parse?E0.JSON.parse(_):(new Function("return "+_))();}else{I.error("Invalid JSON: "+_);}},parseXML:function(A,B,_){if(E0.DOMParser){_=new DOMParser();B=_.parseFromString(A,"text/xml");}else{B=new ActiveXObject("Microsoft.XMLDOM");B.async="false";B.loadXML(A);}_=B.documentElement;if(!_||!_.nodeName||_.nodeName==="parsererror"){I.error("Invalid XML: "+A);}return B;},noop:function(){},globalEval:function(A){if(A&&d.test(A)){var B=m0.head||m0.getElementsByTagName("head")[0]||m0.documentElement,_=m0.createElement("script");if(I.support.scriptEval()){_.appendChild(m0.createTextNode(A));}else{_.text=A;}B.insertBefore(_,B.firstChild);B.removeChild(_);}},nodeName:function(_,A){return _.nodeName&&_.nodeName.toUpperCase()===A.toUpperCase();},each:function(A,C,F){var G,_=0,E=A.length,D=E===r0||I.isFunction(A);if(F){if(D){for(G in A){if(C.apply(A[G],F)===false){break;}}}else{for(;_<E;){if(C.apply(A[_++],F)===false){break;}}}}else{if(D){for(G in A){if(C.call(A[G],G,A[G])===false){break;}}}else{for(var B=A[0];_<E&&C.call(B,_,B)!==false;B=A[++_]){}}}return A;},trim:D?function(_){return _==null?"":D.call(_);}:function(_){return _==null?"":_.toString().replace(O,"").replace(R,"");},makeArray:function(C,B){var A=B||[];if(C!=null){var _=I.type(C);if(C.length==null||_==="string"||_==="function"||_==="regexp"||I.isWindow(C)){W.call(A,C);}else{I.merge(A,C);}}return A;},inArray:function(A,C){if(C.indexOf){return C.indexOf(A);}for(var _=0,B=C.length;_<B;_++){if(C[_]===A){return _;}}return-1;},merge:function(B,D){var _=B.length,A=0;if(typeof D.length==="number"){for(var C=D.length;A<C;A++){B[_++]=D[A];}}else{while(D[A]!==r0){B[_++]=D[A++];}}B.length=_;return B;},grep:function(E,A,C){var F=[],B;C=!!C;for(var _=0,D=E.length;_<D;_++){B=!!A(E[_],_);if(C!==B){F.push(E[_]);}}return F;},map:function(E,C,A){var F=[],B;for(var _=0,D=E.length;_<D;_++){B=C(E[_],_,A);if(B!=null){F[F.length]=B;}}return F.concat.apply([],F);},guid:1,proxy:function(B,A,_){if(arguments.length===2){if(typeof A==="string"){_=B;B=_[A];A=r0;}else{if(A&&!I.isFunction(A)){_=A;A=r0;}}}if(!A&&B){A=function(){return B.apply(_||this,arguments);};}if(B){A.guid=B.guid=B.guid||A.guid||I.guid++;}return A;},access:function(F,_,C,D,H,G){var E=F.length;if(typeof _==="object"){for(var B in _){I.access(F,B,_[B],D,H,C);}return F;}if(C!==r0){D=!G&&D&&I.isFunction(C);for(var A=0;A<E;A++){H(F[A],_,D?C.call(F[A],A,H(F[A],_)):C,G);}return F;}return E?H(F[0],_):r0;},now:function(){return(new Date()).getTime();},_Deferred:function(){var B=[],D,C,A,_={done:function(){if(!A){var H=arguments,C,G,E,F,J;if(D){J=D;D=0;}for(C=0,G=H.length;C<G;C++){E=H[C];F=I.type(E);if(F==="array"){_.done.apply(_,E);}else{if(F==="function"){B.push(E);}}}if(J){_.resolveWith(J[0],J[1]);}}return this;},resolveWith:function(E,_){if(!A&&!D&&!C){C=1;try{while(B[0]){B.shift().apply(E,_);}}finally{D=[E,_];C=0;}}return this;},resolve:function(){_.resolveWith(I.isFunction(this.promise)?this.promise():this,arguments);return this;},isResolved:function(){return!!(C||D);},cancel:function(){A=1;B=[];return this;}};return _;},Deferred:function(C){var _=I._Deferred(),B=I._Deferred(),A;I.extend(_,{then:function(A,B){_.done(A).fail(B);return this;},fail:B.done,rejectWith:B.resolveWith,reject:B.resolve,isRejected:B.isResolved,promise:function(C){if(C==null){if(A){return A;}A=C={};}var B=Q.length;while(B--){C[Q[B]]=_[Q[B]];}return C;}});_.done(B.cancel).fail(_.cancel);delete _.cancel;if(C){C.call(_,_);}return _;},when:function(A){var D=arguments.length,_=D<=1&&A&&I.isFunction(A.promise)?A:I.Deferred(),B=_.promise();if(D>1){var F=P.call(arguments,0),E=D,C=function(A){return function(C){F[A]=arguments.length>1?P.call(arguments,0):C;if(!(--E)){_.resolveWith(B,F);}};};while((D--)){A=F[D];if(A&&I.isFunction(A.promise)){A.promise().then(C(D),_.reject);}else{--E;}}if(!E){_.resolveWith(B,F);}}else{if(_!==A){_.resolve(A);}}return B;},uaMatch:function(A){A=A.toLowerCase();var _=b.exec(A)||F.exec(A)||M.exec(A)||A.indexOf("compatible")<0&&a.exec(A)||[];return{browser:_[1]||"",version:_[2]||"0"};},sub:function(){function _(A,B){return new _.fn.init(A,B);}I.extend(true,_,this);_.superclass=this;_.fn=_.prototype=this();_.fn.constructor=_;_.subclass=this.subclass;_.fn.init=function A(C,D){if(D&&D instanceof I&&!(D instanceof _)){D=_(D);}return I.fn.init.call(this,C,D,B);};_.fn.init.prototype=_.fn;var B=_(m0);return _;},browser:{}});V=I._Deferred();I.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(_,A){Y["[object "+A+"]"]=A.toLowerCase();});_=I.uaMatch(U);if(_.browser){I.browser[_.browser]=true;I.browser.version=_.version;}if(I.browser.webkit){I.browser.safari=true;}if(A){I.inArray=function(_,B){return A.call(B,_);};}if(d.test("\xa0")){O=/^[\s\xA0]+/;R=/[\s\xA0]+$/;}B=I(m0);if(m0.addEventListener){X=function(){m0.removeEventListener("DOMContentLoaded",X,false);I.ready();};}else{if(m0.attachEvent){X=function(){if(m0.readyState==="complete"){m0.detachEvent("onreadystatechange",X);I.ready();}};}}function K(){if(I.isReady){return;}try{m0.documentElement.doScroll("left");}catch(_){setTimeout(K,1);return;}I.ready();}return I;})();(function(){g.support={};var A=m0.createElement("div");A.style.display="none";A.innerHTML="   <link/><table></table><a href='/a' style='color:red;float:left;opacity:.55;'>a</a><input type='checkbox'/>";var D=A.getElementsByTagName("*"),C=A.getElementsByTagName("a")[0],J=m0.createElement("select"),E=J.appendChild(m0.createElement("option")),_=A.getElementsByTagName("input")[0];if(!D||!D.length||!C){return;}g.support={leadingWhitespace:A.firstChild.nodeType===3,tbody:!A.getElementsByTagName("tbody").length,htmlSerialize:!!A.getElementsByTagName("link").length,style:/red/.test(C.getAttribute("style")),hrefNormalized:C.getAttribute("href")==="/a",opacity:/^0.55$/.test(C.style.opacity),cssFloat:!!C.style.cssFloat,checkOn:_.value==="on",optSelected:E.selected,deleteExpando:true,optDisabled:false,checkClone:false,noCloneEvent:true,noCloneChecked:true,boxModel:null,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableHiddenOffsets:true};_.checked=true;g.support.noCloneChecked=_.cloneNode(true).checked;J.disabled=true;g.support.optDisabled=!E.disabled;var G=null;g.support.scriptEval=function(){if(G===null){var A=m0.documentElement,_=m0.createElement("script"),B="script"+g.now();try{_.appendChild(m0.createTextNode("window."+B+"=1;"));}catch(C){}A.insertBefore(_,A.firstChild);if(E0[B]){G=true;delete E0[B];}else{G=false;}A.removeChild(_);A=_=B=null;}return G;};try{delete A.test;}catch(I){g.support.deleteExpando=false;}if(!A.addEventListener&&A.attachEvent&&A.fireEvent){A.attachEvent("onclick",function F(){g.support.noCloneEvent=false;A.detachEvent("onclick",F);});A.cloneNode(true).fireEvent("onclick");}A=m0.createElement("div");A.innerHTML="<input type='radio' name='radiotest' checked='checked'/>";var B=m0.createDocumentFragment();B.appendChild(A.firstChild);g.support.checkClone=B.cloneNode(true).cloneNode(true).lastChild.checked;g(function(){var _=m0.createElement("div"),B=m0.getElementsByTagName("body")[0];if(!B){return;}_.style.width=_.style.paddingLeft="1px";B.appendChild(_);g.boxModel=g.support.boxModel=_.offsetWidth===2;if("zoom"in _.style){_.style.display="inline";_.style.zoom=1;g.support.inlineBlockNeedsLayout=_.offsetWidth===2;_.style.display="";_.innerHTML="<div style='width:4px;'></div>";g.support.shrinkWrapBlocks=_.offsetWidth!==2;}_.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";var A=_.getElementsByTagName("td");g.support.reliableHiddenOffsets=A[0].offsetHeight===0;A[0].style.display="";A[1].style.display="none";g.support.reliableHiddenOffsets=g.support.reliableHiddenOffsets&&A[0].offsetHeight===0;_.innerHTML="";B.removeChild(_).style.display="none";_=A=null;});var H=function(B){var A=m0.createElement("div");B="on"+B;if(!A.attachEvent){return true;}var _=(B in A);if(!_){A.setAttribute(B,"return;");_=typeof A[B]==="function";}A=null;return _;};g.support.submitBubbles=H("submit");g.support.changeBubbles=H("change");A=D=C=null;})();var p0=/^(?:\{.*\}|\[.*\])$/;g.extend({cache:{},uuid:0,expando:"jQuery"+(g.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(_){_=_.nodeType?g.cache[_[g.expando]]:_[g.expando];return!!_&&!l0(_);},data:function(C,H,F,A){if(!g.acceptData(C)){return;}var E=g.expando,G=typeof H==="string",B,D=C.nodeType,_=D?g.cache:C,I=D?C[g.expando]:C[g.expando]&&g.expando;if((!I||(A&&I&&!_[I][E]))&&G&&F===r0){return;}if(!I){if(D){C[g.expando]=I=++g.uuid;}else{I=g.expando;}}if(!_[I]){_[I]={};if(!D){_[I].toJSON=g.noop;}}if(typeof H==="object"||typeof H==="function"){if(A){_[I][E]=g.extend(_[I][E],H);}else{_[I]=g.extend(_[I],H);}}B=_[I];if(A){if(!B[E]){B[E]={};}B=B[E];}if(F!==r0){B[H]=F;}if(H==="events"&&!B[H]){return B[E]&&B[E].events;}return G?B[H]:B;},removeData:function(D,G,B){if(!g.acceptData(D)){return;}var F=g.expando,E=D.nodeType,_=E?g.cache:D,H=E?D[g.expando]:g.expando;if(!_[H]){return;}if(G){var C=B?_[H][F]:_[H];if(C){delete C[G];if(!l0(C)){return;}}}if(B){delete _[H][F];if(!l0(_[H])){return;}}var A=_[H][F];if(g.support.deleteExpando||_!=E0){delete _[H];}else{_[H]=null;}if(A){_[H]={};if(!E){_[H].toJSON=g.noop;}_[H][F]=A;}else{if(E){if(g.support.deleteExpando){delete D[g.expando];}else{if(D.removeAttribute){D.removeAttribute(g.expando);}else{D[g.expando]=null;}}}}},_data:function(_,B,A){return g.data(_,B,A,true);},acceptData:function(A){if(A.nodeName){var _=g.noData[A.nodeName.toLowerCase()];if(_){return!(_===true||A.getAttribute("classid")!==_);}}return true;}});g.fn.extend({data:function(A,C){var D=null;if(typeof A==="undefined"){if(this.length){D=g.data(this[0]);if(this[0].nodeType===1){var E=this[0].attributes,G;for(var B=0,F=E.length;B<F;B++){G=E[B].name;if(G.indexOf("data-")===0){G=G.substr(5);T0(this[0],G,D[G]);}}}}return D;}else{if(typeof A==="object"){return this.each(function(){g.data(this,A);});}}var _=A.split(".");_[1]=_[1]?"."+_[1]:"";if(C===r0){D=this.triggerHandler("getData"+_[1]+"!",[_[0]]);if(D===r0&&this.length){D=g.data(this[0],A);D=T0(this[0],A,D);}return D===r0&&_[1]?this.data(_[0]):D;}else{return this.each(function(){var D=g(this),B=[_[0],C];D.triggerHandler("setData"+_[1]+"!",B);g.data(this,A,C);D.triggerHandler("changeData"+_[1]+"!",B);});}},removeData:function(_){return this.each(function(){g.removeData(this,_);});}});function T0(A,_,B){if(B===r0&&A.nodeType===1){B=A.getAttribute("data-"+_);if(typeof B==="string"){try{B=B==="true"?true:B==="false"?false:B==="null"?null:!g.isNaN(B)?parseFloat(B):p0.test(B)?g.parseJSON(B):B;}catch(C){}g.data(A,_,B);}else{B=r0;}}return B;}function l0(_){for(var A in _){if(A!=="toJSON"){return false;}}return true;}g.extend({queue:function(_,A,B){if(!_){return;}A=(A||"fx")+"queue";var C=g._data(_,A);if(!B){return C||[];}if(!C||g.isArray(B)){C=g._data(_,A,g.makeArray(B));}else{C.push(B);}return C;},dequeue:function(_,A){A=A||"fx";var B=g.queue(_,A),C=B.shift();if(C==="inprogress"){C=B.shift();}if(C){if(A==="fx"){B.unshift("inprogress");}C.call(_,function(){g.dequeue(_,A);});}if(!B.length){g.removeData(_,A+"queue",true);}}});g.fn.extend({queue:function(_,A){if(typeof _!=="string"){A=_;_="fx";}if(A===r0){return g.queue(this[0],_);}return this.each(function(B){var C=g.queue(this,_,A);if(_==="fx"&&C[0]!=="inprogress"){g.dequeue(this,_);}});},dequeue:function(_){return this.each(function(){g.dequeue(this,_);});},delay:function(A,_){A=g.fx?g.fx.speeds[A]||A:A;_=_||"fx";return this.queue(_,function(){var B=this;setTimeout(function(){g.dequeue(B,_);},A);});},clearQueue:function(_){return this.queue(_||"fx",[]);}});var L=/[\n\t\r]/g,Z=/\s+/,y0=/\r/g,c=/^(?:href|src|style)$/,F1=/^(?:button|input)$/i,X0=/^(?:button|input|object|select|textarea)$/i,w=/^a(?:rea)?$/i,Z0=/^(?:radio|checkbox)$/i;g.props={"for":"htmlFor","class":"className",readonly:"readOnly",maxlength:"maxLength",cellspacing:"cellSpacing",rowspan:"rowSpan",colspan:"colSpan",tabindex:"tabIndex",usemap:"useMap",frameborder:"frameBorder"};g.fn.extend({attr:function(A,_){return g.access(this,A,_,true,g.attr);},removeAttr:function(_,A){return this.each(function(){g.attr(this,_,"");if(this.nodeType===1){this.removeAttribute(_);}});},addClass:function(D){if(g.isFunction(D)){return this.each(function(_){var A=g(this);A.addClass(D.call(this,_,A.attr("class")));});}if(D&&typeof D==="string"){var C=(D||"").split(Z);for(var _=0,G=this.length;_<G;_++){var B=this[_];if(B.nodeType===1){if(!B.className){B.className=D;}else{var F=" "+B.className+" ",H=B.className;for(var E=0,A=C.length;E<A;E++){if(F.indexOf(" "+C[E]+" ")<0){H+=" "+C[E];}}B.className=g.trim(H);}}}}return this;},removeClass:function(D){if(g.isFunction(D)){return this.each(function(_){var A=g(this);A.removeClass(D.call(this,_,A.attr("class")));});}if((D&&typeof D==="string")||D===r0){var C=(D||"").split(Z);for(var _=0,G=this.length;_<G;_++){var B=this[_];if(B.nodeType===1&&B.className){if(D){var F=(" "+B.className+" ").replace(L," ");for(var E=0,A=C.length;E<A;E++){F=F.replace(" "+C[E]+" "," ");}B.className=g.trim(F);}else{B.className="";}}}}return this;},toggleClass:function(_,B){var A=typeof _,C=typeof B==="boolean";if(g.isFunction(_)){return this.each(function(A){var C=g(this);C.toggleClass(_.call(this,A,C.attr("class"),B),B);});}return this.each(function(){if(A==="string"){var H,D=0,F=g(this),G=B,E=_.split(Z);while((H=E[D++])){G=C?G:!F.hasClass(H);F[G?"addClass":"removeClass"](H);}}else{if(A==="undefined"||A==="boolean"){if(this.className){g._data(this,"__className__",this.className);}this.className=this.className||_===false?"":g._data(this,"__className__")||"";}}});},hasClass:function(A){var B=" "+A+" ";for(var _=0,C=this.length;_<C;_++){if((" "+this[_].className+" ").replace(L," ").indexOf(B)>-1){return true;}}return false;},val:function(E){if(!arguments.length){var D=this[0];if(D){if(g.nodeName(D,"option")){var C=D.attributes.value;return!C||C.specified?D.value:D.text;}if(g.nodeName(D,"select")){var _=D.selectedIndex,G=[],J=D.options,B=D.type==="select-one";if(_<0){return null;}for(var A=B?_:0,H=B?_+1:J.length;A<H;A++){var F=J[A];if(F.selected&&(g.support.optDisabled?!F.disabled:F.getAttribute("disabled")===null)&&(!F.parentNode.disabled||!g.nodeName(F.parentNode,"optgroup"))){E=g(F).val();if(B){return E;}G.push(E);}}if(B&&!G.length&&J.length){return g(J[_]).val();}return G;}if(Z0.test(D.type)&&!g.support.checkOn){return D.getAttribute("value")===null?"on":D.value;}return(D.value||"").replace(y0,"");}return r0;}var I=g.isFunction(E);return this.each(function(A){var B=g(this),_=E;if(this.nodeType!==1){return;}if(I){_=E.call(this,A,B.val());}if(_==null){_="";}else{if(typeof _==="number"){_+="";}else{if(g.isArray(_)){_=g.map(_,function(_){return _==null?"":_+"";});}}}if(g.isArray(_)&&Z0.test(this.type)){this.checked=g.inArray(B.val(),_)>=0;}else{if(g.nodeName(this,"select")){var C=g.makeArray(_);g("option",this).each(function(){this.selected=g.inArray(g(this).val(),C)>=0;});if(!C.length){this.selectedIndex=-1;}}else{this.value=_;}}});}});g.extend({attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(B,H,A,F){if(!B||B.nodeType===3||B.nodeType===8||B.nodeType===2){return r0;}if(F&&H in g.attrFn){return g(B)[H](A);}var E=B.nodeType!==1||!g.isXMLDoc(B),D=A!==r0;H=E&&g.props[H]||H;if(B.nodeType===1){var C=c.test(H);if(H==="selected"&&!g.support.optSelected){var I=B.parentNode;if(I){I.selectedIndex;if(I.parentNode){I.parentNode.selectedIndex;}}}if((H in B||B[H]!==r0)&&E&&!C){if(D){if(H==="type"&&F1.test(B.nodeName)&&B.parentNode){g.error("type property can't be changed");}if(A===null){if(B.nodeType===1){B.removeAttribute(H);}}else{B[H]=A;}}if(g.nodeName(B,"form")&&B.getAttributeNode(H)){return B.getAttributeNode(H).nodeValue;}if(H==="tabIndex"){var _=B.getAttributeNode("tabIndex");return _&&_.specified?_.value:X0.test(B.nodeName)||w.test(B.nodeName)&&B.href?0:r0;}return B[H];}if(!g.support.style&&E&&H==="style"){if(D){B.style.cssText=""+A;}return B.style.cssText;}if(D){B.setAttribute(H,""+A);}if(!B.attributes[H]&&(B.hasAttribute&&!B.hasAttribute(H))){return r0;}var G=!g.support.hrefNormalized&&E&&C?B.getAttribute(H,2):B.getAttribute(H);return G===null?r0:G;}if(D){B[H]=A;}return B[H];}});var j0=/\.(.*)$/,f0=/^(?:textarea|input|select)$/i,u0=/\./g,V0=/ /g,Y0=/[^\w\s.|`]/g,K0=function(_){return _.replace(Y0,"\\$&");};g.event={add:function(A,C,B,N){if(A.nodeType===3||A.nodeType===8){return;}try{if(g.isWindow(A)&&(A!==E0&&!A.frameElement)){A=E0;}}catch(O){}if(B===false){B=H;}else{if(!B){return;}}var M,G;if(B.handler){M=B;B=M.handler;}if(!B.guid){B.guid=g.guid++;}var J=g._data(A);if(!J){return;}var _=J.events,D=J.handle;if(!_){J.events=_={};}if(!D){J.handle=D=function(){return typeof g!=="undefined"&&!g.event.triggered?g.event.handle.apply(D.elem,arguments):r0;};}D.elem=A;C=C.split(" ");var F,K=0,I;while((F=C[K++])){G=M?g.extend({},M):{handler:B,data:N};if(F.indexOf(".")>-1){I=F.split(".");F=I.shift();G.namespace=I.slice(0).sort().join(".");}else{I=[];G.namespace="";}G.type=F;if(!G.guid){G.guid=B.guid;}var L=_[F],E=g.event.special[F]||{};if(!L){L=_[F]=[];if(!E.setup||E.setup.call(A,N,I,D)===false){if(A.addEventListener){A.addEventListener(F,D,false);}else{if(A.attachEvent){A.attachEvent("on"+F,D);}}}}if(E.add){E.add.call(A,G);if(!G.handler.guid){G.handler.guid=B.guid;}}L.push(G);g.event.global[F]=true;}A=null;},global:{},remove:function(C,E,D,N){if(C.nodeType===3||C.nodeType===8){return;}if(D===false){D=H;}var R,G,L,P,M=0,O,J,A,F,S,I,Q,K=g.hasData(C)&&g._data(C),B=K&&K.events;if(!K||!B){return;}if(E&&E.type){D=E.handler;E=E.type;}if(!E||typeof E==="string"&&E.charAt(0)==="."){E=E||"";for(G in B){g.event.remove(C,G+E);}return;}E=E.split(" ");while((G=E[M++])){Q=G;I=null;O=G.indexOf(".")<0;J=[];if(!O){J=G.split(".");G=J.shift();A=new RegExp("(^|\\.)"+g.map(J.slice(0).sort(),K0).join("\\.(?:.*\\.)?")+"(\\.|$)");}S=B[G];if(!S){continue;}if(!D){for(P=0;P<S.length;P++){I=S[P];if(O||A.test(I.namespace)){g.event.remove(C,Q,I.handler,P);S.splice(P--,1);}}continue;}F=g.event.special[G]||{};for(P=N||0;P<S.length;P++){I=S[P];if(D.guid===I.guid){if(O||A.test(I.namespace)){if(N==null){S.splice(P--,1);}if(F.remove){F.remove.call(C,I);}}if(N!=null){break;}}}if(S.length===0||N!=null&&S.length===1){if(!F.teardown||F.teardown.call(C,J)===false){g.removeEvent(C,G,K.handle);}R=null;delete B[G];}}if(g.isEmptyObject(B)){var _=K.handle;if(_){_.elem=null;}delete K.events;delete K.handle;if(g.isEmptyObject(K)){g.removeData(C,r0,true);}}},trigger:function(L,K,A){var E=L.type||L,B=arguments[3];if(!B){L=typeof L==="object"?L[g.expando]?L:g.extend(g.Event(E),L):g.Event(E);if(E.indexOf("!")>=0){L.type=E=E.slice(0,-1);L.exclusive=true;}if(!A){L.stopPropagation();if(g.event.global[E]){g.each(g.cache,function(){var A=g.expando,_=this[A];if(_&&_.events&&_.events[E]){g.event.trigger(L,K,_.handle.elem);}});}}if(!A||A.nodeType===3||A.nodeType===8){return r0;}L.result=r0;L.target=A;K=g.makeArray(K);K.unshift(L);}L.currentTarget=A;var _=g._data(A,"handle");if(_){_.apply(A,K);}var M=A.parentNode||A.ownerDocument;try{if(!(A&&A.nodeName&&g.noData[A.nodeName.toLowerCase()])){if(A["on"+E]&&A["on"+E].apply(A,K)===false){L.result=false;L.preventDefault();}}}catch(I){}if(!L.isPropagationStopped()&&M){g.event.trigger(L,K,M,true);}else{if(!L.isDefaultPrevented()){var J,G=L.target,C=E.replace(j0,""),D=g.nodeName(G,"a")&&C==="click",F=g.event.special[C]||{};if((!F._default||F._default.call(A,L)===false)&&!D&&!(G&&G.nodeName&&g.noData[G.nodeName.toLowerCase()])){try{if(G[C]){J=G["on"+C];if(J){G["on"+C]=null;}g.event.triggered=true;G[C]();}}catch(H){}if(J){G["on"+C]=J;}g.event.triggered=false;}}}},handle:function(I){var H,G,C,D,_,F=[],A=g.makeArray(arguments);I=A[0]=g.event.fix(I||E0.event);I.currentTarget=this;H=I.type.indexOf(".")<0&&!I.exclusive;if(!H){C=I.type.split(".");I.type=C.shift();F=C.slice(0).sort();D=new RegExp("(^|\\.)"+F.join("\\.(?:.*\\.)?")+"(\\.|$)");}I.namespace=I.namespace||F.join(".");_=g._data(this,"events");G=(_||{})[I.type];if(_&&G){G=G.slice(0);for(var J=0,E=G.length;J<E;J++){var B=G[J];if(H||D.test(B.namespace)){I.handler=B.handler;I.data=B.data;I.handleObj=B;var K=B.handler.apply(this,A);if(K!==r0){I.result=K;if(K===false){I.preventDefault();I.stopPropagation();}}if(I.isImmediatePropagationStopped()){break;}}}}return I.result;},props:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode layerX layerY metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),propschrome:"altKey attrChange attrName bubbles button cancelable charCode clientX clientY ctrlKey currentTarget data detail eventPhase fromElement handler keyCode metaKey newValue offsetX offsetY pageX pageY prevValue relatedNode relatedTarget screenX screenY shiftKey srcElement target toElement view wheelDelta which".split(" "),fix:function(D){if(D[g.expando]){return D;}var C=D;D=g.Event(C);if(g.browser.webkit){this.props=this.propschrome;}for(var A=this.props.length,B;A;){B=this.props[--A];D[B]=C[B];}if(!D.target){D.target=D.srcElement||m0;}if(D.target.nodeType===3){D.target=D.target.parentNode;}if(!D.relatedTarget&&D.fromElement){D.relatedTarget=D.fromElement===D.target?D.toElement:D.fromElement;}if(D.pageX==null&&D.clientX!=null){var _=m0.documentElement,E=m0.body;D.pageX=D.clientX+(_&&_.scrollLeft||E&&E.scrollLeft||0)-(_&&_.clientLeft||E&&E.clientLeft||0);D.pageY=D.clientY+(_&&_.scrollTop||E&&E.scrollTop||0)-(_&&_.clientTop||E&&E.clientTop||0);}if(D.which==null&&(D.charCode!=null||D.keyCode!=null)){D.which=D.charCode!=null?D.charCode:D.keyCode;}if(!D.metaKey&&D.ctrlKey){D.metaKey=D.ctrlKey;}if(!D.which&&D.button!==r0){D.which=(D.button&1?1:(D.button&2?3:(D.button&4?2:0)));}return D;},guid:100000000,proxy:g.proxy,special:{ready:{setup:g.bindReady,teardown:g.noop},live:{add:function(_){g.event.add(this,j(_.origType,_.selector),g.extend({},_,{handler:z0,guid:_.handler.guid}));},remove:function(_){g.event.remove(this,j(_.origType,_.selector),_);}},beforeunload:{setup:function(A,B,_){if(g.isWindow(this)){this.onbeforeunload=_;}},teardown:function(A,_){if(this.onbeforeunload===_){this.onbeforeunload=null;}}}}};g.removeEvent=m0.removeEventListener?function(A,B,_){if(A.removeEventListener){A.removeEventListener(B,_,false);}}:function(A,B,_){if(A.detachEvent){A.detachEvent("on"+B,_);}};g.Event=function(_){if(!this.preventDefault){return new g.Event(_);}if(_&&_.type){this.originalEvent=_;this.type=_.type;this.isDefaultPrevented=(_.defaultPrevented||_.returnValue===false||_.getPreventDefault&&_.getPreventDefault())?G0:H;}else{this.type=_;}this.timeStamp=g.now();this[g.expando]=true;};function H(){return false;}function G0(){return true;}g.Event.prototype={preventDefault:function(){this.isDefaultPrevented=G0;var _=this.originalEvent;if(!_){return;}if(_.preventDefault){_.preventDefault();}else{_.returnValue=false;}},stopPropagation:function(){this.isPropagationStopped=G0;var _=this.originalEvent;if(!_){return;}if(_.stopPropagation){_.stopPropagation();}_.cancelBubble=true;},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=G0;this.stopPropagation();},isDefaultPrevented:H,isPropagationStopped:H,isImmediatePropagationStopped:H};var e0=function(_){var A=_.relatedTarget;try{if(A!==m0&&!A.parentNode){return;}while(A&&A!==this){A=A.parentNode;}if(A!==this){_.type=_.data;g.event.handle.apply(this,arguments);}}catch(B){}},s=function(_){_.type=_.data;g.event.handle.apply(this,arguments);};g.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(A,_){g.event.special[A]={setup:function(B){g.event.add(this,_,B&&B.selector?s:e0,A);},teardown:function(A){g.event.remove(this,_,A&&A.selector?s:e0);}};});if(!g.support.submitBubbles){g.event.special.submit={setup:function(_,A){if(this.nodeName&&this.nodeName.toLowerCase()!=="form"){g.event.add(this,"click.specialSubmit",function(B){var _=B.target,A=_.type;if((A==="submit"||A==="image")&&g(_).closest("form").length){a("submit",this,arguments);}});g.event.add(this,"keypress.specialSubmit",function(B){var _=B.target,A=_.type;if((A==="text"||A==="password")&&g(_).closest("form").length&&B.keyCode===13){a("submit",this,arguments);}});}else{return false;}},teardown:function(_){g.event.remove(this,".specialSubmit");}};}if(!g.support.changeBubbles){var B0,M0=function(A){var B=A.type,_=A.value;if(B==="radio"||B==="checkbox"){_=A.checked;}else{if(B==="select-multiple"){_=A.selectedIndex>-1?g.map(A.options,function(_){return _.selected;}).join("-"):"";}else{if(A.nodeName.toLowerCase()==="select"){_=A.selectedIndex;}}}return _;},E=function E(C){var A=C.target,B,_;if(!f0.test(A.nodeName)||A.readOnly){return;}B=g._data(A,"_change_data");_=M0(A);if(C.type!=="focusout"||A.type!=="radio"){g._data(A,"_change_data",_);}if(B===r0||_===B){return;}if(B!=null||_){C.type="change";C.liveFired=r0;g.event.trigger(C,arguments[1],A);}};g.event.special.change={filters:{focusout:E,beforedeactivate:E,click:function(B){var _=B.target,A=_.type;if(A==="radio"||A==="checkbox"||_.nodeName.toLowerCase()==="select"){E.call(this,B);}},keydown:function(B){var _=B.target,A=_.type;if((B.keyCode===13&&_.nodeName.toLowerCase()!=="textarea")||(B.keyCode===32&&(A==="checkbox"||A==="radio"))||A==="select-multiple"){E.call(this,B);}},beforeactivate:function(A){var _=A.target;g._data(_,"_change_data",M0(_));}},setup:function(A,B){if(this.type==="file"){return false;}for(var _ in B0){g.event.add(this,_+".specialChange",B0[_]);}return f0.test(this.nodeName);},teardown:function(_){g.event.remove(this,".specialChange");return f0.test(this.nodeName);}};B0=g.event.special.change.filters;B0.focus=B0.beforeactivate;}function a(A,_,B){var C=g.extend({},B[0]);C.type=A;C.originalEvent={};C.liveFired=r0;g.event.handle.call(_,C);if(C.isDefaultPrevented()){B[0].preventDefault();}}if(m0.addEventListener){g.each({focus:"focusin",blur:"focusout"},function(B,A){g.event.special[A]={setup:function(){this.addEventListener(B,_,true);},teardown:function(){this.removeEventListener(B,_,true);}};function _(_){_=g.event.fix(_);_.type=A;return g.event.handle.call(this,_);}});}g.each(["bind","one"],function(_,A){g.fn[A]=function(D,E,G){if(typeof D==="object"){for(var _ in D){this[A](_,E,D[_],G);}return this;}if(g.isFunction(E)||E===false){G=E;E=r0;}var C=A==="one"?g.proxy(G,function(_){g(this).unbind(_,C);return G.apply(this,arguments);}):G;if(D==="unload"&&A!=="one"){this.one(D,E,G);}else{for(var B=0,F=this.length;B<F;B++){g.event.add(this[B],D,C,E);}}return this;};});g.fn.extend({unbind:function(B,D){if(typeof B==="object"&&!B.preventDefault){for(var _ in B){this.unbind(_,B[_]);}}else{for(var A=0,C=this.length;A<C;A++){g.event.remove(this[A],B,D);}}return this;},delegate:function(A,_,B,C){return this.live(_,B,C,A);},undelegate:function(A,_,B){if(arguments.length===0){return this.unbind("live");}else{return this.die(_,null,B,A);}},trigger:function(_,A){return this.each(function(){g.event.trigger(_,A,this);});},triggerHandler:function(_,A){if(this[0]){var B=g.Event(_);B.preventDefault();B.stopPropagation();g.event.trigger(B,A,this[0]);return B.result;}},toggle:function(B){var A=arguments,_=1;while(_<A.length){g.proxy(B,A[_++]);}return this.click(g.proxy(B,function(D){var C=(g._data(this,"lastToggle"+B.guid)||0)%_;g._data(this,"lastToggle"+B.guid,C+1);D.preventDefault();return A[C].apply(this,arguments)||false;}));},hover:function(_,A){return this.mouseenter(_).mouseleave(A||_);}});var S0={focus:"focusin",blur:"focusout",mouseenter:"mouseover",mouseleave:"mouseout"};g.each(["live","die"],function(_,A){g.fn[A]=function(_,L,G,K){var C,J=0,H,E,D,B=K||this.selector,M=K?this:g(this.context);if(typeof _==="object"&&!_.preventDefault){for(var I in _){M[A](I,L,_[I],B);}return this;}if(g.isFunction(L)){G=L;L=r0;}_=(_||"").split(" ");while((C=_[J++])!=null){H=j0.exec(C);E="";if(H){E=H[0];C=C.replace(j0,"");}if(C==="hover"){_.push("mouseenter"+E,"mouseleave"+E);continue;}D=C;if(C==="focus"||C==="blur"){_.push(S0[C]+E);C=C+E;}else{C=(S0[C]||C)+E;}if(A==="live"){for(var N=0,F=M.length;N<F;N++){g.event.add(M[N],"live."+j(C,B),{data:L,selector:B,handler:G,origType:C,origHandler:G,preType:D});}}else{M.unbind("live."+j(C,B),G);}}return this;};});function z0(O){var K,I,G,J,D,B,P,L,F,N,C,_,Q,M=[],H=[],A=g._data(this,"events");if(O.liveFired===this||!A||!A.live||O.target.disabled||O.button&&O.type==="click"){return;}if(O.namespace){_=new RegExp("(^|\\.)"+O.namespace.split(".").join("\\.(?:.*\\.)?")+"(\\.|$)");}O.liveFired=this;var E=A.live.slice(0);for(P=0;P<E.length;P++){D=E[P];if(D.origType.replace(j0,"")===O.type){H.push(D.selector);}else{E.splice(P--,1);}}J=g(O.target).closest(H,O.currentTarget);for(L=0,F=J.length;L<F;L++){C=J[L];for(P=0;P<E.length;P++){D=E[P];if(C.selector===D.selector&&(!_||_.test(D.namespace))&&!C.elem.disabled){B=C.elem;G=null;if(D.preType==="mouseenter"||D.preType==="mouseleave"){O.type=D.preType;G=g(O.relatedTarget).closest(D.selector)[0];}if(!G||G!==B){M.push({elem:B,handleObj:D,level:C.level});}}}}for(L=0,F=M.length;L<F;L++){J=M[L];if(I&&J.level>I){break;}O.currentTarget=J.elem;O.data=J.handleObj.data;O.handleObj=J.handleObj;Q=J.handleObj.origHandler.apply(J.elem,arguments);if(Q===false||O.isPropagationStopped()){I=J.level;if(Q===false){K=false;}if(O.isImmediatePropagationStopped()){break;}}}return K;}function j(A,_){return(A&&A!=="*"?A+".":"")+_.replace(u0,"`").replace(V0,"&");}g.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error").split(" "),function(_,A){g.fn[A]=function(_,B){if(B==null){B=_;_=null;}return arguments.length>0?this.bind(A,_,B):this.trigger(A);};if(g.attrFn){g.attrFn[A]=true;}});(function(){var J=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,F=0,E=Object.prototype.toString,R=false,B=true,P=/\\/g,C=/\W/;[0,0].sort(function(){B=false;return 0;});var _=function(C,R,H,U){H=H||[];R=R||m0;var W=R;if(R.nodeType!==1&&R.nodeType!==9){return[];}if(!C||typeof C!=="string"){return H;}var P,Q,V,F,S,D,T,N,G=true,M=_.isXML(R),A=[],B=C;do{J.exec("");P=J.exec(B);if(P){B=P[3];A.push(P[1]);if(P[2]){F=P[3];break;}}}while(P);if(A.length>1&&K.exec(C)){if(A.length===2&&O.relative[A[0]]){Q=L(A[0]+A[1],R);}else{Q=O.relative[A[0]]?[R]:_(A.shift(),R);while(A.length){C=A.shift();if(O.relative[C]){C+=A.shift();}Q=L(C,Q);}}}else{if(!U&&A.length>1&&R.nodeType===9&&!M&&O.match.ID.test(A[0])&&!O.match.ID.test(A[A.length-1])){S=_.find(A.shift(),R,M);R=S.expr?_.filter(S.expr,S.set)[0]:S.set[0];}if(R){S=U?{expr:A.pop(),set:I(U)}:_.find(A.pop(),A.length===1&&(A[0]==="~"||A[0]==="+")&&R.parentNode?R.parentNode:R,M);Q=S.expr?_.filter(S.expr,S.set):S.set;if(A.length>0){V=I(Q);}else{G=false;}while(A.length){D=A.pop();T=D;if(!O.relative[D]){D="";}else{T=A.pop();}if(T==null){T=R;}O.relative[D](V,T,M);}}else{V=A=[];}}if(!V){V=Q;}if(!V){_.error(D||C);}if(E.call(V)==="[object Array]"){if(!G){H.push.apply(H,V);}else{if(R&&R.nodeType===1){for(N=0;V[N]!=null;N++){if(V[N]&&(V[N]===true||V[N].nodeType===1&&_.contains(R,V[N]))){H.push(Q[N]);}}}else{for(N=0;V[N]!=null;N++){if(V[N]&&V[N].nodeType===1){H.push(Q[N]);}}}}}else{I(V,H);}if(F){_(F,W,H,U);_.uniqueSort(H);}return H;};_.uniqueSort=function(A){if(H){R=B;A.sort(H);if(R){for(var _=1;_<A.length;_++){if(A[_]===A[_-1]){A.splice(_--,1);}}}}return A;};_.matches=function(A,B){return _(A,null,null,B);};_.matchesSelector=function(B,A){return _(A,null,null,[B]).length>0;};_.find=function(B,F,H){var E;if(!B){return[];}for(var A=0,G=O.order.length;A<G;A++){var _,C=O.order[A];if((_=O.leftMatch[C].exec(B))){var D=_[1];_.splice(1,1);if(D.substr(D.length-1)!=="\\"){_[1]=(_[1]||"").replace(P,"");E=O.find[C](_,F,H);if(E!=null){B=B.replace(O.match[C],"");break;}}}}if(!E){E=typeof F.getElementsByTagName!=="undefined"?F.getElementsByTagName("*"):[];}return{set:E,expr:B};};_.filter=function(J,N,G,D){var H,R,K=J,P=[],Q=N,L=N&&N[0]&&_.isXML(N[0]);while(J&&N.length){for(var B in O.filter){if((H=O.leftMatch[B].exec(J))!=null&&H[2]){var E,A,F=O.filter[B],M=H[1];R=false;H.splice(1,1);if(M.substr(M.length-1)==="\\"){continue;}if(Q===P){P=[];}if(O.preFilter[B]){H=O.preFilter[B](H,Q,G,P,D,L);if(!H){R=E=true;}else{if(H===true){continue;}}}if(H){for(var I=0;(A=Q[I])!=null;I++){if(A){E=F(A,H,I,Q);var C=D^!!E;if(G&&E!=null){if(C){R=true;}else{Q[I]=false;}}else{if(C){P.push(A);R=true;}}}}}if(E!==r0){if(!G){Q=P;}J=J.replace(O.match[B],"");if(!R){return[];}break;}}}if(J===K){if(R==null){_.error(J);}else{break;}}K=J;}return Q;};_.error=function(_){throw"Syntax error, unrecognized expression: "+_;};var O=_.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(_){return _.getAttribute("href");},type:function(_){return _.getAttribute("type");}},relative:{"+":function(I,G){var D=typeof G==="string",F=D&&!C.test(G),A=D&&!F;if(F){G=G.toLowerCase();}for(var B=0,H=I.length,E;B<H;B++){if((E=I[B])){while((E=E.previousSibling)&&E.nodeType!==1){}I[B]=A||E&&E.nodeName.toLowerCase()===G?E||false:E===G;}}if(A){_.filter(G,I,true);}},">":function(G,E){var D,B=typeof E==="string",A=0,F=G.length;if(B&&!C.test(E)){E=E.toLowerCase();for(;A<F;A++){D=G[A];if(D){var H=D.parentNode;G[A]=H.nodeName.toLowerCase()===E?H:false;}}}else{for(;A<F;A++){D=G[A];if(D){G[A]=B?D.parentNode:D.parentNode===E;}}if(B){_.filter(E,G,true);}}},"":function(E,B,H){var A,D=F++,_=G;if(typeof B==="string"&&!C.test(B)){B=B.toLowerCase();A=B;_=M;}_("parentNode",B,D,E,A,H);},"~":function(E,B,H){var A,D=F++,_=G;if(typeof B==="string"&&!C.test(B)){B=B.toLowerCase();A=B;_=M;}_("previousSibling",B,D,E,A,H);}},find:{ID:function(_,B,C){if(typeof B.getElementById!=="undefined"&&!C){var A=B.getElementById(_[1]);return A&&A.parentNode?[A]:[];}},NAME:function(_,B){if(typeof B.getElementsByName!=="undefined"){var C=[],E=B.getElementsByName(_[1]);for(var A=0,D=E.length;A<D;A++){if(E[A].getAttribute("name")===_[1]){C.push(E[A]);}}return C.length===0?null:C;}},TAG:function(_,A){if(typeof A.getElementsByTagName!=="undefined"){return A.getElementsByTagName(_[1]);}}},preFilter:{CLASS:function(A,F,_,D,E,G){A=" "+A[1].replace(P,"")+" ";if(G){return A;}for(var B=0,C;(C=F[B])!=null;B++){if(C){if(E^(C.className&&(" "+C.className+" ").replace(/[\t\n\r]/g," ").indexOf(A)>=0)){if(!_){D.push(C);}}else{if(_){F[B]=false;}}}}return false;},ID:function(_){return _[1].replace(P,"");},TAG:function(_,A){return _[1].replace(P,"").toLowerCase();},CHILD:function(A){if(A[1]==="nth"){if(!A[2]){_.error(A[0]);}A[2]=A[2].replace(/^\+|\s*/g,"");var B=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(A[2]==="even"&&"2n"||A[2]==="odd"&&"2n+1"||!/\D/.test(A[2])&&"0n+"+A[2]||A[2]);A[2]=(B[1]+(B[2]||1))-0;A[3]=B[3]-0;}else{if(A[2]){_.error(A[0]);}}A[0]=F++;return A;},ATTR:function(A,D,_,B,C,F){var E=A[1]=A[1].replace(P,"");if(!F&&O.attrMap[E]){A[1]=O.attrMap[E];}A[4]=(A[4]||A[5]||"").replace(P,"");if(A[2]==="~="){A[4]=" "+A[4]+" ";}return A;},PSEUDO:function(B,F,A,C,E){if(B[1]==="not"){if((J.exec(B[3])||"").length>1||/^\w/.test(B[3])){B[3]=_(B[3],null,null,F);}else{var D=_.filter(B[3],F,A,true^E);if(!A){C.push.apply(C,D);}return false;}}else{if(O.match.POS.test(B[0])||O.match.CHILD.test(B[0])){return true;}}return B;},POS:function(_){_.unshift(true);return _;}},filters:{enabled:function(_){return _.disabled===false&&_.type!=="hidden";},disabled:function(_){return _.disabled===true;},checked:function(_){return _.checked===true;},selected:function(_){if(_.parentNode){_.parentNode.selectedIndex;}return _.selected===true;},parent:function(_){return!!_.firstChild;},empty:function(_){return!_.firstChild;},has:function(C,B,A){return!!_(A[3],C).length;},header:function(_){return(/h\d/i).test(_.nodeName);},text:function(_){return"text"===_.getAttribute("type");},radio:function(_){return"radio"===_.type;},checkbox:function(_){return"checkbox"===_.type;},file:function(_){return"file"===_.type;},password:function(_){return"password"===_.type;},submit:function(_){return"submit"===_.type;},image:function(_){return"image"===_.type;},reset:function(_){return"reset"===_.type;},button:function(_){return"button"===_.type||_.nodeName.toLowerCase()==="button";},input:function(_){return(/input|select|textarea|button/i).test(_.nodeName);}},setFilters:{first:function(A,_){return _===0;},last:function(B,A,_,C){return A===C.length-1;},even:function(A,_){return _%2===0;},odd:function(A,_){return _%2===1;},lt:function(B,A,_){return A<_[3]-0;},gt:function(B,A,_){return A>_[3]-0;},nth:function(B,A,_){return _[3]-0===A;},eq:function(B,A,_){return _[3]-0===A;}},filter:{PSEUDO:function(D,B,C,I){var H=B[1],A=O.filters[H];if(A){return A(D,C,B,I);}else{if(H==="contains"){return(D.textContent||D.innerText||_.getText([D])||"").indexOf(B[3])>=0;}else{if(H==="not"){var F=B[3];for(var E=0,G=F.length;E<G;E++){if(F[E]===D){return false;}}return true;}else{_.error(H);}}}},CHILD:function(B,_){var C=_[1],D=B;switch(C){case"only":case"first":while((D=D.previousSibling)){if(D.nodeType===1){return false;}}if(C==="first"){return true;}D=B;case"last":while((D=D.nextSibling)){if(D.nodeType===1){return false;}}return true;case"nth":var E=_[2],A=_[3];if(E===1&&A===0){return true;}var F=_[0],I=B.parentNode;if(I&&(I.sizcache!==F||!B.nodeIndex)){var H=0;for(D=I.firstChild;D;D=D.nextSibling){if(D.nodeType===1){D.nodeIndex=++H;}}I.sizcache=F;}var G=B.nodeIndex-A;if(E===0){return G===0;}else{return(G%E===0&&G/E>=0);}}},ID:function(A,_){return A.nodeType===1&&A.getAttribute("id")===_;},TAG:function(A,_){return(_==="*"&&A.nodeType===1)||A.nodeName.toLowerCase()===_;},CLASS:function(A,_){return(" "+(A.className||A.getAttribute("class"))+" ").indexOf(_)>-1;},ATTR:function(B,_){var F=_[1],D=O.attrHandle[F]?O.attrHandle[F](B):B[F]!=null?B[F]:B.getAttribute(F),A=D+"",C=_[2],E=_[4];return D==null?C==="!=":C==="="?A===E:C==="*="?A.indexOf(E)>=0:C==="~="?(" "+A+" ").indexOf(E)>=0:!E?A&&D!==false:C==="!="?A!==E:C==="^="?A.indexOf(E)===0:C==="$="?A.substr(A.length-E.length)===E:C==="|="?A===E||A.substr(0,E.length+1)===E+"-":false;},POS:function(C,A,B,E){var D=A[2],_=O.setFilters[D];if(_){return _(C,B,A,E);}}}},K=O.match.POS,N=function(A,_){return"\\"+(_-0+1);};for(var D in O.match){O.match[D]=new RegExp(O.match[D].source+(/(?![^\[]*\])(?![^\(]*\))/.source));O.leftMatch[D]=new RegExp(/(^(?:.|\r|\n)*?)/.source+O.match[D].source.replace(/\\(\d+)/g,N));}var I=function(A,_){A=Array.prototype.slice.call(A,0);if(_){_.push.apply(_,A);return _;}return A;};try{Array.prototype.slice.call(m0.documentElement.childNodes,0)[0].nodeType;}catch(Q){I=function(D,C){var _=0,A=C||[];if(E.call(D)==="[object Array]"){Array.prototype.push.apply(A,D);}else{if(typeof D.length==="number"){for(var B=D.length;_<B;_++){A.push(D[_]);}}else{for(;D[_];_++){A.push(D[_]);}}}return A;};}var H,A;if(m0.documentElement.compareDocumentPosition){H=function(_,A){if(_===A){R=true;return 0;}if(!_.compareDocumentPosition||!A.compareDocumentPosition){return _.compareDocumentPosition?-1:1;}return _.compareDocumentPosition(A)&4?-1:1;};}else{H=function(E,J){var B,G,D=[],I=[],C=E.parentNode,H=J.parentNode,F=C;if(E===J){R=true;return 0;}else{if(C===H){return A(E,J);}else{if(!C){return-1;}else{if(!H){return 1;}}}}while(F){D.unshift(F);F=F.parentNode;}F=H;while(F){I.unshift(F);F=F.parentNode;}B=D.length;G=I.length;for(var _=0;_<B&&_<G;_++){if(D[_]!==I[_]){return A(D[_],I[_]);}}return _===B?A(E,I[_],-1):A(D[_],J,1);};A=function(_,C,B){if(_===C){return B;}var A=_.nextSibling;while(A){if(A===C){return-1;}A=A.nextSibling;}return 1;};}_.getText=function(C){var D="",B;for(var A=0;C[A];A++){B=C[A];if(B.nodeType===3||B.nodeType===4){D+=B.nodeValue;}else{if(B.nodeType!==8){D+=_.getText(B.childNodes);}}}return D;};(function(){var _=m0.createElement("div"),B="script"+(new Date()).getTime(),A=m0.documentElement;_.innerHTML="<a name='"+B+"'/>";A.insertBefore(_,A.firstChild);if(m0.getElementById(B)){O.find.ID=function(_,B,C){if(typeof B.getElementById!=="undefined"&&!C){var A=B.getElementById(_[1]);return A?A.id===_[1]||typeof A.getAttributeNode!=="undefined"&&A.getAttributeNode("id").nodeValue===_[1]?[A]:r0:[];}};O.filter.ID=function(A,_){var B=typeof A.getAttributeNode!=="undefined"&&A.getAttributeNode("id");return A.nodeType===1&&B&&B.nodeValue===_;};}A.removeChild(_);A=_=null;})();(function(){var _=m0.createElement("div");_.appendChild(m0.createComment(""));if(_.getElementsByTagName("*").length>0){O.find.TAG=function(_,C){var D=C.getElementsByTagName(_[1]);if(_[1]==="*"){var B=[];for(var A=0;D[A];A++){if(D[A].nodeType===1){B.push(D[A]);}}D=B;}return D;};}_.innerHTML="<a href='#'></a>";if(_.firstChild&&typeof _.firstChild.getAttribute!=="undefined"&&_.firstChild.getAttribute("href")!=="#"){O.attrHandle.href=function(_){return _.getAttribute("href",2);};}_=null;})();if(m0.querySelectorAll){(function(){var A=_,B=m0.createElement("div"),D="__sizzle__";B.innerHTML="<p class='TEST'></p>";if(B.querySelectorAll&&B.querySelectorAll(".TEST").length===0){return;}_=function(N,P,J,Q){P=P||m0;if(!Q&&!_.isXML(P)){var L=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(N);if(L&&(P.nodeType===1||P.nodeType===9)){if(L[1]){return I(P.getElementsByTagName(N),J);}else{if(L[2]&&O.find.CLASS&&P.getElementsByClassName){return I(P.getElementsByClassName(L[2]),J);}}}if(P.nodeType===9){if(N==="body"&&P.body){return I([P.body],J);}else{if(L&&L[3]){var C=P.getElementById(L[3]);if(C&&C.parentNode){if(C.id===L[3]){return I([C],J);}}else{return I([],J);}}}try{return I(P.querySelectorAll(N),J);}catch(F){}}else{if(P.nodeType===1&&P.nodeName.toLowerCase()!=="object"){var E=P,M=P.getAttribute("id"),G=M||D,H=P.parentNode,K=/^\s*[+~]/.test(N);if(!M){P.setAttribute("id",G);}else{G=G.replace(/'/g,"\\$&");}if(K&&H){P=P.parentNode;}try{if(!K||H){return I(P.querySelectorAll("[id='"+G+"'] "+N),J);}}catch(B){}finally{if(!M){E.removeAttribute("id");}}}}}return A(N,P,J,Q);};for(var C in A){_[C]=A[C];}B=null;})();}(function(){var D=m0.documentElement,C=D.matchesSelector||D.mozMatchesSelector||D.webkitMatchesSelector||D.msMatchesSelector,B=false;try{C.call(m0.documentElement,"[test!='']:sizzle");}catch(A){B=true;}if(C){_.matchesSelector=function(D,A){A=A.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']");if(!_.isXML(D)){try{if(B||!O.match.PSEUDO.test(A)&&!/!=/.test(A)){return C.call(D,A);}}catch(E){}}return _(A,null,null,[D]).length>0;};}})();(function(){var _=m0.createElement("div");_.innerHTML="<div class='test e'></div><div class='test'></div>";if(!_.getElementsByClassName||_.getElementsByClassName("e").length===0){return;}_.lastChild.className="e";if(_.getElementsByClassName("e").length===1){return;}O.order.splice(1,0,"CLASS");O.find.CLASS=function(_,A,B){if(typeof A.getElementsByClassName!=="undefined"&&!B){return A.getElementsByClassName(_[1]);}};_=null;})();function M(H,D,E,G,B,I){for(var A=0,F=G.length;A<F;A++){var C=G[A];if(C){var _=false;C=C[H];while(C){if(C.sizcache===E){_=G[C.sizset];break;}if(C.nodeType===1&&!I){C.sizcache=E;C.sizset=A;}if(C.nodeName.toLowerCase()===D){_=C;break;}C=C[H];}G[A]=_;}}}function G(I,E,F,H,C,J){for(var B=0,G=H.length;B<G;B++){var D=H[B];if(D){var A=false;D=D[I];while(D){if(D.sizcache===F){A=H[D.sizset];break;}if(D.nodeType===1){if(!J){D.sizcache=F;D.sizset=B;}if(typeof E!=="string"){if(D===E){A=true;break;}}else{if(_.filter(E,[D]).length>0){A=D;break;}}}D=D[I];}H[B]=A;}}}if(m0.documentElement.contains){_.contains=function(_,A){return _!==A&&(_.contains?_.contains(A):true);};}else{if(m0.documentElement.compareDocumentPosition){_.contains=function(_,A){return!!(_.compareDocumentPosition(A)&16);};}else{_.contains=function(){return false;};}}_.isXML=function(_){var A=(_?_.ownerDocument||_:0).documentElement;return A?A.nodeName!=="HTML":false;};var L=function(E,F){var A,D=[],C="",G=F.nodeType?[F]:F;while((A=O.match.PSEUDO.exec(E))){C+=A[0];E=E.replace(O.match.PSEUDO,"");}E=O.relative[E]?E+"*":E;for(var B=0,H=G.length;B<H;B++){_(E,G[B],D);}return _.filter(C,D);};g.find=_;g.expr=_.selectors;g.expr[":"]=g.expr.filters;g.unique=_.uniqueSort;g.text=_.getText;g.isXMLDoc=_.isXML;g.contains=_.contains;})();var y=/Until$/,G=/^(?:parents|prevUntil|prevAll)/,k0=/,/,A=/^.[^:#\[\.,]*$/,L0=Array.prototype.slice,V=g.expr.match.POS,R0={children:true,contents:true,next:true,prev:true};g.fn.extend({find:function(A){var D=this.pushStack("","find",A),C=0;for(var _=0,F=this.length;_<F;_++){C=D.length;g.find(A,this[_],D);if(_>0){for(var E=C;E<D.length;E++){for(var B=0;B<C;B++){if(D[B]===D[E]){D.splice(E--,1);break;}}}}}return D;},has:function(_){var A=g(_);return this.filter(function(){for(var _=0,B=A.length;_<B;_++){if(g.contains(this,A[_])){return true;}}});},not:function(_){return this.pushStack(d(this,_,false),"not",_);},filter:function(_){return this.pushStack(d(this,_,true),"filter",_);},is:function(_){return!!_&&g.filter(_,this).length>0;},closest:function(J,G){var H=[],B,I,F=this[0];if(g.isArray(J)){var A,D,C={},_=1;if(F&&J.length){for(B=0,I=J.length;B<I;B++){D=J[B];if(!C[D]){C[D]=g.expr.match.POS.test(D)?g(D,G||this.context):D;}}while(F&&F.ownerDocument&&F!==G){for(D in C){A=C[D];if(A.jquery?A.index(F)>-1:g(F).is(A)){H.push({selector:D,elem:F,level:_});}}F=F.parentNode;_++;}}return H;}var E=V.test(J)?g(J,G||this.context):null;for(B=0,I=this.length;B<I;B++){F=this[B];while(F){if(E?E.index(F)>-1:g.find.matchesSelector(F,J)){H.push(F);break;}else{F=F.parentNode;if(!F||!F.ownerDocument||F===G){break;}}}}H=H.length>1?g.unique(H):H;return this.pushStack(H,"closest",J);},index:function(_){if(!_||typeof _==="string"){return g.inArray(this[0],_?g(_):this.parent().children());}return g.inArray(_.jquery?_[0]:_,this);},add:function(_,B){var A=typeof _==="string"?g(_,B):g.makeArray(_),C=g.merge(this.get(),A);return this.pushStack(r(A[0])||r(C[0])?C:g.unique(C));},andSelf:function(){return this.add(this.prevObject);}});function r(_){return!_||!_.parentNode||_.parentNode.nodeType===11;}g.each({parent:function(_){var A=_.parentNode;return A&&A.nodeType!==11?A:null;},parents:function(_){return g.dir(_,"parentNode");},parentsUntil:function(B,A,_){return g.dir(B,"parentNode",_);},next:function(_){return g.nth(_,2,"nextSibling");},prev:function(_){return g.nth(_,2,"previousSibling");},nextAll:function(_){return g.dir(_,"nextSibling");},prevAll:function(_){return g.dir(_,"previousSibling");},nextUntil:function(B,A,_){return g.dir(B,"nextSibling",_);},prevUntil:function(B,A,_){return g.dir(B,"previousSibling",_);},siblings:function(_){return g.sibling(_.parentNode.firstChild,_);},children:function(_){return g.sibling(_.firstChild);},contents:function(_){return g.nodeName(_,"iframe")?_.contentDocument||_.contentWindow.document:g.makeArray(_.childNodes);}},function(_,A){g.fn[_]=function(B,C){var E=g.map(this,A,B),D=L0.call(arguments);if(!y.test(_)){C=B;}if(C&&typeof C==="string"){E=g.filter(C,E);}E=this.length>1&&!R0[_]?g.unique(E):E;if((this.length>1||k0.test(C))&&G.test(_)){E=E.reverse();}return this.pushStack(E,_,D.join(","));};});g.extend({filter:function(_,A,B){if(B){_=":not("+_+")";}return A.length===1?g.find.matchesSelector(A[0],_)?[A[0]]:[]:g.find.matches(_,A);},dir:function(A,D,_){var B=[],C=A[D];while(C&&C.nodeType!==9&&(_===r0||C.nodeType!==1||!g(C).is(_))){if(C.nodeType===1){B.push(C);}C=C[D];}return B;},nth:function(C,B,D,A){B=B||1;var _=0;for(;C;C=C[D]){if(C.nodeType===1&&++_===B){break;}}return C;},sibling:function(B,_){var A=[];for(;B;B=B.nextSibling){if(B.nodeType===1&&B!==_){A.push(B);}}return A;}});function d(D,B,_){if(g.isFunction(B)){return g.grep(D,function(C,A){var D=!!B.call(C,A,C);return D===_;});}else{if(B.nodeType){return g.grep(D,function(C,A){return(C===B)===_;});}else{if(typeof B==="string"){var C=g.grep(D,function(_){return _.nodeType===1;});if(A.test(B)){return g.filter(B,C,!_);}else{B=g.filter(B,C);}}}}return g.grep(D,function(C,A){return(g.inArray(C,B)>=0)===_;});}var U0=/ jQuery\d+="(?:\d+|null)"/g,D=/^\s+/,h0=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,x0=/<([\w:]+)/,W=/<tbody/i,o0=/<|&#?\w+;/,u=/<(?:script|object|embed|option|style)/i,m=/checked\s*(?:[^=]|=\s*.checked.)/i,e={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]};e.optgroup=e.option;e.tbody=e.tfoot=e.colgroup=e.caption=e.thead;e.th=e.td;if(!g.support.htmlSerialize){e._default=[1,"div<div>","</div>"];}g.fn.extend({text:function(_){if(g.isFunction(_)){return this.each(function(A){var B=g(this);B.text(_.call(this,A,B.text()));});}if(typeof _!=="object"&&_!==r0){return this.empty().append((this[0]&&this[0].ownerDocument||m0).createTextNode(_));}return g.text(this);},wrapAll:function(_){if(g.isFunction(_)){return this.each(function(A){g(this).wrapAll(_.call(this,A));});}if(this[0]){var A=g(_,this[0].ownerDocument).eq(0).clone(true);if(this[0].parentNode){A.insertBefore(this[0]);}A.map(function(){var _=this;while(_.firstChild&&_.firstChild.nodeType===1){_=_.firstChild;}return _;}).append(this);}return this;},wrapInner:function(_){if(g.isFunction(_)){return this.each(function(A){g(this).wrapInner(_.call(this,A));});}return this.each(function(){var B=g(this),A=B.contents();if(A.length){A.wrapAll(_);}else{B.append(_);}});},wrap:function(_){return this.each(function(){g(this).wrapAll(_);});},unwrap:function(){return this.parent().each(function(){if(!g.nodeName(this,"body")){g(this).replaceWith(this.childNodes);}}).end();},append:function(){return this.domManip(arguments,true,function(_){if(this.nodeType===1){this.appendChild(_);}});},prepend:function(){return this.domManip(arguments,true,function(_){if(this.nodeType===1){this.insertBefore(_,this.firstChild);}});},before:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(_){this.parentNode.insertBefore(_,this);});}else{if(arguments.length){var _=g(arguments[0]);_.push.apply(_,this.toArray());return this.pushStack(_,"before",arguments);}}},after:function(){if(this[0]&&this[0].parentNode){return this.domManip(arguments,false,function(_){this.parentNode.insertBefore(_,this.nextSibling);});}else{if(arguments.length){var _=this.pushStack(this,"after",arguments);_.push.apply(_,g(arguments[0]).toArray());return _;}}},remove:function(C,B){for(var _=0,A;(A=this[_])!=null;_++){if(!C||g.filter(C,[A]).length){if(!B&&A.nodeType===1){g.cleanData(A.getElementsByTagName("*"));g.cleanData([A]);}if(A.parentNode){A.parentNode.removeChild(A);}}}return this;},empty:function(){for(var _=0,A;(A=this[_])!=null;_++){if(A.nodeType===1){g.cleanData(A.getElementsByTagName("*"));}while(A.firstChild){A.removeChild(A.firstChild);}}return this;},clone:function(A,_){A=A==null?false:A;_=_==null?A:_;return this.map(function(){return g.clone(this,A,_);});},html:function(A){if(A===r0){return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(U0,""):null;}else{if(typeof A==="string"&&!u.test(A)&&(g.support.leadingWhitespace||!D.test(A))&&!e[(x0.exec(A)||["",""])[1].toLowerCase()]){A=A.replace(h0,"<$1></$2>");try{for(var _=0,B=this.length;_<B;_++){if(this[_].nodeType===1){g.cleanData(this[_].getElementsByTagName("*"));this[_].innerHTML=A;}}}catch(C){this.empty().append(A);}}else{if(g.isFunction(A)){this.each(function(_){var B=g(this);B.html(A.call(this,_,B.html()));});}else{this.empty().append(A);}}}return this;},replaceWith:function(_){if(this[0]&&this[0].parentNode){if(g.isFunction(_)){return this.each(function(A){var C=g(this),B=C.html();C.replaceWith(_.call(this,A,B));});}if(typeof _!=="string"){_=g(_).detach();}return this.each(function(){var A=this.nextSibling,B=this.parentNode;g(this).remove();if(A){g(A).before(_);}else{g(B).append(_);}});}else{return this.pushStack(g(g.isFunction(_)?_():_),"replaceWith",_);}},detach:function(_){return this.remove(_,true);},domManip:function(C,_,I){var G,D,J,K,A=C[0],B=[];if(!g.support.checkClone&&arguments.length===3&&typeof A==="string"&&m.test(A)){return this.each(function(){g(this).domManip(C,_,I,true);});}if(g.isFunction(A)){return this.each(function(B){var D=g(this);C[0]=A.call(this,B,_?D.html():r0);D.domManip(C,_,I);});}if(this[0]){K=A&&A.parentNode;if(g.support.parentNode&&K&&K.nodeType===11&&K.childNodes.length===this.length){G={fragment:K};}else{G=g.buildFragment(C,this,B);}J=G.fragment;if(J.childNodes.length===1){D=J=J.firstChild;}else{D=J.firstChild;}if(D){_=_&&g.nodeName(D,"tr");for(var H=0,F=this.length,E=F-1;H<F;H++){I.call(_?E1(this[H],D):this[H],G.cacheable||(F>1&&H<E)?g.clone(J,true,true):J);}}if(B.length){g.each(B,k);}}return this;}});function E1(_,A){return g.nodeName(_,"table")?(_.getElementsByTagName("tbody")[0]||_.appendChild(_.ownerDocument.createElement("tbody"))):_;}function _1(F,H){if(H.nodeType!==1||!g.hasData(F)){return;}var C=g.expando,B=g.data(F),E=g.data(H,B);if((B=B[C])){var A=B.events;E=E[C]=g.extend({},B);if(A){delete E.handle;E.events={};for(var D in A){for(var _=0,G=A[D].length;_<G;_++){g.event.add(H,D+(A[D][_].namespace?".":"")+A[D][_].namespace,A[D][_],A[D][_].data);}}}}}function _(A,B){if(B.nodeType!==1){return;}var _=B.nodeName.toLowerCase();B.clearAttributes();B.mergeAttributes(A);if(_==="object"){B.outerHTML=A.outerHTML;}else{if(_==="input"&&(A.type==="checkbox"||A.type==="radio")){if(A.checked){B.defaultChecked=B.checked=A.checked;}if(B.value!==A.value){B.value=A.value;}}else{if(_==="option"){B.selected=A.defaultSelected;}else{if(_==="input"||_==="textarea"){B.defaultValue=A.defaultValue;}}}}B.removeAttribute(g.expando);}g.buildFragment=function(D,F,B){var C,E,A,_=(F&&F[0]?F[0].ownerDocument||F[0]:m0);if(D.length===1&&typeof D[0]==="string"&&D[0].length<512&&_===m0&&D[0].charAt(0)==="<"&&!u.test(D[0])&&(g.support.checkClone||!m.test(D[0]))){E=true;A=g.fragments[D[0]];if(A){if(A!==1){C=A;}}}if(!C){C=_.createDocumentFragment();g.clean(D,_,C,B);}if(E){g.fragments[D[0]]=A?C:1;}return{fragment:C,cacheable:E};};g.fragments={};g.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(A,_){g.fn[A]=function(C){var F=[],E=g(C),H=this.length===1&&this[0].parentNode;if(H&&H.nodeType===11&&H.childNodes.length===1&&E.length===1){E[_](this[0]);return this;}else{for(var B=0,G=E.length;B<G;B++){var D=(B>0?this.clone(true):this).get();g(E[B])[_](D);F=F.concat(D);}return this.pushStack(F,A,E.selector);}};});function A0(_){if("getElementsByTagName"in _){return _.getElementsByTagName("*");}else{if("querySelectorAll"in _){return _.querySelectorAll("*");}else{return[];}}}g.extend({clone:function(B,G,F){var E=B.cloneNode(true),D,C,A;if((!g.support.noCloneEvent||!g.support.noCloneChecked)&&(B.nodeType===1||B.nodeType===11)&&!g.isXMLDoc(B)){_(B,E);D=A0(B);C=A0(E);for(A=0;D[A];++A){_(D[A],C[A]);}}if(G){_1(B,E);if(F){D=A0(B);C=A0(E);for(A=0;D[A];++A){_1(D[A],C[A]);}}}return E;},clean:function(I,J,H,A){J=J||m0;if(typeof J.createElement==="undefined"){J=J.ownerDocument||J[0]&&J[0].ownerDocument||m0;}var M=[];for(var F=0,_;(_=I[F])!=null;F++){if(typeof _==="number"){_+="";}if(!_){continue;}if(typeof _==="string"&&!o0.test(_)){_=J.createTextNode(_);}else{if(typeof _==="string"){_=_.replace(h0,"<$1></$2>");var K=(x0.exec(_)||["",""])[1].toLowerCase(),C=e[K]||e._default,B=C[0],G=J.createElement("div");G.innerHTML=C[1]+_+C[2];while(B--){G=G.lastChild;}if(!g.support.tbody){var E=W.test(_),N=K==="table"&&!E?G.firstChild&&G.firstChild.childNodes:C[1]==="<table>"&&!E?G.childNodes:[];for(var L=N.length-1;L>=0;--L){if(g.nodeName(N[L],"tbody")&&!N[L].childNodes.length){N[L].parentNode.removeChild(N[L]);}}}if(!g.support.leadingWhitespace&&D.test(_)){G.insertBefore(J.createTextNode(D.exec(_)[0]),G.firstChild);}_=G.childNodes;}}if(_.nodeType){M.push(_);}else{M=g.merge(M,_);}}if(H){for(F=0;M[F];F++){if(A&&g.nodeName(M[F],"script")&&(!M[F].type||M[F].type.toLowerCase()==="text/javascript")){A.push(M[F].parentNode?M[F].parentNode.removeChild(M[F]):M[F]);}else{if(M[F].nodeType===1){M.splice.apply(M,[F+1,0].concat(g.makeArray(M[F].getElementsByTagName("script"))));}H.appendChild(M[F]);}}}return M;},cleanData:function(G){var F,I,_=g.cache,C=g.expando,E=g.event.special,H=g.support.deleteExpando;for(var A=0,B;(B=G[A])!=null;A++){if(B.nodeName&&g.noData[B.nodeName.toLowerCase()]){continue;}I=B[g.expando];if(I){F=_[I]&&_[I][C];if(F&&F.events){for(var D in F.events){if(E[D]){g.event.remove(B,D);}else{g.removeEvent(B,D,F.handle);}}if(F.handle){F.handle.elem=null;}}if(H){delete B[g.expando];}else{if(B.removeAttribute){B.removeAttribute(g.expando);}}delete _[I];}}}});function k(_,A){if(A.src){g.ajax({url:A.src,async:false,dataType:"script"});}else{g.globalEval(A.text||A.textContent||A.innerHTML||"");}if(A.parentNode){A.parentNode.removeChild(A);}}var b=/alpha\([^)]*\)/i,C1=/opacity=([^)]*)/,D0=/-([a-z])/ig,h=/([A-Z])/g,H0=/^-?\d+(?:px)?$/i,q=/^-?\d/,I={position:"absolute",visibility:"hidden",display:"block"},n=["Left","Right"],v=["Top","Bottom"],_0,F0,B,A1=function(A,_){return _.toUpperCase();};g.fn.css=function(A,_){if(arguments.length===2&&_===r0){return this;}return g.access(this,A,_,true,function(A,B,_){return _!==r0?g.style(A,B,_):g.css(A,B);});};g.extend({cssHooks:{opacity:{get:function(_,B){if(B){var A=_0(_,"opacity","opacity");return A===""?"1":A;}else{return _.style.opacity;}}}},cssNumber:{zIndex:true,fontWeight:true,opacity:true,zoom:true,lineHeight:true},cssProps:{"float":g.support.cssFloat?"cssFloat":"styleFloat"},style:function(A,G,_,C){if(!A||A.nodeType===3||A.nodeType===8||!A.style){return;}var F,E=g.camelCase(G),D=A.style,B=g.cssHooks[E];G=g.cssProps[E]||E;if(_!==r0){if(typeof _==="number"&&isNaN(_)||_==null){return;}if(typeof _==="number"&&!g.cssNumber[E]){_+="px";}if(!B||!("set"in B)||(_=B.set(A,_))!==r0){try{D[G]=_;}catch(H){}}}else{if(B&&"get"in B&&(F=B.get(A,false,C))!==r0){return F;}return D[G];}},css:function(_,E,B){var D,C=g.camelCase(E),A=g.cssHooks[C];E=g.cssProps[C]||C;if(A&&"get"in A&&(D=A.get(_,true,B))!==r0){return D;}else{if(_0){return _0(_,E,C);}}},swap:function(A,D,_){var B={};for(var C in D){B[C]=A.style[C];A.style[C]=D[C];}_.call(A);for(C in D){A.style[C]=B[C];}},camelCase:function(_){return _.replace(D0,A1);}});g.curCSS=g.css;g.each(["height","width"],function(_,A){g.cssHooks[A]={get:function(C,E,D){var _;if(E){if(C.offsetWidth!==0){_=Y(C,A,D);}else{g.swap(C,I,function(){_=Y(C,A,D);});}if(_<=0){_=_0(C,A,A);if(_==="0px"&&B){_=B(C,A,A);}if(_!=null){return _===""||_==="auto"?"0px":_;}}if(_<0||_==null){_=C.style[A];return _===""||_==="auto"?"0px":_;}return typeof _==="string"?_:_+"px";}},set:function(A,_){if(H0.test(_)){_=parseFloat(_);if(_>=0){return _+"px";}}else{return _;}}};});if(!g.support.opacity){g.cssHooks.opacity={get:function(_,A){return C1.test((A&&_.currentStyle?_.currentStyle.filter:_.style.filter)||"")?(parseFloat(RegExp.$1)/100)+"":A?"1":"";},set:function(B,A){var D=B.style;D.zoom=1;var C=g.isNaN(A)?"":"alpha(opacity="+A*100+")",_=D.filter||"";D.filter=b.test(_)?_.replace(b,C):D.filter+" "+C;}};}if(m0.defaultView&&m0.defaultView.getComputedStyle){F0=function(_,B,D){var C,E,A;D=D.replace(h,"-$1").toLowerCase();if(!(E=_.ownerDocument.defaultView)){return r0;}if((A=E.getComputedStyle(_,null))){C=A.getPropertyValue(D);if(C===""&&!g.contains(_.ownerDocument.documentElement,_)){C=g.style(_,D);}}return C;};}if(m0.documentElement.currentStyle){B=function(A,E){var B,D=A.currentStyle&&A.currentStyle[E],_=A.runtimeStyle&&A.runtimeStyle[E],C=A.style;if(!H0.test(D)&&q.test(D)){B=C.left;if(_){A.runtimeStyle.left=A.currentStyle.left;}C.left=E==="fontSize"?"1em":(D||0);D=C.pixelLeft+"px";C.left=B;if(_){A.runtimeStyle.left=_;}}return D===""?"auto":D;};}_0=F0||B;function Y(A,D,C){var B=D==="width"?n:v,_=D==="width"?A.offsetWidth:A.offsetHeight;if(C==="border"){return _;}g.each(B,function(){if(!C){_-=parseFloat(g.css(A,"padding"+this))||0;}if(C==="margin"){_+=parseFloat(g.css(A,"margin"+this))||0;}else{_-=parseFloat(g.css(A,"border"+this+"Width"))||0;}});return _;}if(g.expr&&g.expr.filters){g.expr.filters.hidden=function(_){var A=_.offsetWidth,B=_.offsetHeight;return(A===0&&B===0)||(!g.support.reliableHiddenOffsets&&(_.style.display||g.css(_,"display"))==="none");};g.expr.filters.visible=function(_){return!g.expr.filters.hidden(_);};}var T=/%20/g,x=/\[\]$/,v0=/\r?\n/g,q0=/#.*$/,G1=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,D1=/^(?:color|date|datetime|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,R=/(?:^file|^widget|\-extension):$/,g0=/^(?:GET|HEAD)$/,J0=/^\/\//,J=/\?/,s0=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,a0=/^(?:select|textarea)/i,d0=/\s+/,H1=/([?&])_=[^&]*/,C0=/(^|\-)([a-z])/g,U=function(A,_,B){return _+B.toUpperCase();},N=/^([\w\+\.\-]+:)\/\/([^\/?#:]*)(?::(\d+))?/,t=g.fn.load,K={},C={},Q0,b0;try{Q0=m0.location.href;}catch(W0){Q0=m0.createElement("a");Q0.href="";Q0=Q0.href;}b0=N.exec(Q0.toLowerCase());function S(_){return function(F,E){if(typeof F!=="string"){E=F;F="*";}if(g.isFunction(E)){var H=F.toLowerCase().split(d0),B=0,D=H.length,C,A,G;for(;B<D;B++){C=H[B];G=/^\+/.test(C);if(G){C=C.substr(1)||"*";}A=_[C]=_[C]||[];A[G?"unshift":"push"](E);}}};}function Q(H,J,C,A,E,D){E=E||J.dataTypes[0];D=D||{};D[E]=true;var _=H[E],B=0,F=_?_.length:0,I=(H===K),G;for(;B<F&&(I||!G);B++){G=_[B](J,C,A);if(typeof G==="string"){if(!I||D[G]){G=r0;}else{J.dataTypes.unshift(G);G=Q(H,J,C,A,G,D);}}}if((I||!G)&&!D["*"]){G=Q(H,J,C,A,"*",D);}return G;}g.fn.extend({load:function(E,D,_){if(typeof E!=="string"&&t){return t.apply(this,arguments);}else{if(!this.length){return this;}}var F=E.indexOf(" ");if(F>=0){var A=E.slice(F,E.length);E=E.slice(0,F);}var C="GET";if(D){if(g.isFunction(D)){_=D;D=r0;}else{if(typeof D==="object"){D=g.param(D,g.ajaxSettings.traditional);C="POST";}}}var B=this;g.ajax({url:E,type:C,dataType:"html",data:D,complete:function(C,D,E){E=C.responseText;if(C.isResolved()){C.done(function(_){E=_;});B.html(A?g("<div>").append(E.replace(s0,"")).find(A):E);}if(_){B.each(_,[E,D,C]);}}});return this;},serialize:function(){return g.param(this.serializeArray());},serializeArray:function(){return this.map(function(){return this.elements?g.makeArray(this.elements):this;}).filter(function(){return this.name&&!this.disabled&&(this.checked||a0.test(this.nodeName)||D1.test(this.type));}).map(function(A,B){var _=g(this).val();return _==null?null:g.isArray(_)?g.map(_,function(A,_){return{name:B.name,value:A.replace(v0,"\r\n")};}):{name:B.name,value:_.replace(v0,"\r\n")};}).get();}});g.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(A,_){g.fn[_]=function(A){return this.bind(_,A);};});g.each(["get","post"],function(_,A){g[A]=function(D,C,_,B){if(g.isFunction(C)){B=B||_;_=C;C=r0;}return g.ajax({type:A,url:D,data:C,success:_,dataType:B});};});g.extend({getScript:function(A,_){return g.get(A,r0,_,"script");},getJSON:function(B,A,_){return g.get(B,A,_,"json");},ajaxSetup:function(A,_){if(!_){_=A;A=g.extend(true,g.ajaxSettings,_);}else{g.extend(true,A,g.ajaxSettings,_);}for(var B in{context:1,url:1}){if(B in _){A[B]=_[B];}else{if(B in g.ajaxSettings){A[B]=g.ajaxSettings[B];}}}return A;},ajaxSettings:{url:Q0,isLocal:R.test(b0[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":E0.String,"text html":true,"text json":g.parseJSON,"text xml":g.parseXML}},ajaxPrefilter:S(K),ajaxTransport:S(C),ajax:function(Z,P){if(typeof Z==="object"){P=Z;Z=r0;}P=P||{};var a=g.ajaxSetup({},P),F=a.context||a,D=F!==a&&(F.nodeType||F instanceof g)?g(F):g.event,B=g.Deferred(),G=g._Deferred(),c=a.statusCode||{},W,E={},R,S,O,I,A,Y=0,L,T,_={readyState:0,setRequestHeader:function(A,_){if(!Y){E[A.toLowerCase().replace(C0,U)]=_;}return this;},getAllResponseHeaders:function(){return Y===2?R:null;},getResponseHeader:function(A){var _;if(Y===2){if(!S){S={};while((_=G1.exec(R))){S[_[1].toLowerCase()]=_[2];}}_=S[A.toLowerCase()];}return _===r0?null:_;},overrideMimeType:function(_){if(!Y){a.mimeType=_;}return this;},abort:function(_){_=_||"abort";if(O){O.abort(_);}H(0,_);return this;}};function H(K,H,A,E){if(Y===2){return;}Y=2;if(I){clearTimeout(I);}O=r0;R=E||"";_.readyState=K?4:0;var C,P,N,S=A?I0(a,_,A):r0,J,Q;if(K>=200&&K<300||K===304){if(a.ifModified){if((J=_.getResponseHeader("Last-Modified"))){g.lastModified[W]=J;}if((Q=_.getResponseHeader("Etag"))){g.etag[W]=Q;}}if(K===304){H="notmodified";C=true;}else{try{P=M(a,S);H="success";C=true;}catch(T){H="parsererror";N=T;}}}else{N=H;if(!H||K){H="error";if(K<0){K=0;}}}_.status=K;_.statusText=H;if(C){B.resolveWith(F,[P,H,_]);}else{B.rejectWith(F,[_,H,N]);}_.statusCode(c);c=r0;if(L){D.trigger("ajax"+(C?"Success":"Error"),[_,a,C?P:N]);}G.resolveWith(F,[_,H]);if(L){D.trigger("ajaxComplete",[_,a]);if(!(--g.active)){g.event.trigger("ajaxStop");}}}B.promise(_);_.success=_.done;_.error=_.fail;_.complete=G.done;_.statusCode=function(B){if(B){var A;if(Y<2){for(A in B){c[A]=[c[A],B[A]];}}else{A=B[_.status];_.then(A,A);}}return this;};a.url=((Z||a.url)+"").replace(q0,"").replace(J0,b0[1]+"//");a.dataTypes=g.trim(a.dataType||"*").toLowerCase().split(d0);if(!a.crossDomain){A=N.exec(a.url.toLowerCase());a.crossDomain=!!(A&&(A[1]!=b0[1]||A[2]!=b0[2]||(A[3]||(A[1]==="http:"?80:443))!=(b0[3]||(b0[1]==="http:"?80:443))));}if(a.data&&a.processData&&typeof a.data!=="string"){a.data=g.param(a.data,a.traditional);}Q(K,a,P,_);if(Y===2){return false;}L=a.global;a.type=a.type.toUpperCase();a.hasContent=!g0.test(a.type);if(L&&g.active++===0){g.event.trigger("ajaxStart");}if(!a.hasContent){if(a.data){a.url+=(J.test(a.url)?"&":"?")+a.data;}W=a.url;if(a.cache===false){var V=g.now(),X=a.url.replace(H1,"$1_="+V);a.url=X+((X===a.url)?(J.test(a.url)?"&":"?")+"_="+V:"");}}if(a.data&&a.hasContent&&a.contentType!==false||P.contentType){E["Content-Type"]=a.contentType;}if(a.ifModified){W=W||a.url;if(g.lastModified[W]){E["If-Modified-Since"]=g.lastModified[W];}if(g.etag[W]){E["If-None-Match"]=g.etag[W];}}E.Accept=a.dataTypes[0]&&a.accepts[a.dataTypes[0]]?a.accepts[a.dataTypes[0]]+(a.dataTypes[0]!=="*"?", */*; q=0.01":""):a.accepts["*"];for(T in a.headers){_.setRequestHeader(T,a.headers[T]);}if(a.beforeSend&&(a.beforeSend.call(F,_,a)===false||Y===2)){_.abort();return false;}for(T in{success:1,error:1,complete:1}){_[T](a[T]);}O=Q(C,a,P,_);if(!O){H(-1,"No Transport");}else{_.readyState=1;if(L){D.trigger("ajaxSend",[_,a]);}if(a.async&&a.timeout>0){I=setTimeout(function(){_.abort("timeout");},a.timeout);}try{Y=1;O.send(E,H);}catch(b){if(status<2){H(-1,b);}else{g.error(b);}}}return _;},param:function(B,_){var D=[],A=function(_,A){A=g.isFunction(A)?A():A;D[D.length]=encodeURIComponent(_)+"="+encodeURIComponent(A);};if(_===r0){_=g.ajaxSettings.traditional;}if(g.isArray(B)||(B.jquery&&!g.isPlainObject(B))){g.each(B,function(){A(this.name,this.value);});}else{for(var C in B){l(C,B[C],_,A);}}return D.join("&").replace(T,"+");}});function l(C,B,_,A){if(g.isArray(B)&&B.length){g.each(B,function(B,D){if(_||x.test(C)){A(C,D);}else{l(C+"["+(typeof D==="object"||g.isArray(D)?B:"")+"]",D,_,A);}});}else{if(!_&&B!=null&&typeof B==="object"){if(g.isArray(B)||g.isEmptyObject(B)){A(C,"");}else{for(var D in B){l(C+"["+D+"]",B[D],_,A);}}}else{A(C,B);}}}g.extend({active:0,lastModified:{},etag:{}});function I0(H,B,A){var _=H.contents,F=H.dataTypes,E=H.responseFields,G,C,D,I;for(C in E){if(C in A){B[E[C]]=A[C];}}while(F[0]==="*"){F.shift();if(G===r0){G=H.mimeType||B.getResponseHeader("content-type");}}if(G){for(C in _){if(_[C]&&_[C].test(G)){F.unshift(C);break;}}}if(F[0]in A){D=F[0];}else{for(C in A){if(!F[0]||H.converters[C+" "+F[0]]){D=C;break;}if(!I){I=C;}}D=D||I;}if(D){if(D!==F[0]){F.unshift(D);}return A[D];}}function M(L,F){if(L.dataFilter){F=L.dataFilter(F,L.dataType);}var E=L.dataTypes,A={},H,G,B=E.length,I,_=E[0],J,M,C,K,D;for(H=1;H<B;H++){if(H===1){for(G in L.converters){if(typeof G==="string"){A[G.toLowerCase()]=L.converters[G];}}}J=_;_=E[H];if(_==="*"){_=J;}else{if(J!=="*"&&J!==_){M=J+" "+_;C=A[M]||A["* "+_];if(!C){D=r0;for(K in A){I=K.split(" ");if(I[0]===J||I[0]==="*"){D=A[I[1]+" "+_];if(D){K=A[K];if(K===true){C=D;}else{if(D===true){C=K;}}break;}}}}if(!(C||D)){g.error("No conversion from "+M.replace(" "," to "));}if(C!==true){F=C?C(F):D(K(F));}}}}return F;}var X=g.now(),o=/(\=)\?(&|$)|()\?\?()/i;g.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return g.expando+"_"+(X++);}});g.ajaxPrefilter("json jsonp",function(J,B,_){var D=(typeof J.data==="string");if(J.dataTypes[0]==="jsonp"||B.jsonpCallback||B.jsonp!=null||J.jsonp!==false&&(o.test(J.url)||D&&o.test(J.data))){var A,I=J.jsonpCallback=g.isFunction(J.jsonpCallback)?J.jsonpCallback():J.jsonpCallback,F=E0[I],G=J.url,E=J.data,H="$1"+I+"$2",C=function(){E0[I]=F;if(A&&g.isFunction(F)){E0[I](A[0]);}};if(J.jsonp!==false){G=G.replace(o,H);if(J.url===G){if(D){E=E.replace(o,H);}if(J.data===E){G+=(/\?/.test(G)?"&":"?")+J.jsonp+"="+I;}}}J.url=G;J.data=E;E0[I]=function(_){A=[_];};_.then(C,C);J.converters["script json"]=function(){if(!A){g.error(I+" was not called");}return A[0];};J.dataTypes[0]="json";return"script";}});g.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(_){g.globalEval(_);return _;}}});g.ajaxPrefilter("script",function(_){if(_.cache===r0){_.cache=false;}if(_.crossDomain){_.type="GET";_.global=false;}});g.ajaxTransport("script",function(B){if(B.crossDomain){var _,A=m0.head||m0.getElementsByTagName("head")[0]||m0.documentElement;return{send:function(D,C){_=m0.createElement("script");_.async="async";if(B.scriptCharset){_.charset=B.scriptCharset;}_.src=B.url;_.onload=_.onreadystatechange=function(D,B){if(!_.readyState||/loaded|complete/.test(_.readyState)){_.onload=_.onreadystatechange=null;if(A&&_.parentNode){A.removeChild(_);}_=r0;if(!B){C(200,"success");}}};A.insertBefore(_,A.firstChild);},abort:function(){if(_){_.onload(0,1);}}};}});var f=g.now(),n0,N0;function F(){g(E0).unload(function(){for(var _ in n0){n0[_](0,1);}});}function t0(){try{return new E0.XMLHttpRequest();}catch(_){}}function i0(){try{return new E0.ActiveXObject("Microsoft.XMLHTTP");}catch(_){}}g.ajaxSettings.xhr=E0.ActiveXObject?function(){return!this.isLocal&&t0()||i0();}:t0;N0=g.ajaxSettings.xhr();g.support.ajax=!!N0;g.support.cors=N0&&("withCredentials"in N0);N0=r0;if(g.support.ajax){g.ajaxTransport(function(A){if(!A.crossDomain||g.support.cors){var _;return{send:function(E,H){var D=A.xhr(),B,C;if(A.username){D.open(A.type,A.url,A.async,A.username,A.password);}else{D.open(A.type,A.url,A.async);}if(A.xhrFields){for(C in A.xhrFields){D[C]=A.xhrFields[C];}}if(A.mimeType&&D.overrideMimeType){D.overrideMimeType(A.mimeType);}if(!(A.crossDomain&&!A.hasContent)&&!E["X-Requested-With"]){E["X-Requested-With"]="XMLHttpRequest";}try{for(C in E){D.setRequestHeader(C,E[C]);}}catch(G){}D.send((A.hasContent&&A.data)||null);_=function(I,E){var J,F,M,C,K;try{if(_&&(E||D.readyState===4)){_=r0;if(B){D.onreadystatechange=g.noop;delete n0[B];}if(E){if(D.readyState!==4){D.abort();}}else{J=D.status;M=D.getAllResponseHeaders();C={};K=D.responseXML;if(K&&K.documentElement){C.xml=K;}C.text=D.responseText;try{F=D.statusText;}catch(L){F="";}if(!J&&A.isLocal&&!A.crossDomain){J=C.text?200:404;}else{if(J===1223){J=204;}}}}}catch(G){if(!E){H(-1,G);}}if(C){H(J,F,C,M);}};if(!A.async||D.readyState===4){_();}else{if(!n0){n0={};F();}B=f++;D.onreadystatechange=n0[B]=_;}},abort:function(){if(_){_(0,1);}}};}});}var O={},i=/^(?:toggle|show|hide)$/,p=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,c0,w0=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];g.fn.extend({show:function(B,F,D){var C,_;if(B||B===0){return this.animate(P0("show",3),B,F,D);}else{for(var A=0,E=this.length;A<E;A++){C=this[A];_=C.style.display;if(!g._data(C,"olddisplay")&&_==="none"){_=C.style.display="";}if(_===""&&g.css(C,"display")==="none"){g._data(C,"olddisplay",O0(C.nodeName));}}for(A=0;A<E;A++){C=this[A];_=C.style.display;if(_===""||_==="none"){C.style.display=g._data(C,"olddisplay")||"";}}return this;}},hide:function(B,E,C){if(B||B===0){return this.animate(P0("hide",3),B,E,C);}else{for(var A=0,D=this.length;A<D;A++){var _=g.css(this[A],"display");if(_!=="none"&&!g._data(this[A],"olddisplay")){g._data(this[A],"olddisplay",_);}}for(A=0;A<D;A++){this[A].style.display="none";}return this;}},_toggle:g.fn.toggle,toggle:function(C,A,_){var B=typeof C==="boolean";if(g.isFunction(C)&&g.isFunction(A)){this._toggle.apply(this,arguments);}else{if(C==null||B){this.each(function(){var _=B?C:g(this).is(":hidden");g(this)[_?"show":"hide"]();});}else{this.animate(P0("toggle",3),C,A,_);}}return this;},fadeTo:function(A,_,C,B){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:_},A,C,B);},animate:function(B,_,C,A){var D=g.speed(_,C,A);if(g.isEmptyObject(B)){return this.each(D.complete);}return this[D.queue===false?"each":"queue"](function(){var G=g.extend({},D),F,A=this.nodeType===1,E=A&&g(this).is(":hidden"),C=this;for(F in B){var H=g.camelCase(F);if(F!==H){B[H]=B[F];delete B[F];F=H;}if(B[F]==="hide"&&E||B[F]==="show"&&!E){return G.complete.call(this);}if(A&&(F==="height"||F==="width")){G.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(g.css(this,"display")==="inline"&&g.css(this,"float")==="none"){if(!g.support.inlineBlockNeedsLayout){this.style.display="inline-block";}else{var _=O0(this.nodeName);if(_==="inline"){this.style.display="inline-block";}else{this.style.display="inline";this.style.zoom=1;}}}}if(g.isArray(B[F])){(G.specialEasing=G.specialEasing||{})[F]=B[F][1];B[F]=B[F][0];}}if(G.overflow!=null){this.style.overflow="hidden";}G.curAnim=g.extend({},B);g.each(B,function(I,A){var J=new g.fx(C,G,I);if(i.test(A)){J[A==="toggle"?E?"show":"hide":A](B);}else{var _=p.exec(A),D=J.cur();if(_){var H=parseFloat(_[2]),F=_[3]||(g.cssNumber[I]?"":"px");if(F!=="px"){g.style(C,I,(H||1)+F);D=((H||1)/J.cur())*D;g.style(C,I,D+F);}if(_[1]){H=((_[1]==="-="?-1:1)*H)+D;}J.custom(D,H,F);}else{J.custom(D,A,"");}}});return true;});},stop:function(_,A){var B=g.timers;if(_){this.queue([]);}this.each(function(){for(var _=B.length-1;_>=0;_--){if(B[_].elem===this){if(A){B[_](true);}B.splice(_,1);}}});if(!A){this.dequeue();}return this;}});function P0(B,_){var A={};g.each(w0.concat.apply([],w0.slice(0,_)),function(){A[this]=B;});return A;}g.each({slideDown:P0("show",1),slideUp:P0("hide",1),slideToggle:P0("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(A,_){g.fn[A]=function(A,C,B){return this.animate(_,A,C,B);};});g.extend({speed:function(_,B,C){var A=_&&typeof _==="object"?g.extend({},_):{complete:C||!C&&B||g.isFunction(_)&&_,duration:_,easing:C&&B||B&&!g.isFunction(B)&&B};A.duration=g.fx.off?0:typeof A.duration==="number"?A.duration:A.duration in g.fx.speeds?g.fx.speeds[A.duration]:g.fx.speeds._default;A.old=A.complete;A.complete=function(){if(A.queue!==false){g(this).dequeue();}if(g.isFunction(A.old)){A.old.call(this);}};return A;},easing:{linear:function(A,B,_,C){return _+C*A;},swing:function(A,B,_,C){return((-Math.cos(A*Math.PI)/2)+0.5)*C+_;}},timers:[],fx:function(_,B,A){this.options=B;this.elem=_;this.prop=A;if(!B.orig){B.orig={};}}});g.fx.prototype={update:function(){if(this.options.step){this.options.step.call(this.elem,this.now,this);}(g.fx.step[this.prop]||g.fx.step._default)(this);},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null)){return this.elem[this.prop];}var A,_=g.css(this.elem,this.prop);return isNaN(A=parseFloat(_))?!_||_==="auto"?0:_:A;},custom:function(E,_,C){var B=this,A=g.fx;this.startTime=g.now();this.start=E;this.end=_;this.unit=C||this.unit||(g.cssNumber[this.prop]?"":"px");this.now=this.start;this.pos=this.state=0;function D(_){return B.step(_);}D.elem=this.elem;if(D()&&g.timers.push(D)&&!c0){c0=setInterval(A.tick,A.interval);}},show:function(){this.options.orig[this.prop]=g.style(this.elem,this.prop);this.options.show=true;this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());g(this.elem).show();},hide:function(){this.options.orig[this.prop]=g.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0);},step:function(G){var E=g.now(),D=true;if(G||E>=this.options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();this.options.curAnim[this.prop]=true;for(var A in this.options.curAnim){if(this.options.curAnim[A]!==true){D=false;}}if(D){if(this.options.overflow!=null&&!g.support.shrinkWrapBlocks){var B=this.elem,I=this.options;g.each(["","X","Y"],function(_,A){B.style["overflow"+A]=I.overflow[_];});}if(this.options.hide){g(this.elem).hide();}if(this.options.hide||this.options.show){for(var F in this.options.curAnim){g.style(this.elem,F,this.options.orig[F]);}}this.options.complete.call(this.elem);}return false;}else{var H=E-this.startTime;this.state=H/this.options.duration;var C=this.options.specialEasing&&this.options.specialEasing[this.prop],_=this.options.easing||(g.easing.swing?"swing":"linear");this.pos=g.easing[C||_](this.state,H,0,1,this.options.duration);this.now=this.start+((this.end-this.start)*this.pos);this.update();}return true;}};g.extend(g.fx,{tick:function(){var A=g.timers;for(var _=0;_<A.length;_++){if(!A[_]()){A.splice(_--,1);}}if(!A.length){g.fx.stop();}},interval:13,stop:function(){clearInterval(c0);c0=null;},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(_){g.style(_.elem,"opacity",_.now);},_default:function(_){if(_.elem.style&&_.elem.style[_.prop]!=null){_.elem.style[_.prop]=(_.prop==="width"||_.prop==="height"?Math.max(0,_.now):_.now)+_.unit;}else{_.elem[_.prop]=_.now;}}}});if(g.expr&&g.expr.filters){g.expr.filters.animated=function(_){return g.grep(g.timers,function(A){return _===A.elem;}).length;};}function O0(B){if(!O[B]){var A=g("<"+B+">").appendTo("body"),_=A.css("display");A.remove();if(_==="none"||_===""){_="block";}O[B]=_;}return O[B];}var z=/^t(?:able|d|h)$/i,P=/^(?:body|html)$/i;if("getBoundingClientRect"in m0.documentElement){g.fn.offset=function(H){var _=this[0],D;if(H){return this.each(function(_){g.offset.setOffset(this,H,_);});}if(!_||!_.ownerDocument){return null;}if(_===_.ownerDocument.body){return g.offset.bodyOffset(_);}try{D=_.getBoundingClientRect();}catch(M){}var I=_.ownerDocument,A=I.documentElement;if(!D||!g.contains(A,_)){return D?{top:D.top,left:D.left}:{top:0,left:0};}var K=I.body,L=B1(I),F=A.clientTop||K.clientTop||0,B=A.clientLeft||K.clientLeft||0,G=(L.pageYOffset||g.support.boxModel&&A.scrollTop||K.scrollTop),E=(L.pageXOffset||g.support.boxModel&&A.scrollLeft||K.scrollLeft),C=D.top+G-F,J=D.left+E-B;return{top:C,left:J};};}else{g.fn.offset=function(F){var _=this[0];if(F){return this.each(function(_){g.offset.setOffset(this,F,_);});}if(!_||!_.ownerDocument){return null;}if(_===_.ownerDocument.body){return g.offset.bodyOffset(_);}g.offset.initialize();var B,I=_.offsetParent,E=_,G=_.ownerDocument,A=G.documentElement,J=G.body,K=G.defaultView,D=K?K.getComputedStyle(_,null):_.currentStyle,C=_.offsetTop,H=_.offsetLeft;while((_=_.parentNode)&&_!==J&&_!==A){if(g.offset.supportsFixedPosition&&D.position==="fixed"){break;}B=K?K.getComputedStyle(_,null):_.currentStyle;C-=_.scrollTop;H-=_.scrollLeft;if(_===I){C+=_.offsetTop;H+=_.offsetLeft;if(g.offset.doesNotAddBorder&&!(g.offset.doesAddBorderForTableAndCells&&z.test(_.nodeName))){C+=parseFloat(B.borderTopWidth)||0;H+=parseFloat(B.borderLeftWidth)||0;}E=I;I=_.offsetParent;}if(g.offset.subtractsBorderForOverflowNotVisible&&B.overflow!=="visible"){C+=parseFloat(B.borderTopWidth)||0;H+=parseFloat(B.borderLeftWidth)||0;}D=B;}if(D.position==="relative"||D.position==="static"){C+=J.offsetTop;H+=J.offsetLeft;}if(g.offset.supportsFixedPosition&&D.position==="fixed"){C+=Math.max(A.scrollTop,J.scrollTop);H+=Math.max(A.scrollLeft,J.scrollLeft);}return{top:C,left:H};};}g.offset={initialize:function(){var G=m0.body,C=m0.createElement("div"),B,E,A,_,F=parseFloat(g.css(G,"marginTop"))||0,D="<div style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;'><div></div></div><table style='position:absolute;top:0;left:0;margin:0;border:5px solid #000;padding:0;width:1px;height:1px;' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>";g.extend(C.style,{position:"absolute",top:0,left:0,margin:0,border:0,width:"1px",height:"1px",visibility:"hidden"});C.innerHTML=D;G.insertBefore(C,G.firstChild);B=C.firstChild;E=B.firstChild;_=B.nextSibling.firstChild.firstChild;this.doesNotAddBorder=(E.offsetTop!==5);this.doesAddBorderForTableAndCells=(_.offsetTop===5);E.style.position="fixed";E.style.top="20px";this.supportsFixedPosition=(E.offsetTop===20||E.offsetTop===15);E.style.position=E.style.top="";B.style.overflow="hidden";B.style.position="relative";this.subtractsBorderForOverflowNotVisible=(E.offsetTop===-5);this.doesNotIncludeMarginInBodyOffset=(G.offsetTop!==F);G.removeChild(C);G=C=B=E=A=_=null;g.offset.initialize=g.noop;},bodyOffset:function(B){var _=B.offsetTop,A=B.offsetLeft;g.offset.initialize();if(g.offset.doesNotIncludeMarginInBodyOffset){_+=parseFloat(g.css(B,"marginTop"))||0;A+=parseFloat(g.css(B,"marginLeft"))||0;}return{top:_,left:A};},setOffset:function(A,G,I){var C=g.css(A,"position");if(C==="static"){A.style.position="relative";}var _=g(A),J=_.offset(),L=g.css(A,"top"),E=g.css(A,"left"),H=(C==="absolute"&&g.inArray("auto",[L,E])>-1),B={},F={},K,D;if(H){F=_.position();}K=H?F.top:parseInt(L,10)||0;D=H?F.left:parseInt(E,10)||0;if(g.isFunction(G)){G=G.call(A,I,J);}if(G.top!=null){B.top=(G.top-J.top)+K;}if(G.left!=null){B.left=(G.left-J.left)+D;}if("using"in G){G.using.call(A,B);}else{_.css(B);}}};g.fn.extend({position:function(){if(!this[0]){return null;}var _=this[0],A=this.offsetParent(),C=this.offset(),B=P.test(A[0].nodeName)?{top:0,left:0}:A.offset();C.top-=parseFloat(g.css(_,"marginTop"))||0;C.left-=parseFloat(g.css(_,"marginLeft"))||0;B.top+=parseFloat(g.css(A[0],"borderTopWidth"))||0;B.left+=parseFloat(g.css(A[0],"borderLeftWidth"))||0;return{top:C.top-B.top,left:C.left-B.left};},offsetParent:function(){return this.map(function(){var _=this.offsetParent||m0.body;while(_&&(!P.test(_.nodeName)&&g.css(_,"position")==="static")){_=_.offsetParent;}return _;});}});g.each(["Left","Top"],function(_,A){var B="scroll"+A;g.fn[B]=function(A){var C=this[0],D;if(!C){return null;}if(A!==r0){return this.each(function(){D=B1(this);if(D){D.scrollTo(!_?A:g(D).scrollLeft(),_?A:g(D).scrollTop());}else{this[B]=A;}});}else{D=B1(C);return D?("pageXOffset"in D)?D[_?"pageYOffset":"pageXOffset"]:g.support.boxModel&&D.document.documentElement[B]||D.document.body[B]:C[B];}};});function B1(_){return g.isWindow(_)?_:_.nodeType===9?_.defaultView||_.parentWindow:false;}g.each(["Height","Width"],function(_,B){var A=B.toLowerCase();g.fn["inner"+B]=function(){return this[0]?parseFloat(g.css(this[0],A,"padding")):null;};g.fn["outer"+B]=function(_){return this[0]?parseFloat(g.css(this[0],A,_?"margin":"border")):null;};g.fn[A]=function(F){var _=this[0];if(!_){return F==null?null:this;}if(g.isFunction(F)){return this.each(function(_){var B=g(this);B[A](F.call(this,_,B[A]()));});}if(g.isWindow(_)){var D=_.document.documentElement["client"+B];return _.document.compatMode==="CSS1Compat"&&D||_.document.body["client"+B]||D;}else{if(_.nodeType===9){return Math.max(_.documentElement["client"+B],_.body["scroll"+B],_.documentElement["scroll"+B],_.body["offset"+B],_.documentElement["offset"+B]);}else{if(F===r0){var C=g.css(_,A),E=parseFloat(C);return g.isNaN(E)?C:E;}else{return this.css(A,typeof F==="string"?F:F+"px");}}}};});E0.jQuery=E0.$=g;})(window);var SWFUpload;if(SWFUpload==undefined){SWFUpload=function(_){this.initSWFUpload(_);};}SWFUpload.prototype.initSWFUpload=function(_){try{this.customSettings={};this.settings=_;this.eventQueue=[];this.movieName="SWFUpload_"+SWFUpload.movieCount++;this.movieElement=null;SWFUpload.instances[this.movieName]=this;this.initSettings();this.loadFlash();this.displayDebugInfo();}catch(A){delete SWFUpload.instances[this.movieName];throw A;}};SWFUpload.instances={};SWFUpload.movieCount=0;SWFUpload.version="2.2.0 2009-03-25";SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130};SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290};SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5};SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120};SWFUpload.CURSOR={ARROW:-1,HAND:-2};SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"};SWFUpload.completeURL=function(A){if(typeof(A)!=="string"||A.match(/^https?:\/\//i)||A.match(/^\//)){return A;}var _=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),B=window.location.pathname.lastIndexOf("/");if(B<=0){path="/";}else{path=window.location.pathname.substr(0,B)+"/";}return path+A;};SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(A,_){this.settings[A]=(this.settings[A]==undefined)?_:this.settings[A];};this.ensureDefault("upload_url","");this.ensureDefault("preserve_relative_urls",false);this.ensureDefault("file_post_name","Filedata");this.ensureDefault("post_params",{});this.ensureDefault("use_query_string",false);this.ensureDefault("requeue_on_error",false);this.ensureDefault("http_success",[]);this.ensureDefault("assume_success_timeout",0);this.ensureDefault("file_types","*.*");this.ensureDefault("file_types_description","All Files");this.ensureDefault("file_size_limit",0);this.ensureDefault("file_upload_limit",0);this.ensureDefault("file_queue_limit",0);this.ensureDefault("flash_url","swfupload.swf");this.ensureDefault("prevent_swf_caching",true);this.ensureDefault("button_image_url","");this.ensureDefault("button_width",1);this.ensureDefault("button_height",1);this.ensureDefault("button_text","");this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;");this.ensureDefault("button_text_top_padding",0);this.ensureDefault("button_text_left_padding",0);this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES);this.ensureDefault("button_disabled",false);this.ensureDefault("button_placeholder_id","");this.ensureDefault("button_placeholder",null);this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW);this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW);this.ensureDefault("debug",false);this.settings.debug_enabled=this.settings.debug;this.settings.return_upload_start_handler=this.returnUploadStart;this.ensureDefault("swfupload_loaded_handler",null);this.ensureDefault("file_dialog_start_handler",null);this.ensureDefault("file_queued_handler",null);this.ensureDefault("file_queue_error_handler",null);this.ensureDefault("file_dialog_complete_handler",null);this.ensureDefault("upload_start_handler",null);this.ensureDefault("upload_progress_handler",null);this.ensureDefault("upload_error_handler",null);this.ensureDefault("upload_success_handler",null);this.ensureDefault("upload_complete_handler",null);this.ensureDefault("debug_handler",this.debugMessage);this.ensureDefault("custom_settings",{});this.customSettings=this.settings.custom_settings;if(!!this.settings.prevent_swf_caching){this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+new Date().getTime();}if(!this.settings.preserve_relative_urls){this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url);if(this.settings.button_image_url!==""){this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url);}}delete this.ensureDefault;};SWFUpload.prototype.loadFlash=function(){var A,_;if(document.getElementById(this.movieName)!==null){throw"ID "+this.movieName+" is already in use. The Flash Object could not be added";}A=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder;if(A==undefined){throw"Could not find the placeholder element: "+this.settings.button_placeholder_id;}_=document.createElement("div");_.innerHTML=this.getFlashHTML();A.parentNode.replaceChild(_.firstChild,A);if(window[this.movieName]==undefined){window[this.movieName]=this.getMovieElement();}};SWFUpload.prototype.getFlashHTML=function(){return['<object id="',this.movieName,'" type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("");};SWFUpload.prototype.getFlashVars=function(){var _=this.buildParamString(),A=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(A),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(_),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("");};SWFUpload.prototype.getMovieElement=function(){if(this.movieElement==undefined){this.movieElement=document.getElementById(this.movieName);}if(this.movieElement===null){throw"Could not find Flash element";}return this.movieElement;};SWFUpload.prototype.buildParamString=function(){var _=this.settings.post_params,A=[];if(typeof(_)==="object"){for(var B in _){if(_.hasOwnProperty(B)){A.push(encodeURIComponent(B.toString())+"="+encodeURIComponent(_[B].toString()));}}}return A.join("&amp;");};SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,false);var A=null;A=this.getMovieElement();if(A&&typeof(A.CallFunction)==="unknown"){for(var _ in A){try{if(typeof(A[_])==="function"){A[_]=null;}}catch(C){}}try{A.parentNode.removeChild(A);}catch(D){}}window[this.movieName]=null;SWFUpload.instances[this.movieName]=null;delete SWFUpload.instances[this.movieName];this.movieElement=null;this.settings=null;this.customSettings=null;this.eventQueue=null;this.movieName=null;return true;}catch(B){return false;}};SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","\t","upload_url:               ",this.settings.upload_url,"\n","\t","flash_url:                ",this.settings.flash_url,"\n","\t","use_query_string:         ",this.settings.use_query_string.toString(),"\n","\t","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","\t","http_success:             ",this.settings.http_success.join(", "),"\n","\t","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","\t","file_post_name:           ",this.settings.file_post_name,"\n","\t","post_params:              ",this.settings.post_params.toString(),"\n","\t","file_types:               ",this.settings.file_types,"\n","\t","file_types_description:   ",this.settings.file_types_description,"\n","\t","file_size_limit:          ",this.settings.file_size_limit,"\n","\t","file_upload_limit:        ",this.settings.file_upload_limit,"\n","\t","file_queue_limit:         ",this.settings.file_queue_limit,"\n","\t","debug:                    ",this.settings.debug.toString(),"\n","\t","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","\t","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","\t","button_placeholder:       ",(this.settings.button_placeholder?"Set":"Not Set"),"\n","\t","button_image_url:         ",this.settings.button_image_url.toString(),"\n","\t","button_width:             ",this.settings.button_width.toString(),"\n","\t","button_height:            ",this.settings.button_height.toString(),"\n","\t","button_text:              ",this.settings.button_text.toString(),"\n","\t","button_text_style:        ",this.settings.button_text_style.toString(),"\n","\t","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","\t","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","\t","button_action:            ",this.settings.button_action.toString(),"\n","\t","button_disabled:          ",this.settings.button_disabled.toString(),"\n","\t","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","\t","swfupload_loaded_handler assigned:  ",(typeof this.settings.swfupload_loaded_handler==="function").toString(),"\n","\t","file_dialog_start_handler assigned: ",(typeof this.settings.file_dialog_start_handler==="function").toString(),"\n","\t","file_queued_handler assigned:       ",(typeof this.settings.file_queued_handler==="function").toString(),"\n","\t","file_queue_error_handler assigned:  ",(typeof this.settings.file_queue_error_handler==="function").toString(),"\n","\t","upload_start_handler assigned:      ",(typeof this.settings.upload_start_handler==="function").toString(),"\n","\t","upload_progress_handler assigned:   ",(typeof this.settings.upload_progress_handler==="function").toString(),"\n","\t","upload_error_handler assigned:      ",(typeof this.settings.upload_error_handler==="function").toString(),"\n","\t","upload_success_handler assigned:    ",(typeof this.settings.upload_success_handler==="function").toString(),"\n","\t","upload_complete_handler assigned:   ",(typeof this.settings.upload_complete_handler==="function").toString(),"\n","\t","debug_handler assigned:             ",(typeof this.settings.debug_handler==="function").toString(),"\n"].join(""));};SWFUpload.prototype.addSetting=function(B,_,A){if(_==undefined){return(this.settings[B]=A);}else{return(this.settings[B]=_);}};SWFUpload.prototype.getSetting=function(_){if(this.settings[_]!=undefined){return this.settings[_];}return"";};SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement(),returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>");returnValue=eval(returnString);}catch(ex){throw"Call to "+functionName+" failed";}if(returnValue!=undefined&&typeof returnValue.post==="object"){returnValue=this.unescapeFilePostParams(returnValue);}return returnValue;};SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile");};SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles");};SWFUpload.prototype.startUpload=function(_){this.callFlash("StartUpload",[_]);};SWFUpload.prototype.cancelUpload=function(A,_){if(_!==false){_=true;}this.callFlash("CancelUpload",[A,_]);};SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload");};SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats");};SWFUpload.prototype.setStats=function(_){this.callFlash("SetStats",[_]);};SWFUpload.prototype.getFile=function(_){if(typeof(_)==="number"){return this.callFlash("GetFileByIndex",[_]);}else{return this.callFlash("GetFile",[_]);}};SWFUpload.prototype.addFileParam=function(B,A,_){return this.callFlash("AddFileParam",[B,A,_]);};SWFUpload.prototype.removeFileParam=function(A,_){this.callFlash("RemoveFileParam",[A,_]);};SWFUpload.prototype.setUploadURL=function(_){this.settings.upload_url=_.toString();this.callFlash("SetUploadURL",[_]);};SWFUpload.prototype.setPostParams=function(_){this.settings.post_params=_;this.callFlash("SetPostParams",[_]);};SWFUpload.prototype.addPostParam=function(A,_){this.settings.post_params[A]=_;this.callFlash("SetPostParams",[this.settings.post_params]);};SWFUpload.prototype.removePostParam=function(_){delete this.settings.post_params[_];this.callFlash("SetPostParams",[this.settings.post_params]);};SWFUpload.prototype.setFileTypes=function(_,A){this.settings.file_types=_;this.settings.file_types_description=A;this.callFlash("SetFileTypes",[_,A]);};SWFUpload.prototype.setFileSizeLimit=function(_){this.settings.file_size_limit=_;this.callFlash("SetFileSizeLimit",[_]);};SWFUpload.prototype.setFileUploadLimit=function(_){this.settings.file_upload_limit=_;this.callFlash("SetFileUploadLimit",[_]);};SWFUpload.prototype.setFileQueueLimit=function(_){this.settings.file_queue_limit=_;this.callFlash("SetFileQueueLimit",[_]);};SWFUpload.prototype.setFilePostName=function(_){this.settings.file_post_name=_;this.callFlash("SetFilePostName",[_]);};SWFUpload.prototype.setUseQueryString=function(_){this.settings.use_query_string=_;this.callFlash("SetUseQueryString",[_]);};SWFUpload.prototype.setRequeueOnError=function(_){this.settings.requeue_on_error=_;this.callFlash("SetRequeueOnError",[_]);};SWFUpload.prototype.setHTTPSuccess=function(_){if(typeof _==="string"){_=_.replace(" ","").split(",");}this.settings.http_success=_;this.callFlash("SetHTTPSuccess",[_]);};SWFUpload.prototype.setAssumeSuccessTimeout=function(_){this.settings.assume_success_timeout=_;this.callFlash("SetAssumeSuccessTimeout",[_]);};SWFUpload.prototype.setDebugEnabled=function(_){this.settings.debug_enabled=_;this.callFlash("SetDebugEnabled",[_]);};SWFUpload.prototype.setButtonImageURL=function(_){if(_==undefined){_="";}this.settings.button_image_url=_;this.callFlash("SetButtonImageURL",[_]);};SWFUpload.prototype.setButtonDimensions=function(_,A){this.settings.button_width=_;this.settings.button_height=A;var B=this.getMovieElement();if(B!=undefined){B.style.width=_+"px";B.style.height=A+"px";}this.callFlash("SetButtonDimensions",[_,A]);};SWFUpload.prototype.setButtonText=function(_){this.settings.button_text=_;this.callFlash("SetButtonText",[_]);};SWFUpload.prototype.setButtonTextPadding=function(A,_){this.settings.button_text_top_padding=_;this.settings.button_text_left_padding=A;this.callFlash("SetButtonTextPadding",[A,_]);};SWFUpload.prototype.setButtonTextStyle=function(_){this.settings.button_text_style=_;this.callFlash("SetButtonTextStyle",[_]);};SWFUpload.prototype.setButtonDisabled=function(_){this.settings.button_disabled=_;this.callFlash("SetButtonDisabled",[_]);};SWFUpload.prototype.setButtonAction=function(_){this.settings.button_action=_;this.callFlash("SetButtonAction",[_]);};SWFUpload.prototype.setButtonCursor=function(_){this.settings.button_cursor=_;this.callFlash("SetButtonCursor",[_]);};SWFUpload.prototype.queueEvent=function(_,B){if(B==undefined){B=[];}else{if(!(B instanceof Array)){B=[B];}}var A=this;if(typeof this.settings[_]==="function"){this.eventQueue.push(function(){this.settings[_].apply(this,B);});setTimeout(function(){A.executeNextEvent();},0);}else{if(this.settings[_]!==null){throw"Event handler "+_+" is unknown or is not a function";}}};SWFUpload.prototype.executeNextEvent=function(){var _=this.eventQueue?this.eventQueue.shift():null;if(typeof(_)==="function"){_.apply(this);}};SWFUpload.prototype.unescapeFilePostParams=function(B){var E=/[$]([0-9a-f]{4})/i,D={},C;if(B!=undefined){for(var A in B.post){if(B.post.hasOwnProperty(A)){C=A;var _;while((_=E.exec(C))!==null){C=C.replace(_[0],String.fromCharCode(parseInt("0x"+_[1],16)));}D[C]=B.post[A];}}B.post=D;}return B;};SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface");}catch(_){return false;}};SWFUpload.prototype.flashReady=function(){var _=this.getMovieElement();if(!_){this.debug("Flash called back ready but the flash movie can't be found.");return;}this.cleanUp(_);this.queueEvent("swfupload_loaded_handler");};SWFUpload.prototype.cleanUp=function(A){try{if(this.movieElement&&typeof(A.CallFunction)==="unknown"){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var _ in A){try{if(typeof(A[_])==="function"){A[_]=null;}}catch(C){}}}}catch(B){}window.__flash__removeCallback=function(_,B){try{if(_){_[B]=null;}}catch(A){}};};SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler");};SWFUpload.prototype.fileQueued=function(_){_=this.unescapeFilePostParams(_);this.queueEvent("file_queued_handler",_);};SWFUpload.prototype.fileQueueError=function(A,B,_){A=this.unescapeFilePostParams(A);this.queueEvent("file_queue_error_handler",[A,B,_]);};SWFUpload.prototype.fileDialogComplete=function(A,B,_){this.queueEvent("file_dialog_complete_handler",[A,B,_]);};SWFUpload.prototype.uploadStart=function(_){_=this.unescapeFilePostParams(_);this.queueEvent("return_upload_start_handler",_);};SWFUpload.prototype.returnUploadStart=function(_){var A;if(typeof this.settings.upload_start_handler==="function"){_=this.unescapeFilePostParams(_);A=this.settings.upload_start_handler.call(this,_);}else{if(this.settings.upload_start_handler!=undefined){throw"upload_start_handler must be a function";}}if(A===undefined){A=true;}A=!!A;this.callFlash("ReturnUploadStart",[A]);};SWFUpload.prototype.uploadProgress=function(A,_,B){A=this.unescapeFilePostParams(A);this.queueEvent("upload_progress_handler",[A,_,B]);};SWFUpload.prototype.uploadError=function(A,B,_){A=this.unescapeFilePostParams(A);this.queueEvent("upload_error_handler",[A,B,_]);};SWFUpload.prototype.uploadSuccess=function(B,A,_){B=this.unescapeFilePostParams(B);this.queueEvent("upload_success_handler",[B,A,_]);};SWFUpload.prototype.uploadComplete=function(_){_=this.unescapeFilePostParams(_);this.queueEvent("upload_complete_handler",_);};SWFUpload.prototype.debug=function(_){this.queueEvent("debug_handler",_);};SWFUpload.prototype.debugMessage=function(A){if(this.settings.debug){var C,B=[];if(typeof A==="object"&&typeof A.name==="string"&&typeof A.message==="string"){for(var _ in A){if(A.hasOwnProperty(_)){B.push(_+": "+A[_]);}}C=B.join("\n")||"";B=C.split("\n");C="EXCEPTION: "+B.join("\nEXCEPTION: ");SWFUpload.Console.writeLine(C);}else{SWFUpload.Console.writeLine(A);}}};SWFUpload.Console={};SWFUpload.Console.writeLine=function(B){var _,A;try{_=document.getElementById("SWFUpload_Console");if(!_){A=document.createElement("form");document.getElementsByTagName("body")[0].appendChild(A);_=document.createElement("textarea");_.id="SWFUpload_Console";_.style.fontFamily="monospace";_.setAttribute("wrap","off");_.wrap="off";_.style.overflow="auto";_.style.width="700px";_.style.height="350px";_.style.margin="5px";A.appendChild(_);}_.value+=B+"\n";_.scrollTop=_.scrollHeight-_.clientHeight;}catch(C){alert("Exception: "+C.name+" Message: "+C.message);}};$(function(B){B("#signout").click(function(A){var _=disk.RuntimeEnv.getURLComponent(disk.RuntimeEnv.URL_PRIMARY);window.location.href="https://passport.baidu.com/?logout&u="+_;A.preventDefault();});B("#flag-2-signout").click(function(A){var _=encodeURIComponent(location.href);window.location.href="https://passport.baidu.com/?logout&u="+_;A.preventDefault();});var A={disk:1,tongxunlu:2,xiangce:3,note:4,duanxin:5,zhaohui:6,youxi:7,jiankang:8,wenzhang:40};B("#vip-identity").bind("mouseover",function(_){_.stopPropagation();});B("#header").delegate(".has-pulldown","mouseover",function(_){B(this).find(".pulldown").show();_.stopPropagation();}).delegate(".has-pulldown","mouseout",function(_){B(this).find(".pulldown").hide();_.stopPropagation();}).find(".navs").delegate("a","click",function(J){var H=B(this),F=-1;if(H.hasClass("def-nav")){if(H.attr("href").indexOf("/apps")>=0){F=9;}else{if(!H.hasClass("pulldown-nav")){F=0;}}}else{var G=H.attr("class").split(/\s+/),C;for(var D=0,_=G.length;D<_;D++){C=A[G[D]];if(C>=1){F=C;break;}}}if(disk.DEBUG){console.log(F);}var E=function(){FileUtils._mDiskLog.send({type:"header_new_module",val:F});},I=function(){if(H.attr("target")=="_blank"){E();window.open(H.attr("href"));}else{B(window).bind("unload",function(){E();});window.location.href=H.attr("href");}};if(F!=-1){I();J.preventDefault();J.stopPropagation();return false;}});B("#header").delegate(".has-pulldown-special","mouseover",function(_){B(".pulldown-nav").css("background-color","#F6F6F9");B(this).find(".pulldown").show();B(".pulldown-nav").css("color","#333");B(".hd-main .navs .pulldown-nav em").css({"background-position":"-89px -55px"});_.stopPropagation();}).delegate(".has-pulldown-special","mouseout",function(_){B(".pulldown-nav").css("background-color","#0f0f0f");B(this).find(".pulldown").hide();B(".pulldown-nav").css("color","#fff");B(".hd-main .navs .pulldown-nav em").css({"background-position":"-89px -45px"});_.stopPropagation();});var D=disk.getParam("frm")=="hao123"?true:false,_=function(A,_){var C=0;if(A){C=_.innerWidth()+B(".logo-yun","#header").innerWidth();}else{C=B(".logo","#header").innerWidth();}return C+B(".navs","#header").innerWidth()+B(".info>ul","#header").innerWidth()+30-B("#header").width();},C=function(){var _=B("#header .navs").offset().left;B(".newhand-tips-dialog").css("left",_+30);B(".newhandTips3-bg").css("left",_+20);};B(window).bind("resize",function(){var A=B(".logo-hao123","#header"),E=(D&&(A.length>0)),F=function(){B("#departForAd").addClass("h-hide");if(E){if(_(E,A)>0){A.hide().next().css("marginLeft",10);}else{A.show().next().css("marginLeft",0);}}var D=B(".newhand-tips-dialog");if(D.length&&D.css("display")=="block"){C();}};if(_(E,A)>0){F();}else{if(B("#departForAd").text().trim().length){B("#departForAd").removeClass("h-hide");}if(_(E,A)>0){F();}else{A.show().next().css("marginLeft",0);}}});});function getDomainUrl(){var _,A=window.location.host;if(A.indexOf("/")!=-1){urlArray=A.split("/");_=urlArray[0];}else{_=A;}_=window.location.protocol+"//"+_;return _;}if(typeof disk=="undefined"){var disk={util:{},ui:{},api:{},tpl:{},widget:{},DEBUG:false};if(typeof console=="undefined"){var console={log:function(){},assert:function(){},info:function(){},warn:function(){},error:function(){}};}$.extend({stringify:function stringify(_){var A=typeof(_);if(A!="object"||_===null){if(A=="string"){_='"'+_+'"';}return String(_);}else{var D,E,C=[],B=(_&&_.constructor==Array);for(D in _){E=_[D];A=typeof(E);if(_.hasOwnProperty(D)){if(A=="string"){E='"'+E+'"';}else{if(A=="object"&&E!==null){E=$.stringify(E);}}C.push((B?"":'"'+D+'":')+String(E));}}return(B?"[":"{")+String(C)+(B?"]":"}");}},parseJSON:function(B){var _=/^[\],:{}\s]*$/,D=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,A=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,C=/(?:^|:|,)(?:\s*\[)+/g;if(typeof B==="object"){return B;}if(typeof B!=="string"||!B){return null;}B=$.trim(B);if(_.test(B.replace(D,"@").replace(A,"]").replace(C,""))){return window.JSON&&window.JSON.parse?window.JSON.parse(B):(new Function("return "+B))();}else{jQuery.error("Invalid JSON: "+B);}}});String.prototype.len=(function(){var _=/[^\x00-\xFF]/g;return this.replace(_,"..").length;});if(typeof String.prototype.trim=="undefined"){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/gi,"");};}String.prototype.toEntity=function(){return $("<div></div>").text(this.toString()).html();};disk.uniqueId=0;disk.obtainId=function(){return"_disk_id_"+(++disk.uniqueId);};disk.iframeLogin=function(){var _=function(){var _=disk.ui.LoginDialog.obtain();disk.docreaderVisible(false);_.setVisible(true);_.onLoginSuccessCallback=function(){};_.onCloseCallback=function(){disk.docreaderVisible(true);};};if($.browser.msie&&$.browser.version=="6.0"){setTimeout(function(){_();},50);}else{_();}};disk.docreaderVisible=function(A){if(!$("#chunleireader").length){return;}var _=disk.Context.getService(disk.Context.SERVICE_CANVAS);if(A){$("#chunleireader").css("display","block");if(!disk.util.ViewShareUtils){_.setVisible(A);}}else{$("#chunleireader").css("display","none");if(!disk.util.ViewShareUtils){_.setVisible(A);}}};disk.getParam=function(C,B){var A=new RegExp("(?:^|\\?|#|&)"+C+"=([^&#]*)(?:$|&|#)","i"),_=A.exec(B||location.href);return _?_[1]:"";};disk.setParam=function(C,D,B){var A=new RegExp("(?:^|\\?|#|&)"+C+"=([^&#]*)(?:$|&|#)","i"),_=A.exec(B||location.href);if(_!=null){return B.replace(_[1],D);}return null;};var RuntimeEnv={getURLComponent:function(_){if(_==disk.RuntimeEnv.URL_PROTOCOL){return location.protocol;}else{if(_==disk.RuntimeEnv.URL_PORT){return location.port;}else{if(_==disk.RuntimeEnv.URL_HOST){return location.host;}else{if(_==disk.RuntimeEnv.URL_PRIMARY){return location.protocol+"//"+location.host;}else{if(_==disk.RuntimeEnv.URL_WITHPARAM){return location.protocol+"//"+location.host+(location.search?location.search:"");}else{return null;}}}}}}};RuntimeEnv.URL_PROTOCOL=1;RuntimeEnv.URL_PORT=2;RuntimeEnv.URL_HOST=4;RuntimeEnv.URL_PRIMARY=8;RuntimeEnv.URL=16;RuntimeEnv.URL_WITHPARAM=18;disk.RuntimeEnv=RuntimeEnv;}try{if(window.console&&window.console.log&&top===self){console.log("\n\n\n%c",'font-size:0;margin-top:20px;line-height:36px;padding-top:50px;padding-left:158px;background:url("data:image/png;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/2wBDAQkJCQwLDBgNDRgyIRwhMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjL/wAARCAAyAJ4DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD3+iiigCtfX9vp1sZ7hwqjoO5PoK5afxu/mH7ParszwXPNc94y1sz6/Nbb/wB1a/IF/wBrqTXR+HvCls+nxXWoqZZZlDiPJAQHp+NerDD0aFFVK2rZ5U69avVdOi7JBa+NgXAurXap/ijOcV1Vtcw3kCzwOHjYcEVxnijwzBZae9/YBkEXMkecjHqM+lUvAest/ar6ezZjmQso9GH/ANalVw1KrRdahpbdDpV61KsqVbW56NRRRXlnqBRRVOTVtOhlaKW/tkkU4ZWlUEH6ZoAuUVQ/tvSv+glaf9/l/wAaP7b0r/oJWn/f5f8AGgC/RUMF1b3MXmwTxyxg43owI/On+dF/z1T/AL6FAD6Ko2utaXfSyRWmo2s8kX31jlVivbnBq2JYycCRCT2DUAPopjTRKcNIgI7FhSefD/z1j/76FAElFR+fD/z1j/76FPVlYZVgR6g0AMmmjgiaWVgqKMkmuO1fxrIkEj6YqkoM/vE+8O+DmqfxF1loJrXTVbarKZXHrzgf1qPwh4ei1iye8vdzW7MUSMHG7HXJ9K9COEgsM61XrscDxlT61GlSSdt76+p59qN1/al5LeyuUmmYu5XkE/SvY/CPiG01bRrePz4xdwxqksecHIGMgehrP174f6XdafIdMgFrdopMe1jtYjsQf5145E00krBJHh8s/PIpIK89OO5rzqVXE1akKFR8yb062PqcRh8sqYWri8PHklFXfS/6a7K3U9u8Zarbpo9xp6XCC4uF2HHOxT1OPXHQVwWivaaHex3lusktwgIDSvxzweBWVpkV1q1/DZWiPJK/djnA7lj/AFr1aw8FaTa2qx3EP2mbHzyOSMn2APFfQS9jgqfspNu58NH22Nqe0jpbb+u5X03xzaXEqxXqfZ2bgODlfx9K6tWDKGUgg8gjvXlPjbw+mgPDdWhY2kzFdpOSjdcZ9MfyrovhzrL6hpc9pKxZrVwFJ67T0rjxOFpuj9Yo7HZhsTUVb2Fbc7WvIfGeneCrHxNctq39q/bLj9+/kBSnPp+VevV4x8Q7yPT/AIlWN7NEZY4FikeMYywDZI5rzD0zjteHh3fCNAW82YPmm7xnPbGPxrVtE8AfY4RdnWWudg80xqu0t3xz0rr/APha+g/9C7P/AN8x1heLfHel+IdDaws9HktZTIr+YyoAAO3HNAHaWdlpln8Kb59HNx9juLeWZPPPzgng5x9K8tMOm2ehaddXEN9PcXRcsVm2oqq2MD3r1DS/+SKD/sHyfzauDll05vAWhWd9eS2rmea4jZITICAdv55NAEKweGAMjSPEYJ9HH/xNXvCUmjnxzYRQWGpxssuYzLPkqdp++uOn/wBaro8a6hHEMeJbsIqjBOkDGPrip/BmqaXL47+2y6pdX2pXymMAWnlr0HJ/BewoA6jXfhpYa9rNxqU2oXcckxGUTGBgAentWd/wp3S/+gpff+O/4Vk/FLRo9PuG1ganP9ovZQkdoowMBQCc59h27irWn/Cqa5063nudduoZ5I1d4wmdhIzjrQBc/wCFO6X/ANBS+/8AHf8ACuz8O6FD4c0aLTIJpJo42Zg8mMncSf61xDfCVI1LN4kulUdSY8Af+PV2nhjR00LQobCO8a8VGZhM3U5Yn1PTOKAPPvi1aSw6lYagobyniMRI6Bgcj8wT+VXPhv4stI9OOk3kgieNy0bN0IPJ/XNd9rGkWmuaZLY3ibo3HBHVT2I968h1T4c6zps5MEbXUIOUlhOG/EdQa9vD1KOJwyw9R2a2PHrwq4bEPEU48ye56jrPifT9M02a4FzG7Kp2lTkA9s/4d68HjE+pX0dpYwu7SSHy4x1Zj1J9z+lbsXg7xFqUqxta3bY6G4YhV9/mr0vwf4Kt/DUZuJmWfUJBhpMcIPRf8aqCw+Ai535p9CZzr49qmk4w3f8AWl/Is+EPCsPhrTsNiS+mAM8v/so9hXR0UV4tSpKpNzm9WevTpxpxUIrRGJ4p8Px+JNHNm85gdXEkcgGQGAI5HcYJqn4O8Jx+GLacm6+0zzkFnC4UAdABU3jKPVJNDzpUZmkSQNJEpwXTByB+ODj2rO8AW2tRWt3LqkUlvFI4MMEh5HqfbNdkef6o/f0vsccuT62vc1tudlXjnxAmay+JFjfG1knjt1ikZFX7wDZI6V7HRXAd55h/ws+w/wChXn/Jf/iawvFnjKDxFoh0+20Ga2kMiv5m0Hp24Fe2UUAcPZWlxb/B77NNDIk4sHBjK/Nzkjj8a4Sy1Oxi8H2+i6r4cvLtgXkSZPkaMlj904yOle50UAfPsmn+M5PDoR7fUjpAbiIjkL2+Xrj3xiuv8D6rpen6ha6dZeGb2Ga4bZJez/M3TOSccDjoMda9TooA8a8fX00/j+3M+n3FzY6dsxGgIEnRjzjvwPwrc/4WvL/0LN5/38/+xr0migDyPxF8QZ9c0C801fD95C1wm0SFydvPXG2ux+HFtcWngixjuYXikJdtrgg4LEg8+orq6KACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigD//Z");background-repeat:no-repeat;');console.log("\u54a6\uff01\u8fd9\u4e48\u5de7\u4f60\u4e5f\u559c\u6b22\u7814\u7a76WEB\u6280\u672f\uff01\r\n\u53c8\u8fd9\u4e48\u5de7\u6211\u4eec\u6025\u9700\u50cf\u4f60\u8fd9\u6837\u7684\u4e13\u4e1aWEB\u4eba\u58eb!\r\n\u6765\u767e\u5ea6\u4e91\u5427\uff0c\u548c\u6211\u4eec\u4e00\u8d77\u6539\u53d8\u767e\u5ea6\u4e91\uff01\u6539\u53d8\u4e91\u5b58\u50a8\uff01\r\n\u804c\u4f4d\u4ecb\u7ecd\uff0c\u524d\u7aef\uff1ahttp://dwz.cn/mbufe \u540e\u7aef\uff1ahttp://dwz.cn/frvsI");console.log("\r\u8bf7\u5c06\u7b80\u5386\u53d1\u9001\u81f3 %c spacehr@baidu.com\uff08 \u90ae\u4ef6\u6807\u9898\u8bf7\u4ee5\u201c\u59d3\u540d-\u5e94\u8058XX\u804c\u4f4d-\u6765\u81eaconsole-FE/SERVER\u201d\u547d\u540d\uff09","color:red");}}catch(e){}(function(){var _=function(_){this._mUI=_;this._mPrivateFlags=0;this._mCoor=[];};_.VISIBLE=1;_.TOP=4096;_.RIGHT=8192;_.BOTTOM=16384;_.LEFT=32768;_.CENTER=65536;_.prototype={setVisible:function(A){var _=(this._mPrivateFlags&disk.ui.Panel.VISIBLE)==disk.ui.Panel.VISIBLE;if(A===_){return;}if(A){this._mPrivateFlags|=disk.ui.Panel.VISIBLE;this._mUI.pane.style.display="block";}else{this._mPrivateFlags&=~disk.ui.Panel.VISIBLE;this._mUI.pane.style.display="none";}this.onVisibilityChange(A);},setVisibleAnimation:function(B,_){var A=(this._mPrivateFlags&disk.ui.Panel.VISIBLE)==disk.ui.Panel.VISIBLE;if(B===A){return;}if(B){this._mPrivateFlags|=disk.ui.Panel.VISIBLE;$(this._mUI.pane).css({display:"block",opacity:0}).animate({opacity:_},500);}else{this._mPrivateFlags&=~disk.ui.Panel.VISIBLE;$(this._mUI.pane).hide().css("opacity",0);}this.onVisibilityChange(B);},isVisible:function(){return(this._mPrivateFlags&disk.ui.Panel.VISIBLE)==disk.ui.Panel.VISIBLE;},setSize:function(_,A){this._mUI.pane.style.width=_+"px";this._mUI.pane.style.height=A+"px";},setLocation:function(A,_){_=Math.max(0,_);this._mUI.pane.style.left=A+"px";this._mUI.pane.style.top=_+"px";this._mCoor[0]=A;this._mCoor[1]=_;},getLocation:function(){return this._mCoor;},setGravity:function(A){switch(A){case _.LEFT:this.setLocation(0,0);break;case _.CENTER:this.setLocation(($(window).width()-this._mUI.pane.offsetWidth)/2,($(window).height()-this._mUI.pane.offsetHeight)/2+$(window).scrollTop());break;case _.TOP:this.setLocation(($(window).width()-this._mUI.pane.offsetWidth)/2,($(window).scrollTop()||0)+80);break;}},onVisibilityChange:function(){}};disk.ui.Panel=_;})();disk.ui.Utilities={TREENODE_EXTRA_SPACE_PIXEL:0,IGNORE_PARTICULAR_DIR:true,IGNORE_EMPTY_DIR:false,_mTreeSelectDir:"",BETA_INFO:null,globalTreeNodeSelectHandler:null,_mOptionConf:{},setGlobalTreeNodeSelectHandler:function(_){this.globalTreeNodeSelectHandler=_;},handleTreeNodeSelect:function(C,_,A,B){var D=this;if(B===true&&!disk.ui.Utilities.IGNORE_EMPTY_DIR){if(disk.ui.Utilities.globalTreeNodeSelectHandler!=null&&A!==true){disk.ui.Utilities.globalTreeNodeSelectHandler.call(C,C);}return;}if(disk.DEBUG){console.log("handeTreeNodeSelect");}if(C.getAttr("build")){disk.ui.Utilities._mTreeSelectDir=C.getAttr("dir");if(typeof _=="function"){_.call(this,C);}if(disk.ui.Utilities.globalTreeNodeSelectHandler!=null&&A!==true){disk.ui.Utilities.globalTreeNodeSelectHandler.call(C,C);}return;}disk.ui.Utilities._mTreeSelectDir=undefined;C.setLoading(true);FileUtils.loadDir(C.getAttr("dir"),function(D){if(typeof disk.ui.Utilities._mTreeSelectDir=="undefined"&&disk.ui.Utilities.globalTreeNodeSelectHandler!=null&&A!==true){disk.ui.Utilities.globalTreeNodeSelectHandler.call(C,C);}C.setAttr("build",true);C.setLoading(false);var H=null,I=null,D=D||[];for(var E=0,B=D.length;E<B;E++){H=D[E];I=H.path;if(H.isdir){var G=FileUtils.isInParticularDir(FileUtils.parseDirPath(I)),F=new disk.ui.TreeNode(C,{text:FileUtils.getNormalizedPath(FileUtils.parseDirPath(I),true),onSelect:disk.ui.Utilities.handleTreeNodeSelect,onExpand:disk.ui.Utilities.handleTreeNodeExpand,empty:H.empty,dir_empty:H.dir_empty,isParti:G});F.setAttr("dir",FileUtils.parseDirPath(I));}}if(D.length>0){C.expand(true);}if(typeof _=="function"){_.call(this,C);}});},handleTreeNodeExpand:function(C,B){if(disk.DEBUG){console.log("node expanded "+C);}var A=disk.ui.UploadDialog.active,_=disk.ui.MoveCopyDialog.active;if(A!=null&&A.isVisible()){A.requestLayoutTreeview();}else{if(_!=null&&_.isVisible()){_.requestLayoutTreeview();}}},selectTextField:function(B,_,A){if(B.createTextRange){var C=B.createTextRange();C.collapse(true);C.moveStart("character",_);C.moveEnd("character",A);C.select();}else{if(B.setSelectionRange){B.setSelectionRange(_,A);}else{if(B.selectionStart){B.selectionStart=_;B.selectionEnd=A;}}}B.focus();},getThumbnail:function(D,F){F=$.extend({width:115,height:115},F);if(typeof D.thumbs!=="undefined"&&typeof D.thumbs.url1!=="undefined"){var C=D.thumbs.url1;if(C.indexOf("&size=c140_u90")>0){return C.replace("&size=c140_u90","&size=c"+F.width+"_u"+F.height);}}var E=disk.api.RestAPI.THUMBNAIL_GENERATE,B={path:D.path,width:F.width,height:F.height,quality:100};for(var _ in B){var A=encodeURIComponent(B[_]);E+="&"+_+"="+A;}return E;},bringNodeToFrontInTreeview:function(A,E){var H=(typeof E!="undefined")?E:disk.ui.TreeLeaf.activeLeaf;if(H==null){return;}var _=A.offset(),D=$("span",H.getNode()).offset(),C=$(H.getNode()).height(),B=$(H.getNode()).width(),G=A.height();if(D.top+C-_.top>G*4/5){A.scrollTop(A.scrollTop()+D.top-_.top-G+C+G/2);if(disk.DEBUG){console.log(">>>>scroll down to become visible");}}else{if(D.top-_.top<0){A.scrollTop(A.scrollTop()-Math.abs(_.top-D.top+G/2));if(disk.DEBUG){console.log(">>>>scroll up to become visible");}}}if(H.getHost().getDeep()<3){return;}var F=D.left-_.left;if(F>0){A.scrollLeft(A.scrollLeft()+D.left-_.left+20);if(disk.DEBUG){console.log(">>>>>scroll right to become visible");}}else{if(F<0){A.scrollLeft(A.scrollLeft()-Math.abs(_.left-D.left));if(disk.DEBUG){console.log(">>>>>scroll left to become visible");}}}},encodeHTML:function(_){return String(_).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;");},getFlashVersion:function(){var f=null,n=navigator;if(n.plugins&&n.plugins.length){for(var ii=0,len=n.plugins.length;ii<len;ii++){if(n.plugins[ii].name.indexOf("Shockwave Flash")!=-1){f=n.plugins[ii].description.split("Shockwave Flash ")[1];break;}}}else{if(window.ActiveXObject){for(ii=11;ii>=2;ii--){try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+".0";break;}}catch(e){}}}}return f;},_testify0:function(_){var A=this.BETA_INFO.expvar,B=false;if(A&&A.length>0){if($.inArray(_,A)>=0){B=true;}}return B;},getBetaFeature:function(_){if(!document||!document.body){return false;}if(this.BETA_INFO!=null){return this._testify0(_);}var A=disk.ui.Utilities.BETA_STR;if(A){var B=$.parseJSON(A);if(!B){return false;}this.BETA_INFO=B;return this._testify0(_);}else{return false;}},getBetaFeatureByPersonal:function(){return this.getBetaFeature("exp_pub");},getBetaFeatureByDevice:function(){return this.getBetaFeature("device_pub");},getBetaFeatureByEmule:function(){return this.getBetaFeature("emule_pub");},getBetaFeatureByMagnet:function(){return this.getBetaFeature("magnet_pub");},getBetaFeatureByVideoFlash:function(){return this.getBetaFeature("sharevideo_pub");},getBetaFeatureByTimeLine:function(){return this.getBetaFeature("timeline_pub");},getBetaFeatureByVideoSrt:function(){return this.getBetaFeature("videosrt_pub");},_html5Compatible:function(){return(typeof FormData!="undefined");},execOptionQuery:function(){var _=this._mOptionConf;if(_.progress>0){}else{if(this._html5Compatible()){var A=new XMLHttpRequest();A.onreadystatechange=function(B){if(B.target.readyState==4){if(disk.DEBUG){console.log("readyState=",A.readyState,"status=",A.status);}FileUtils._mDiskLog.send({type:"html5optionsstatus",value:B.target.status});_.progress=2;if(typeof localStorage!="undefined"&&typeof localStorage.getItem!="undefined"){localStorage.setItem("pref_html_option_request",B.target.status==200?"1":"0");}}};A.open("OPTIONS","https://c.pcs.baidu.com/rest/2.0/pcs/file&channel=chunlei&clienttype=0",true);A.send(null);_.progress=1;}}},getSuggestedOptionQuery:function(){if(!this._html5Compatible()){return false;}if(typeof localStorage=="undefined"||typeof localStorage.getItem=="undefined"){return false;}var _=localStorage.getItem("pref_html_option_request");if(_==null||typeof _=="undefined"){return false;}return _=="1";}};(function(){var _=function(){this._mCache={};this._mDirty=false;};_.prototype={removeAll:function(){this._mCache={};this._mDirty=true;return this;},markDirty:function(_){this._mDirty=_;},isDirty:function(){return this._mDirty;},add:function(_,A){this._mCache[_]=A;},appendList:function(A,B){var _=this._mCache[A]||null;if(disk.DEBUG){console.assert(_!=null);}if(_){this._mCache[A]=_.concat(B);}this._mDirty=true;},insert:function(A,B){var _=this._mCache[A]||null;if(disk.DEBUG){console.assert(_!=null);}if(_){_.unshift(B);}this._mDirty=true;},muteRemove:function(_){delete this._mCache[_];},remove:function(_){delete this._mCache[_];this._mDirty=true;},descendentlyRemove:function(_,A){this._removeDescendent(_,A===true?true:false);this._mDirty=true;},preseveAndDescendentlyRemove:function(C,B){var A=this._mCache[C]||null;if(A!=null){for(var D=0,_=A.length;D<_;D++){if(B==FileUtils.parseDirPath(A[D].path)){A.splice(D,1);this._removeDescendent(B,false);break;}}}this._mDirty=true;},_removeDescendent:function(_,B){for(var A in this._mCache){if(this._mCache.hasOwnProperty(A)){if(B===true&&A==_){continue;}if(A.indexOf(_)==0){if(this._mCache[A].length){this.removeCategorys();}delete this._mCache[A];}}}this._mDirty=true;},update:function(A,_,B){this._mCache[A]=_;if(B===true){this._removeDescendent(A,true);}this._mDirty=true;},contains:function(_){return typeof this._mCache[_]!="undefined";},obtain:function(_){return this._mCache[_||"0"]||null;},obtainByAttr:function(A,F,C){if(typeof timestamp=="undefined"){var _=this._mCache[A||"0"],E=[];if(_){for(var B=0,D=_.length;B<D;B++){if(_[B][F]==C){E.push(_[B]);}}return E;}else{return null;}}}};disk.util.LocalCache=_;Function.prototype.method=function(_,A){this.prototype[_]=A;return this;};var A=function(){_.call(this);this._typeTable=null;this._pathByType={};};A.KEY_MODE_SEARCH=0;A.KEY_MODE_CATEGORY=1;A.KEY_MODE_NORMAL=2;A.KEY_PREFIX_SEARCH='\u641c\u7d22:"';A.KEY_SUFFIX_SEARCH='"';A.KEY_PREFIX_CATEGORY='\u5206\u7c7b:"';A.KEY_SUFFIX_CATEGORY='"';A.isKeyQulifier=function(_){return(typeof _=="string"&&_.length>0)||(typeof _=="number");};A.getCategoryCacheKeyByIdentifier=function(_){return A.KEY_PREFIX_CATEGORY+FileUtils.TYPES[_-1][1]+A.KEY_SUFFIX_CATEGORY;};A.prototype=new _();A.method("add",function(_,B){var F=this._mCache[_];if(F){var E={};for(var D in F){if(F.hasOwnProperty(D)){var H=F[D].path,G=H.slice(H.lastIndexOf("/"));E[G]=true;}}for(var A=0,C=B.length;A<C;A++){H=B[A].path,G=H.slice(H.lastIndexOf("/"));E[G]||F.push(B[A]);}delete this._pathByType[_];}else{this._mCache[_]=B;}this._TimeStamp||(this._TimeStamp={});this._TimeStamp[_]=new Date().getTime();}).method("_renameVictim",function(A,F,E,C){var D=F.path;for(var _=A.length,B=_-1;B>=0;B--){if(A[B].server_filename==F.server_filename){A[B].path=E;A[B].server_filename=C;this._removeDescendent(D,false);return true;}}return false;}).method("_putAsideVictims",function(B,I,A){var F=null,D=false,H=null,E=false;for(var _=B.length,C=_-1;C>=0;C--){for(var J=I.length,G=J-1;G>=0;G--){F=I[G];H=F.path||F;if(B[C].path==H){I.splice(G,1);if(A===true){}else{this._removeDescendent(F,false);}D=true;E=true;}}if(E){B.splice(C,1);E=false;}}return D;}).method("obtainByMode",function(B,C){var _=null;switch(B){case A.KEY_MODE_SEARCH:_=this._mCache[A.KEY_PREFIX_SEARCH+C+A.KEY_SUFFIX_SEARCH]||null;break;case A.KEY_MODE_CATEGORY:_=this._mCache[A.getCategoryCacheKeyByIdentifier(C)]||null;break;case A.KEY_MODE_NORMAL:_=this._mCache[C]||null;break;default:break;}return _;}).method("setCacheByMode",function(B,C,_){this.removeAll();switch(B){case A.KEY_MODE_SEARCH:this._mCache[A.KEY_PREFIX_SEARCH+C+A.KEY_SUFFIX_SEARCH]=_;break;case A.KEY_MODE_CATEGORY:this._mCache[A.getCategoryCacheKeyByIdentifier(C)]=_;break;case A.KEY_MODE_NORMAL:this._mCache[C]=_;break;default:break;}}).method("deleteByMode",function(C,D,E){if(!A.isKeyQulifier(D)){throw new Error("identifier should "+"be a legal key(for search, category, or directory");}if(!(E instanceof Array)){E=[E];}var B=this.obtainByMode(C,D),_=C==A.KEY_MODE_CATEGORY;if(B){if(this._putAsideVictims(B,E,_)){if(_==true){this.removeAll();this._mCache[A.getCategoryCacheKeyByIdentifier(D)]=B;}else{this.removeCategorys();this._mDirty=true;}return true;}}return false;}).method("renameByMode",function(D,F,E,C,B){if(!A.isKeyQulifier(F)){throw new Error("identifier should "+"be a legal key(for search, category, or directory");}var _=this.obtainByMode(D,F);if(_){if(this._renameVictim(_,E,C,B)&&D==A.KEY_MODE_NORMAL){this.removeCategorys();this._mDirty=true;return true;}}return false;}).method("movecopyByMode",function(C,D,E,F){if(!A.isKeyQulifier(D)){throw new Error("identifier should "+"be a legal key(for search, category, or directory");}var B=this.obtainByMode(C,D),_=C==A.KEY_MODE_CATETORY;if(B){if(E==disk.ui.MoveCopyDialog.COPY||(E==disk.ui.MoveCopyDialog.MOVE&&this._putAsideVictims(B,F,_))){this.setCacheByMode(C,D,B);return true;}}return false;}).method("insert",function(A,B){var _=this._mCache[A]||null;if(disk.DEBUG){console.assert(_!=null);}if(_){_.unshift(B);if(!B.isdir){var D=this._typeTable,C=this._mCache['\u5206\u7c7b:"'+FileUtils.TYPES[FileUtils.TYPESNAMEHASH[B.category]-1][1]+'"'];C&&C.unshift(B);if(D){var E=D[B.category];E.count++;E.size+=B.size;}}}this._mDirty=true;}).method("preseveAndDescendentlyRemove",function(_,F){var A=this._mCache[_]||null;if(A!=null){for(var G=0,B=A.length;G<B;G++){if(F==FileUtils.parseDirPath(A[G].path)){var L=A[G],I=this._typeTable;if(I&&!L.isdir){var C=this._mCache['\u5206\u7c7b:"'+FileUtils.TYPES[FileUtils.TYPESNAMEHASH[A[G].category]-1][1]+'"'],J=I[L.category];J.count--;J.size-=L.size;}if(_.toString().substring(0,1)!="\u5206"&&!L.isdir){if(C){for(var H in C){if(C.hasOwnProperty(H)){var D=C[H].path;if(D.slice(D.indexOf("/"))==F){C.splice(H,1);break;}}}}}if(_.toString().substring(0,1)=="\u5206"){var K=L.path,E=K.slice(K.indexOf("/"));this.query(E,undefined,function(A,_){_.splice(A,1);});}A.splice(G,1);this._removeDescendent(F,false);break;}}}this._mDirty=true;}).method("query",function(I,_,H){if(I[I.length-1]=="/"||I=="0"||I==""){var G=I.slice(0,-1)||"0",C=this._mCache[G];C&&H&&H();return C;}else{var F=I.slice(I.lastIndexOf("/")+1),E=I.substring(0,1)=="/"?this._mCache[I.slice(0,I.lastIndexOf("/"))||"0"]:this._mCache[I.slice(0,I.indexOf("/"))];if(!E){return undefined;}for(var A=0,B=E.length;A<B;A++){var D=E[A].path;if(D.slice(D.lastIndexOf("/")+1)==F){C=E[A];H&&H(A,E);return C;}}return undefined;}}).method("quoteAdd",function(_,H){var B=[];for(var A=0,D=H.length;A<D;A++){var G=H[A].path,E=G.slice(G.indexOf(":/")+1),C=this.query(E);if(!C){var F=G.slice(G.indexOf(":/")+1,G.lastIndexOf("/"));this._mCache[F]=(this._mCache[F]||[]);this._pathByType=(this._pathByType||{});C=H[A];this._mCache[F].push(H[A]);this._pathByType[F]=_;}B.push(C);}this.add(_,B);return this;}).method("removeCategorys",function(){var A=FileUtils.TYPES;for(var _=0;_<6;_++){var B='\u5206\u7c7b:"'+A[_][1]+'"';this._mCache[B]=null;delete this._mCache[B];}this._typeTable=null;this._pathByType={};}).method("contains",function(_){if(this._TimeStamp&&this._TimeStamp[_]&&(new Date().getTime()-this._TimeStamp[_])>(Utilities._mInterval||3600000)){this._mCache[_]=null;delete this._mCache[_];}return typeof this._mCache[_]!="undefined";}).method("obtain",function(_){if(this._TimeStamp&&this._TimeStamp[_]&&(new Date().getTime()-this._TimeStamp[_])>(Utilities._mInterval||3600000)){this._mCache[_]=null;delete this._mCache[_];}return this._mCache[_||"0"]||null;});disk.util.FileCache=A;})();(function(){var _=function(_,A){this._timer=null;this._interval=_;this._actionListener=A;this._isAlive=false;this._startTime=0;};_.prototype={isAlive:function(){return this._isAlive;},interrupt:function(){if(this._timer){clearTimeout(this._timer);}this._timer=null;this._isAlive=false;this._startTime=0;},setActionListener:function(_){if(typeof _=="function"){this._actionListener=_;}},getActionListener:function(){return this._actionListener;},start:function(){var _=this;this._timer=setTimeout(function(){_.interrupt();_._actionListener.call(_);},this._interval);this._startTime=(new Date()).getTime();this._isAlive=true;},getElapsed:function(){return(new Date()).getTime()-this._startTime;},setInterval:function(_){if(typeof _=="number"){this._interval=_;}},getInterval:function(){return this._interval;}};disk.util.TimerService=_;})();(function(){var _=function(){};$(document).ajaxSend(function(D,A,C){if("script"===C.dataType){return;}var B=C.url||"";if(/\?/.test(B)){if(B.indexOf(_.VENDOR_INFO)==-1){B=B+"&"+_.VENDOR_INFO+"&logid="+_.getLogId();}}else{B=B+"?"+_.VENDOR_INFO+"&logid="+_.getLogId();}if(location.pathname==="/reader/link"){B=B.replace(/[\&]clienttype=[^&]*/g,"");B+="&clienttype=8&version=4.9.9.9";}if((!/bdstoken\=[^\&]+/.test(B))&&typeof FileUtils!=="undefined"&&typeof FileUtils.bdstoken!=="undefined"){B=B+"&bdstoken="+FileUtils.bdstoken;}C.url=B;});_.normalize=function(A,D){if(typeof A!="string"||A.length==0){return A;}if(D==null||typeof D!="string"){return A;}var C=A.indexOf("?")!=-1,E=A.substring(A.length-1),_="bdstoken="+D,B;if(E=="&"||E=="?"){B=A+_;}else{if(C){B=A+"&"+_;}else{B=A+"?"+_;}}return B;};_.getLogId=function(){var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/~\uff01@#\uffe5%\u2026\u2026&",F=String.fromCharCode,D=function(A){if(A.length<2){var _=A.charCodeAt(0);return _<128?A:_<2048?(F(192|(_>>>6))+F(128|(_&63))):(F(224|((_>>>12)&15))+F(128|((_>>>6)&63))+F(128|(_&63)));}else{_=65536+(A.charCodeAt(0)-55296)*1024+(A.charCodeAt(1)-56320);return(F(240|((_>>>18)&7))+F(128|((_>>>12)&63))+F(128|((_>>>6)&63))+F(128|(_&63)));}},H=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,A=function(_){return(_+""+Math.random()).replace(H,D);},E=function(B){var D=[0,2,1][B.length%3],A=B.charCodeAt(0)<<16|((B.length>1?B.charCodeAt(1):0)<<8)|((B.length>2?B.charCodeAt(2):0)),_=[C.charAt(A>>>18),C.charAt((A>>>12)&63),D>=2?"=":C.charAt((A>>>6)&63),D>=1?"=":C.charAt(A&63)];return _.join("");},B=function(_){return _.replace(/[\s\S]{1,3}/g,E);},I=function(_){return B(A(new Date().getTime()));},G=function(A,_){return!_?I(String(A)):I(String(A)).replace(/[+\/]/g,function(_){return _==="+"?"-":"_";}).replace(/=/g,"");},_=function(){var _,A=new RegExp("(^| )"+name+"=([^;]*)(;|$)");if(_=document.cookie.match(A)){return unescape(_[2]);}else{return null;}};return G(_("BAIDUID"));};_.VENDOR_INFO="channel=chunlei&clienttype=0&web=1";_.PCSHOST="";_.MIS_EXAMINING=false;_.YUN="//yun.baidu.com";_.PAN="//pan.baidu.com";_.CREATE="/api/create?a=commit&"+_.VENDOR_INFO;_.LIST="/api/list?"+_.VENDOR_INFO;_.MIS_COUNTER="/mis/dtcount";_.LIST_SHARE_HOME="/share/homerecord?"+_.VENDOR_INFO;_.LIST_CATEGORY="/api/categorylist?"+_.VENDOR_INFO;_.INFO_CATEGORY="/api/categoryinfo?"+_.VENDOR_INFO;_.AUTO_EXPAND="/api/autoexpandquota?"+_.VENDOR_INFO;_.QUOTA="/api/quota?"+_.VENDOR_INFO;_.FILE_MANAGER="/api/filemanager?"+_.VENDOR_INFO;_.SEARCH="/api/search?"+_.VENDOR_INFO;_.OPERARECORD="/api/operarecord?"+_.VENDOR_INFO;_.INVITE_GET_NUM="/api/invite/getnum?"+_.VENDOR_INFO;_.ACTIVATE="/api/invite/activate?"+_.VENDOR_INFO;_.INVITE_CHECK_CODE="/api/invite/checkinvitecode?"+_.VENDOR_INFO;_.CMS_DATA_SIMPLE="/disk/cmsdata";_.CMS_DATA=_.CMS_DATA_SIMPLE+"?"+_.VENDOR_INFO;_.ANALYTICS="/api/analytics";_.UFO_ANALYTICS="http://ufo.baidu.com/listen/api/addfeedback";_.LIST_RECYCLE="/api/recycle/list?"+_.VENDOR_INFO;_.DELETE_RECYCLE="/api/recycle/delete?"+_.VENDOR_INFO;_.RESTORE_RECYCLE="/api/recycle/restore?"+_.VENDOR_INFO;_.CLEAR_RECYCLE="/api/recycle/clear?"+_.VENDOR_INFO;_.UPDATE_WEB_VERSION="/api/version/updatewebversion?"+_.VENDOR_INFO;_.UPLOAD="https://c.pcs.baidu.com/rest/2.0/pcs/file?method=upload&type=tmpfile&app_id=250528&channel=chunlei&clienttype=0";_.RATIFY_HTML5_UPLOAD=true;_.UPLOAD_ROUTE="https://c.pcs.baidu.com/rest/2.0/pcs/file?method=upload&channel=chunlei&clienttype=0&app_id=250528&ondup=newcopy&dir=%s&filename=%s";_.MULTI_DOWNLOAD="https://pcs.baidu.com/rest/2.0/pcs/file?method=batchdownload&app_id=250528";_.SINGLE_DOWNLOAD="https://pcs.baidu.com/rest/2.0/pcs/file?method=download&app_id=250528";_.DOWNLOAD_QUERYIP="/rest/2.0/membership/isp?method=query";_.THUMBNAIL_GENERATE=location.protocol+"//pcsdata.baidu.com/rest/2.0/pcs/thumbnail?method=generate&app_id=250528";_.DOCPREVIEW=location.protocol+"//pcsdata.baidu.com/rest/2.0/pcs/doc?app_id=250528";_.ACTIVEX_NOTIFICATION=true;_.ACTIVEX_USE_UPGRADE_STRATEGY=true;_.ACTIVEX_UPGRADE=_.CMS_DATA_SIMPLE+"?do=plugin&"+_.VENDOR_INFO;_.ACTIVEX_SERVER_HOST="c.pcs.baidu.com";_.ACTIVEX_ORIGIN_HOST="pan.baidu.com";_.UNZIP="https://pcs.baidu.com/rest/2.0/pcs/file";_.PAN_URL="//pan.baidu.com/disk/home";_.CLOUD_DL="/rest/2.0/services/cloud_dl?";_.TRANSFER="/share/transfer?"+_.VENDOR_INFO;_.SHARE_COUNTER="/share/autoincre?"+_.VENDOR_INFO;_.LINK_COUNT="/share/totalcnt?"+_.VENDOR_INFO;_.LIST_SHARE="/share/list?"+_.VENDOR_INFO;_.RECORD_SHARE="/share/record?"+_.VENDOR_INFO;_.CANCEL_SHARE="/share/cancel?"+_.VENDOR_INFO;_.SINGLE_PUBLIC_URI="/share/singlepublicuri?"+_.VENDOR_INFO;_.MSGCNT_SHARE="/share/msgcnt?"+_.VENDOR_INFO;_.SET_SHARE="/share/set?"+_.VENDOR_INFO;_.PRISET_SHARE="/share/priset?"+_.VENDOR_INFO;_.VERIFY_SHARE="/share/verify";_.HOTREC_SHARE="/share/hotrec";_.DOCREC_SHARE="/share/docrec";_.PRODUCT_SHARE="/pmall/product/hotproductlist";_.GET_UINFO="/pcloud/user/getinfo";_.SET_UINFO="/pcloud/user/editinfo";_.LIKE_GET="/pcloud/like/data";_.LIKE_CREATE="/pcloud/like/create";_.LIKE_CANCEL="/pcloud/like/cancel";_.VERIFY_CAPTCHAPI="/share/captchaip";_.VERIFY_VCODE="/share/vcode";_.SHARE_GET_DLINK="/share/download?"+_.VENDOR_INFO;_.HOME_HOT_LINKS="/share/homehotlinks";_.MULTI_DOWNLOAD_PUBLIC="/share/batchdownload?"+_.VENDOR_INFO;_.USER_REPORT="/api/report/user?"+_.VENDOR_INFO;_.USER_INFO="/api/account/uinfo?"+_.VENDOR_INFO;_.PCLOUD_ADDFOLLOW="/pcloud/friend/addfollow?"+_.VENDOR_INFO;_.PCLOUD_DEFOLLOW="/pcloud/friend/removefollow?"+_.VENDOR_INFO;_.TASK_CREATE="/api/task/create";_.TASK_QUERY="/api/task/query";_.PCS_FILE=location.protocol+"//pcs.baidu.com/rest/2.0/pcs/file";_.SHARE_STREAM_FILE="/share/streaming";_.INBOX_STREAM_AUTH="/inbox/object/streamauth";_.INBOX_STREAM="/inbox/object/streaming";_.SHARE_STREAM_FILE_CHECK="/share/streamauthcheck";_.REVISION_LIST="/api/revision/list";_.REVISION_REVERT="/api/revision/revert";_.VIP_QUOTA="/rest/2.0/membership/quota";_.VIP_PROPERTY="/rest/2.0/membership/property";_.VIP_USER="/rest/2.0/membership/user";_.INBOX_FRIEND_GETFOLLOW="/inbox/friend/getfollowlist";_.INBOX_FRIEND_GETFANS="/inbox/friend/getfanslist";_.INBOX_FRIEND_FRIENDCOUNT="/inbox/friend/friendcount";_.INBOX_FRIEND_GETFRIENDLIST="/inbox/friend/getfriendlist";_.INBOX_FRIEND_RECENTFRIEND="/inbox/friend/recentfriend";_.INBOX_FRIEND_QUERYFRIEND="/inbox/friend/queryfriend";_.INBOX_FRIEND_QUERYUSER="/inbox/friend/queryuser";_.INBOX_OBJECT_CREATE="/inbox/object/create";_.INBOX_OBJECT_CHECKANTISPAM="/inbox/object/checkantispam";_.DOWN_GET_DLINK="/api/download";_.VIDEO_SRT_LIST="/api/resource/subtitle";disk.api.RestAPI=_;disk.api.RestAPI.GET_CAPTCHA="/api/getcaptcha";disk.api.RestAPI.CONSUME="/rest/2.0/membership/exchangecode/consume?method=consume";disk.api.RestAPI.EXCHANGE_QUERY="/rest/2.0/membership/exchangecode/query?method=query";})();var globalNativeUploadHandler=null;(function(){var A=function(_,A){this._mTrigger=_;this._mUrl=A;this._mFileQueue=[];this._mFileQueueMap={};this._mPrivateFlags=0;this._mFileSpeedStates={};this._mAutoUploadIndex=-1;this._mLastResumeIndex=-1;};A.PENDING=0;A.UPLOADING=1;A.PAUSE=2;A.COMPLETE=3;A.INCOMPLETE=4;A.ABORT=5;A.ERROR=6;A.KEY_ID="id";A.KEY_STATUS="status";A.KEY_SUBSTATUS="substatus";A.KEY_SIZE="size";A.KEY_NAME="name";A.KEY_TYPE="type";A.KEY_SPEED="speed";A.KEY_CURRENT_SPEED="currentSpeed";A.KEY_AVERAGE_SPEED="averageSpeed";A.KEY_MOVING_AVERAGE_SPEED="movingAverageSpeed";A.KEY_TIME_REMAINING="timeRemaining";A.KEY_TIME_ELAPSED="timeElapsed";A.PERCENT_UPLOADED="percentUploaded";A.KEY_SIZE_UPLOADED="bytesUploaded";A.KEY_SERVER_MAPPED_PATH="server_mapped_path";A.KEY_SERVER_MAPPED_SIMPLE_PATH="server_mapped_sam_path";A.MAX_TRACKING_HISTORY=10;A.uid=0;A.obtainId=function(){return"bd_uploader_entitiy_key_"+(A.uid++);};A.DEFAULT_VERSION="0.0.0.0";A.errorMap={"1":"\u670d\u52a1\u5668\u9519\u8bef","2":"\u670d\u52a1\u5668\u9519\u8bef","-3":"\u5e10\u53f7\u672a\u6fc0\u6d3b","-4":"\u670d\u52a1\u5668\u9519\u8bef","-5":"\u670d\u52a1\u5668\u9519\u8bef","-6":"\u670d\u52a1\u5668\u9519\u8bef","-8":"\u6587\u4ef6\u5df2\u5b58\u5728","-10":"\u5269\u4f59\u7a7a\u95f4\u4e0d\u8db3","-11":"\u76ee\u5f55\u4e0d\u5b58\u5728","-25":"\u5e10\u53f7\u672a\u6fc0\u6d3b","-120":"\u6587\u4ef6\u5927\u5c0f\u4e3a\u7a7a","-999":"\u5269\u4f59\u7a7a\u95f4\u4e0d\u8db3","-1015":"\u8d85\u8fc75000\u4e2a\u9650\u5236","-1000":"\u6587\u4ef6\u8bfb\u53d6\u5931\u8d25","-1002":"\u6587\u4ef6\u4e0d\u5b58\u5728","-1003":"\u6587\u4ef6\u4e0d\u5408\u6cd5","-1005":"\u8d85\u8fc74G\u9650\u5236"};A.versionCompare=function(B,E){if(disk.DEBUG){console.log("compare version ",B," : ",E);}var H=B.split("."),A=E.split("."),G=H.length,F=A.length;if(G!=F){return 0;}var I=0,D=0;for(var C=0,_=G;C<_;C++){I=parseInt(H[C]);D=parseInt(A[C]);if(I!=D){return I-D;}}return 0;};A.isHTML5Compatible=function(){return(typeof FormData!="undefined");};A.isDnDCompatible=function(){return disk.ui.FileUploader.isHTML5Compatible()&&!("ontouchstart"in document);};A.NOT_IDLE=1;A.AUTO_UPLOAD_NEXT=2;A.NOT_TRACKING_SPEED=4;A.IN_SESSION_UPLOADING=8;A.RESTORE_FILES=16;A.getFileExtension=function(A,_){var B=A.lastIndexOf(".");if(B==-1){return A;}return A.substring(_===true?B:B+1);};A.formatUnits=function(D,F,B,I){var A,E,C,_;if(D===0){return"0 "+B[B.length-1];}if(I){E=D;_=B.length>=F.length?B[F.length-1]:"";for(A=0;A<F.length;A++){if(D>=F[A]){E=(D/F[A]).toFixed(2);_=B.length>=A?" "+B[A]:"";break;}}return E+_;}else{var G=[],H=D;for(A=0;A<F.length;A++){C=F[A];_=B.length>A?" "+B[A]:"";E=H/C;if(A<F.length-1){E=Math.floor(E);}else{E=E.toFixed(2);}if(E>0){H=H%C;G.push(E+_);}}return G.join(" ");}};A.formatBPS=function(_){var B=[1073741824,1048576,1024,1],C=["Gbps","Mbps","Kbps","bps"];return A.formatUnits(_,B,C,true);};A.formatTime=function(B){var C=[86400,3600,60,1],_=["d","h","m","s"];return A.formatUnits(B,C,_,false);};A.formatBytes=function(B){var _=[1073741824,1048576,1024,1],C=["GB","MB","KB","bytes"];return A.formatUnits(B,_,C,true);};A.formatPercent=function(_){return _.toFixed(2)+" %";};A.formatBytePerSeconds=function(_){var B=[1073741824,1048576,1024,1],C=["GB/s","MB/s","KB/s","B/s"];return A.formatUnits(_/8,B,C,true);};A.calculateMovingAverage=function(H){var D=[],I,_=0,B=0,E=0,G=0,J=0,A,C=0,F=0;I=H.length;if(I>=8){for(A=0;A<I;A++){D[A]=H[A];_+=D[A];}B=_/I;for(A=0;A<I;A++){E+=Math.pow((D[A]-B),2);}G=E/I;J=Math.sqrt(G);for(A=0;A<I;A++){D[A]=(D[A]-B)/J;}var K=2;for(A=0;A<I;A++){if(D[A]<=K&&D[A]>=-K){F++;C+=H[A];}}}else{F=I;for(A=0;A<I;A++){C+=H[A];}}return C/F;};A.toFriendlyTiming=function(B,H){var J=parseFloat(B),F=B.toLowerCase();if(F.indexOf("gb")!=-1){J=J*1024*1024*1024;}else{if(F.indexOf("mb")!=-1){J=J*1024*1024;}else{if(F.indexOf("kb")!=-1){J=J*1024;}}}var E=H/J,D=60,A=D*60,C=A*24,I=C*31,_=1,G=null;if(E>=I){G="\u672a\u77e5";}else{if(E>=C){G=(E/C).toFixed(0)+"\u5929";}else{if(E>=A){G=((E/A).toFixed(0)+"\u5c0f\u65f6")+(E%A).toFixed(0)+"\u5206";}else{if(E>=D){G=((E/D).toFixed(0)+"\u5206")+((E%D).toFixed(0)+"\u79d2");}else{if(E>=1){G=E.toFixed(0)+"\u79d2";}else{G="\u5c0f\u4e8e1\u79d2";}}}}}return[E,G];};A.TYPE_ACTIVEX_CONTROL=0;A.TYPE_HTML5_CONTROL=1;A.TYPE_FLASH_CONTROL=2;A.getInstance=function(_,I,G){if(!disk.ui.NativePluginFileUploader.isPlatformCompatible()){if(disk.DEBUG){console.log("Platform Not Compatible With Large File Uploading Control");}}var A=null,D=null,H=false,E=disk.api.RestAPI.ACTIVEX_NOTIFICATION,B=null,J=false;if(disk.ui.NativePluginFileUploader.hasPlugin()&&(!disk.ui.NativePluginFileUploader.isRemoteEnforceUpgrade())){disk.ui.NativePluginFileUploader.preinstall();B=disk.ui.NativePluginFileUploader.getPluginHook();if(B!=null){J=typeof window.attachEvent!="undefined"?B.attachEvent:B.AddEvent;}}var K=disk.ui.FileUploader.isHTML5Compatible(),G=G||{};if(G.suggestOptionQuery!==true){if(K){K=false;}}if(typeof J==="function"||typeof J==="object"){A=disk.ui.NativePluginFileUploader.getInstance(_,I);D="ActiveXControl";H=true;}else{if(disk.api.RestAPI.RATIFY_HTML5_UPLOAD&&K){D="HTML5Control";var F=disk.obtainId(),C=document.createElement("form");C.className="html5-uploader-ctrl";C.action="javascript:;";C.method="post";C.innerHTML='<input multiple accept="*/*" id="'+F+'" type="file" name="html5uploader" class="html5-uploader-ctrl-fld" />';$(_).addClass("b-rlv").append(C);_=$("#"+F).get(0);A=new disk.ui.HTML5FileUploader(_,I);}else{A=new disk.ui.OpenSourceFlashFileUploader(_,I);D="FlashControl";}}if(disk.DEBUG){console.log("create an uploader: "+D+", user platform: "+navigator.platform);}if(FileUtils&&FileUtils._mDiskLog){FileUtils._mDiskLog.send({type:D,os:navigator.platform,activeX:H});}return A;};A.prototype={onFileAccepted:function(_){},getWaitingFileCount:function(){var _=this._mFileQueue.length-this._mAutoUploadIndex-1;return Math.max(0,_);},dispatchFileAccepted:function(_,B,A){_=this.onExtendFileSpeedProperty(_);if(this.addFile(_)){this.onFileAccepted(_,B,A);}},dispatchDisableEvent:function(A,_,B){this.onFileDisable(A,_,B);},onFileDisable:function(A,_,B){},resetFileStatus:function(B,D){D=Math.min(D,this._mFileQueue.length);D=Math.max(0,D);B=Math.max(0,B);B=Math.min(B,this._mFileQueue.length-1);var C=null,E=null;for(var _=B;_<D;_++){C=this._mFileQueue[_];E=C[A.KEY_STATUS];if(E==A.ABORT||E==A.ERROR){this.onSetFileStatus(C,A.PENDING);}}this._mAutoUploadIndex=Math.max(-1,B-1);},resetFileStatusAll:function(){this.resetFileStatus(0,this._mFileQueue.length);},setURL:function(_){this._mUrl=_;},isIdle:function(){return(this._mPrivateFlags&A.NOT_IDLE)!=A.NOT_IDLE;},setAutoUploadEnabled:function(B){var _=A.AUTO_UPLOAD_NEXT;if(B){this._mPrivateFlags|=_;}else{this._mPrivateFlags&=~_;}},isAutoUploadEnabled:function(){return(this._mPrivateFlags&A.AUTO_UPLOAD_NEXT)==A.AUTO_UPLOAD_NEXT;},onSetFileStatus:function(_,B){switch(B){case A.PENDING:case A.COMPLETE:case A.INCOMPLETE:case A.ABORT:case A.ERROR:case A.UPLOADING:case A.PAUSE:_[A.KEY_STATUS]=B;break;default:break;}},getFileStatus:function(_){if(!_){return null;}return _[A.KEY_STATUS];},onSetFileSubstatus:function(_,B){_[A.KEY_SUBSTATUS]=B;},getFileSubstatus:function(_){var B=_[A.KEY_SUBSTATUS];return typeof B=="undefined"?null:B;},getFileById:function(D){var B=null,E=D[A.KEY_ID];for(var C=0,_=this._mFileQueue.length;C<_;C++){B=this._mFileQueue[C];if(B[A.KEY_ID]==E){return B;}}return null;},onAccepting:function(_){},dispatchFileAbrupted:function(E,_,C){E=this._mFileQueue[_];E=this.onExtendFileSpeedProperty(E);this.onDropFileSpeedTracking(E,this._mFileSpeedStates);if(typeof E!="undefined"){switch(C){case A.INCOMPLETE:case A.ABORT:case A.ERROR:E[A.KEY_STATUS]=C;break;default:E[A.KEY_STATUS]=A.ERROR;}this.onFileAbrupted(E,_,C);var F=A.IN_SESSION_UPLOADING,B=A.NOT_IDLE,D=(this._mPrivateFlags&B)!=B;if((this._mPrivateFlags&F)==F){if(!D&&_>this._mAutoUploadIndex){return;}if(this._mAutoUploadIndex<this._mFileQueue.length){this._mPrivateFlags&=~B;this.autoUpload();return;}}this._mPrivateFlags&=~B;}},onExtendFileSpeedProperty:function(C,_){var D=A.NOT_TRACKING_SPEED,G=(this._mPrivateFlags&D)!=D;if(!G){return C;}var B=this.onGetTrackingKey(C),F=C[B],E=_?_[F]:null;if(typeof E=="undefined"||E==null){C[A.KEY_CURRENT_SPEED]=0;C[A.KEY_AVERAGE_SPEED]=0;C[A.KEY_MOVING_AVERAGE_SPEED]=0;C[A.KEY_TIME_ELAPSED]=0;C[A.KEY_TIME_REMAINING]=0;C[A.PERCENT_UPLOADED]=0;C[A.KEY_SIZE_UPLOADED]=0;}else{C[A.KEY_CURRENT_SPEED]=E[A.KEY_CURRENT_SPEED];C[A.KEY_AVERAGE_SPEED]=E[A.KEY_AVERAGE_SPEED];C[A.KEY_MOVING_AVERAGE_SPEED]=E[A.KEY_MOVING_AVERAGE_SPEED];C[A.KEY_TIME_ELAPSED]=E[A.KEY_TIME_ELAPSED];C[A.KEY_TIME_REMAINING]=E[A.KEY_TIME_REMAINING];C[A.PERCENT_UPLOADED]=E[A.PERCENT_UPLOADED];C[A.KEY_SIZE_UPLOADED]=E[A.KEY_SIZE_UPLOADED];}return C;},onGetTrackingKey:function(_){if(typeof _[A.KEY_ID]!="undefined"){return A.KEY_ID;}return A.KEY_NAME;},onFileAbrupted:function(B,_,A){},dispatchChoosingFiles:function(_){this.onChoosingFiles(_);},onChoosingFiles:function(_){},dispatchCancelUpload:function(B,_,C){this.onCancelUpload(B,_,C);this.dispatchFileAbrupted(B,_,A.ABORT);},onCancelUpload:function(A,_,B){},dispatchFileRemoved:function(A,_){A=this.onExtendFileSpeedProperty(A);this.onDropFileSpeedTracking(A,this._mFileSpeedStates);if(_<=this._mAutoUploadIndex){this._mAutoUploadIndex--;}this.onCancelUpload(A,_,false);delete this._mFileQueueMap[A.name];this._mFileQueue.splice(_,1);this.onFileRemoved(A,_);},onFileRemoved:function(A,_){},upload:function(_){var C=this._mFileQueue[_],B=(this._mPrivateFlags&A.NOT_IDLE)!=A.NOT_IDLE;if(disk.DEBUG){console.log("upload file at ",_," and status is ",C[A.KEY_STATUS]);}if(B){if(typeof C!="undefined"){var D=C[A.KEY_STATUS];if(D==A.PENDING){this.onSetFileStatus(C,A.UPLOADING);this._mAutoUploadIndex=_;if(disk.DEBUG){console.warn("[SIGNAL]Start Upload "+_);}this.onUploadFile(C,_);return true;}else{if(D==A.UPLOADING){return true;}}}}else{if(disk.DEBUG){console.error("[WARNING]You issue another uploading progress before Uploader taking a break, do you forget something?");}return true;}return false;},dispatchRemoveAllFile:function(){var B=null;for(var _=this._mFileQueue.length-1;_>=0;_--){B=this._mFileQueue[_][A.KEY_STATUS];if(B==A.UPLOADING||B==A.PENDING){this.onCancelUpload(this._mFileQueue[_],_,false);}if(B==A.COMPLETE){break;}}this._mPrivateFlags&=~A.NOT_IDLE;this._mPrivateFlags&=~A.IN_SESSION_UPLOADING;this._mAutoUploadIndex=-1;this._mLastResumeIndex=-1;this._mFileQueue.length=0;this._mFileQueueMap={};this.onFileRemoved(null,-1);},dispatchSessionProgressComplete:function(_){this.onSessionProgressComplete(_);},onSessionProgressComplete:function(_){},inSessionProgress:function(){return(this._mPrivateFlags&A.IN_SESSION_UPLOADING)==A.IN_SESSION_UPLOADING;},autoUpload:function(){var B=A.AUTO_UPLOAD_NEXT;if((this._mPrivateFlags&B)!=B){return;}this._mPrivateFlags|=A.IN_SESSION_UPLOADING;var _=this._mAutoUploadIndex+1;if(_>this._mFileQueue.length-1){this.dispatchSessionProgressComplete(this._mFileQueue.length);this._mPrivateFlags&=~A.IN_SESSION_UPLOADING;return;}if(disk.DEBUG){console.log("[LOG]Before starting to upload ",this._mAutoUploadIndex);}if(!this.upload(_)){this._mAutoUploadIndex=_;this.autoUpload();}},onUploadFile:function(A,_){},onFileProgress:function(C,_,E,D,B,A){},dispatchFileProgress:function(D,_,F,E,C){this.onUpdateFileSpeedTracking(D,E);this.onExtendFileSpeedProperty(D,this._mFileSpeedStates);this.onSetFileStatus(D,A.UPLOADING);var B=A.formatBytePerSeconds(D[A.KEY_AVERAGE_SPEED]);this.onFileProgress(D,_,F,E,C,B);},onFileComplete:function(A,_){},dispatchFileComplete:function(B,_){this.onExtendFileSpeedProperty(B,this._mFileSpeedStates);this.onDropFileSpeedTracking(B,this._mFileSpeedStates);this.onSetFileStatus(B,A.COMPLETE);this.onFileComplete(B,_);},onUpdateFileSpeedTracking:function(I,H){var D=this.onGetTrackingKey(I),F=I[D],J=this._mFileSpeedStates[F];if(!J){this._mFileSpeedStates[F]=J={};}H=H||J.bytesUploaded||0;if(H<0){H=0;}if(H>I[A.KEY_SIZE]){H=I[A.KEY_SIZE];}var C=(new Date()).getTime();if(!J.startTime){J.startTime=(new Date()).getTime();J.lastTime=J.startTime;J[A.KEY_CURRENT_SPEED]=0;J[A.KEY_AVERAGE_SPEED]=0;J[A.KEY_MOVING_AVERAGE_SPEED]=0;J.movingAverageHistory=[];J[A.KEY_TIME_REMAINING]=0;J[A.KEY_TIME_ELAPSED]=0;J[A.PERCENT_UPLOADED]=H/I[A.KEY_SIZE];J.bytesUploaded=H;}else{if(J.startTime>C){}else{var _=(new Date()).getTime(),G=J.lastTime,E=_-G,B=H-J.bytesUploaded;if(B===0||E===0){return J;}J.lastTime=_;J.bytesUploaded=H;J[A.KEY_CURRENT_SPEED]=(B*8)/(E/1000);J[A.KEY_AVERAGE_SPEED]=(J.bytesUploaded*8)/((_-J.startTime)/1000);J.movingAverageHistory.push(J[A.KEY_CURRENT_SPEED]);if(J.movingAverageHistory.length>A.MAX_TRACKING_HISTORY){J.movingAverageHistory.shift();}J[A.KEY_MOVING_AVERAGE_SPEED]=A.calculateMovingAverage(J.movingAverageHistory);J[A.KEY_TIME_REMAINING]=(I[A.KEY_SIZE]-J.bytesUploaded)*8/J[A.KEY_MOVING_AVERAGE_SPEED];J[A.KEY_TIME_ELAPSED]=(_-J.startTime)/1000;J[A.PERCENT_UPLOADED]=(J.bytesUploaded/I[A.KEY_SIZE]*100);}}return J;},onDropFileSpeedTracking:function(B,_){var A=this.onGetTrackingKey(B),C=B[A];if(typeof C!="undefined"){_[C]=null;delete _[C];}},onFileMD5Computed:function(_){},dispatchAcceptingEvent:function(){this.onAccepting(this._mTrigger);},dispatchUpdateStatus:function(_,A){this.onUpdateStatus(_,A);},onUpdateStatus:function(_,A){},dispatchRejectingEvent:function(_){this.onRejecting(_);},dispatchProgressPauseEvent:function(B,C,D,_){this.onSetFileStatus(B,A.PAUSE);this.onProgressPause(B,C,D,_);},onProgressPause:function(A,B,C,_){},dispatchProgressResumeEvent:function(_,B,C,D){this._mLastResumeIndex=this._mLastResumeIndex==-1?B:Math.min(this._mLastResumeIndex,B);this.onSetFileStatus(_,A.UPLOADING);this.onResume(_,B,C,D);},onProgressResume:function(_,A,B,C){},onRejecting:function(_){},onChooseFile:function(){},getFileQueue:function(){return this._mFileQueue;},onFilterFile:function(_){return true;},addFile:function(_){if(this.onFilterFile(_)){if(typeof _[A.KEY_ID]=="undefined"){_[A.KEY_ID]=A.obtainId();}if(typeof _[A.KEY_STATUS]=="undefined"){_[A.KEY_STATUS]=A.PENDING;}this._mFileQueue.push(_);this._mFileQueueMap[_[A.KEY_NAME]]=this._mFileQueue.length-1;if(disk.DEBUG){console.log("[LOG]pend file",_);}return true;}return false;}};disk.ui.FileUploader=A;var B=function(_,A){disk.ui.FileUploader.call(this,_,A);this._mSurroundingView=null;this._mUploadKernal=null;this._mCurrentIndex=-1;this._mDisrruptFromAbort=false;this._dispatchPrebuild();};B.ONE_GIGABYTE=1*1024*1024*1024;B.QUEUE_LIMIT_PER_SELECTION=200;B.prototype=new disk.ui.FileUploader();B.prototype._dispatchPrebuild=function(){if(this._mTrigger.nodeName!="INPUT"){throw new Error("html5 uploader expecting input file element");}var _=this;this._mTrigger.onchange=function(A){A.preventDefault();_.dispatchMultiFilesAccepted(this.files);if(this.form){this.form.reset();}};this.onAccepting(this._mTrigger);};B.prototype.onDragAcrossBoundary=function(A,_){};B.prototype.onCompileUrl=function(A,_){return A;};B.prototype.onDrop=function(_){};B.prototype.onUploadFile=function(D,_){var E=(this._mPrivateFlags&A.NOT_IDLE)!=A.NOT_IDLE,F=this;this._mCurrentIndex=_;if(E){this._mPrivateFlags|=A.NOT_IDLE;var B=new XMLHttpRequest(),C=D;if(typeof FormData!="undefined"){C=new FormData();C.append("file",D);}B.upload.onabort=function(){if(disk.DEBUG){console.warn("file was cancelled by user maully");}};B.onreadystatechange=function(){if(B.readyState==4){F._mPrivateFlags&=~A.NOT_IDLE;if(B.status==200){F.dispatchFileComplete(D,B.responseText);if(disk.DEBUG){console.log("[LOG]Upload Complete: ",B.responseText);}}else{if(F._mDisrruptFromAbort){F._mDisrruptFromAbort=false;}else{F.dispatchFileAbrupted(D,F._mCurrentIndex,A.ERROR);if(disk.DEBUG){console.log("[LOG]Upload Error: ",B.responseText,B.status);}FileUtils._mDiskLog.send({type:"html_upload_error",errno:B.status,msg:B.responseText});}}}};B.upload.onprogress=function(_){if(disk.DEBUG){console.warn("[LOG]Upload Progress: ",_.loaded,_.total," at ",F._mCurrentIndex);}F.dispatchFileProgress(D,F._mCurrentIndex,_.loaded/_.total,_.loaded,_.total);};this._mUploadKernal=B;B.open("POST",this.onCompileUrl(this._mUrl,D),true);B.send(C);return true;}return false;};B.prototype.dispatchDropEvent=function(_){if(disk.DEBUG){console.log("[LOG]drop files ",_);}this.dispatchMultiFilesAccepted(_);this.onDrop(this._mFileQueue);};B.prototype._sendException=function(B,_){this.onSetFileStatus(B,A.INCOMPLETE);this.onSetFileSubstatus(B,_);};B.prototype.dispatchMultiFilesAccepted=function(E){if(disk.DEBUG){console.log("[LOG]accept files ",E);}var D=null,C=Math.min(B.QUEUE_LIMIT_PER_SELECTION,E.length);if(E.length>B.QUEUE_LIMIT_PER_SELECTION){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u592a\u591a\u5566\uff01\u4e00\u6b21\u4ec5\u652f\u6301\u4e0a\u4f20200\u4e2a\u54df",sticky:false});if(disk.DEBUG){console.warn("pending limitation reached, 200 allowed at once");}return;}for(var A=0,_=C;A<_;A++){D=E.item(A);if(D.size>B.ONE_GIGABYTE){this._sendException(D,-110);}this.dispatchFileAccepted(D);}};B.prototype.dispatchFileRemoved=function(B,_){A.prototype.dispatchFileRemoved.call(this,B,_);if(_<=this._mCurrentIndex){this._mCurrentIndex-=1;}};B.prototype.onCancelUpload=function(B,_,C){if(disk.DEBUG){console.log("html5 cancel upload file ",B.path);}delete B[A.KEY_SUBSTATUS];if(_==this._mCurrentIndex){this._mDisrruptFromAbort=true;this._mUploadKernal.abort();this._mUploadKernal=null;}};B.prototype.listenDragAndDrop=function(C,F,E){var H=this,A=function(_){_.preventDefault();_.stopPropagation();_.dataTransfer.effectAllowed="none";H.onDragAcrossBoundary(null,true);return false;},G=function(_){_.preventDefault();_.stopPropagation();H.onDragAcrossBoundary(null,false);return false;},B=function(_){_.preventDefault();_.stopPropagation();H.onDragAcrossBoundary(null,false);return false;};C.addEventListener("dragenter",A,false);C.addEventListener("dragover",A,false);C.addEventListener("dragleave",G,false);C.addEventListener("drop",B,false);var D=function(_){_.preventDefault();_.stopPropagation();H.onDragAcrossBoundary(null,true);_.dataTransfer.effectAllowed="copy";return false;},_=function(_){_.preventDefault();_.stopPropagation();return false;};this.addDropTarget(F);F.addEventListener("dragenter",D,false);F.addEventListener("dragover",D,false);F.addEventListener("dragleave",_,false);this._mSurroundingView=F;this._mMaskContainer=E;};B.prototype.addDropTarget=function(_){var B=this,A=function(_){_.preventDefault();_.stopPropagation();B.dispatchDropEvent(_.dataTransfer.files);B.onDragAcrossBoundary(null,false);return false;};_.addEventListener("drop",A,false);};disk.ui.HTML5FileUploader=B;var D=function(_,A){disk.ui.FileUploader.call(this,_,A);this._mFlashKernal=null;this._mCurrentIndex=-1;};D.prototype=new disk.ui.FileUploader();D.prototype.onUploadFile=function(B,_){this._mCurrentIndex=_;this._mFlashKernal.startUpload(B.id);this._mPrivateFlags|=A.NOT_IDLE;};D.prototype.dispatchAcceptingEvent=function(_){this._dispatchPrebuild();};D.prototype.dispatchFileRemoved=function(B,_){A.prototype.dispatchFileRemoved.call(this,B,_);if(_<=this._mCurrentIndex){this._mCurrentIndex-=1;}};D.prototype._dispatchPrebuild=function(){var _=document.createElement("div"),F=this,C=disk.obtainId()+"_content",F=this,E=disk.ui.Utilities.getFlashVersion();if(E==null){this.dispatchRejectingEvent('\u8981\u4f7f\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u60a8\u9700\u8981\u5b89\u88c5Flash\u63d2\u4ef6, <a class="udrln-lnk" target="_blank" href="http://get.adobe.com/cn/flashplayer/">\u731b\u51fb\u8fd9\u91cc</a>\u5b89\u88c5');return;}if(parseInt(E)<9){this.dispatchRejectingEvent('\u8981\u4f7f\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u60a8\u9700\u8981\u5347\u7ea7Flash\u63d2\u4ef6, <a class="udrln-lnk" target="_blank" href="http://get.adobe.com/cn/flashplayer/">\u731b\u51fb\u8fd9\u91cc</a>\u5b89\u88c5');return;}_.className="b-uploader";this._mTrigger.appendChild(_);_.innerHTML='<div id="'+C+'"></div>';var B={};if(typeof document.attachEvent=="undefined"){if(disk.DEBUG){console.log("[LOG]Cookie>>>>>",B.cookie);}}this._mFlashKernal=new SWFUpload({upload_url:this._mUrl,button_width:110,button_height:35,button_placeholder_id:C,post_params:B,prevent_swf_caching:true,preserve_relative_urls:false,file_queue_limit:"200",file_size_limit:"1 GB",button_window_mode:"transparent",requeue_on_error:true,post_params:B,flash_url:"/res/static/images/swfupload.swf",button_cursor:SWFUpload.CURSOR.HAND,debug:false,file_dialog_start_handler:function(){FileUtils._mDiskLog.send({type:"uploadchoose"});F.onChooseFile();},file_queued_handler:function(_){F.dispatchFileAccepted(_);},swfupload_loaded_handler:function(){F._mFlashKernal.setFileQueueLimit(200);},file_queue_error_handler:function(C,B,_){switch(B){case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:if(disk.DEBUG){console.log("[LOG]ZERO_BYTE_FILE");}break;case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:if(disk.DEBUG){console.log("[LOG]QUEUE_LIMIT_EXCEEDED");}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u592a\u591a\u5566\uff01\u4e00\u6b21\u4ec5\u652f\u6301\u4e0a\u4f20200\u4e2a\u54df",sticky:false});break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:if(disk.DEBUG){console.log("[LOG]FILE_EXCEEDS_SIZE_LIMIT");}break;default:break;}if(C!=null){if(disk.DEBUG){console.log("[LOG]",_," ",B);}F.onSetFileStatus(C,A.INCOMPLETE);F.onSetFileSubstatus(C,B);F.dispatchFileAccepted(C);}},upload_progress_handler:function(B,C,_){var A=F.getFileById(B);if(disk.DEBUG){console.assert(A!=null);}if(A!=null){F.dispatchFileProgress(A,F._mCurrentIndex,C/_,C,_);}},upload_error_handler:function(D,C,B){F._mPrivateFlags&=~A.NOT_IDLE;if(disk.DEBUG){console.log("Catch Uploading Error[File:",D,"; ErrNo:",C,"; ErrMsg:",B,"]");}FileUtils._mDiskLog.send({type:"upload_fatal_error",errno:C,msg:B});if(D==null){if(disk.DEBUG){console.warn("File Not Found, Maybe removed by flash Kernal or user");}F.dispatchFileAbrupted(D,F._mCurrentIndex,A.ERROR);return;}var _=F.getFileById(D);if(disk.DEBUG){console.assert(_!=null);}if(_!=null){F.dispatchFileAbrupted(D,F._mCurrentIndex,A.ERROR);}},upload_success_handler:function(C,B,D){F._mPrivateFlags&=~A.NOT_IDLE;if(disk.DEBUG){console.log("[LOG]Upload Complete: ",B,D);}var _=F.getFileById(C);if(_!=null){F.dispatchFileComplete(_,B);}}});var D=function(_){FileUtils._mDiskLog.send({type:_});};$("a.cloudprint-choose-btn").bind("click",function(_){D("cloudprint-choose-btn");});$(".b-uploader").bind("mousedown",function(_){D("cloudprint-upload-btn");});this.onAccepting(this._mTrigger);};D.prototype.onCancelUpload=function(A,_,B){if(typeof B=="undefined"){B=false;}this._mFlashKernal.cancelUpload(A.id,B);};disk.ui.OpenSourceFlashFileUploader=D;var _=function(_,A){disk.ui.FileUploader.call(this,_,A);this._mNativeKernal=null;this._mCurrentIndex=-1;this._mClientAccepted=false;this._mRestoreFiles=[];this._mRestoreMode=false;this._mTryCount=0;this._mErrorDetailMap={};this._mHasConnectivity=true;};_._NUID="native_plugin_uploader_handler";_.briefVersion=disk.ui.FileUploader.DEFAULT_VERSION;_.upgradeVersion=disk.ui.FileUploader.DEFAULT_VERSION;_.forceUpgrade=false;_.DEFAULT_CLOUD_DIRECTORY="/";_.FEATURE_FOLDER_UPLOAD=0;_.parseDirInfo=function(B){var _=B.length,A=B.substring(_-1,_);if(A=="\\"){return B.substring(0,_-1);}return null;};_.preinstall=function(){var A=document.createElement("div"),C="",B=null;if(!_.isPlatformCompatible()){return B;}if(typeof document.body=="undefined"){if(disk.DEBUG){console.warn("Document was not ready on installation");}return;}B=document.getElementById(_._NUID);if(B==null){C=document.createElement("div");C.className="native-plugin";C.style.overflow="hidden";C.style.left="-999em";C.style.top="-999em";C.style.position="absolute";C.style.width="1px";C.style.height="1px";document.body.appendChild(C);if(typeof window.attachEvent!="undefined"){C.innerHTML='<object id="'+_._NUID+'" classid="CLSID:0898BF38-B941-4113-8357-8F342D9652F6" hidden="true" viewastext></OBJECT>';}else{C.innerHTML='<embed id="'+_._NUID+'" type="application/bd-npupload-plugin" width="0" height="0">';}B=document.getElementById(_._NUID);}return B;};_.isPlatformCompatible=function(){var _=navigator.platform;return _.toLowerCase().indexOf("win32")==0;};_.isRemoteEnforceUpgrade=function(){if(!disk.ui.NativePluginFileUploader.forceUpgrade){return false;}if(disk.ui.NativePluginFileUploader.briefVersion==disk.ui.FileUploader.DEFAULT_VERSION||disk.ui.NativePluginFileUploader.upgradeVersion==disk.ui.FileUploader.DEFAULT_VERSION){return false;}return disk.ui.NativePluginFileUploader.upgradeVersion>disk.ui.NativePluginFileUploader.briefVersion;};_.hasPlugin=function(){if(!_.isPlatformCompatible()){return false;}var D=null;try{D=new ActiveXObject("ieUploader.UploadCtl.1");if(disk.DEBUG){console.log("test activex plugin ",typeof D.Init);}disk.ui.NativePluginFileUploader.briefVersion=D.GetVersion();}catch(F){if(disk.DEBUG){console.log("test npapi plugin ",F.message);}var C=null,E=navigator.plugins;for(var B=0,A=E.length;B<A;B++){C=E[B].name||E[B].filename;if(C.indexOf("npUploader")!=-1){D=E[B];if(/(\d+(\.\d+)+)/.test(D.description)){disk.ui.NativePluginFileUploader.briefVersion=RegExp.$1;}break;}}}if(disk.DEBUG){console.log("test browser has plugin: ",D);}return D!=null;};_.getInstance=function(A,B){return _.singleton?_.singleton:(_.singleton=new _(A,B));};_.singleton=null;_.getPluginHook=function(){var A=document.getElementById(_._NUID);return A;};_.nativeCallbackInitEnd=function(){if(_.singleton){_.singleton.instanceCallbackInitEnd.call(_.singleton);}};_.nativeCallbackNetworkConnectivity=function(A){if(_.singleton){_.singleton.instanceNetworkConnectivity.call(_.singleton,A);}};_.nativeCallbackTaskListUpdate=function(B,A,C){if(_.singleton){_.singleton.instanceTaskListUpdate.call(_.singleton,B,A,C);}};_.callback4=function(A,C,B){if(_.singleton){_.singleton.instanceAddFileFailed.call(_.singleton,A,C,B);}};_.callback5=function(B,A,C){if(_.singleton){_.singleton.instanceUploadError.call(_.singleton,B,A,C);}};_.callback6=function(D,C,A,B){if(_.singleton){_.singleton.instanceUploadSucceed.call(_.singleton,D,C,A,B);}};_.callback7=function(D,C,A,B){if(_.singleton){_.singleton.instanceUploadProcess.call(_.singleton,D,C,A,B);}};_.callback8=function(B,A){if(_.singleton){_.singleton.instanceMD5End.call(_.singleton,B,A);}};_.callback9=function(B,A){if(_.singleton){_.singleton.instanceUploadCompleted.call(_.singleton,B,A);}};_.callback10=function(B,A,D,C){if(_.singleton){_.singleton.instanceAddFile.call(_.singleton,B,A,D,C);}};_.callback11=function(B,A){if(_.singleton){_.singleton.instanceUndoneFile.call(_.singleton,B,A);}};_.callback12=function(B,A,C){if(_.singleton){_.singleton.instanceFileDisable.call(_.singleton,B,A,C);}};_.callback13=function(B,A,C,D){if(_.singleton){_.singleton.instanceReadFolderFiles.call(_.singleton,B,A,C,D);}};_.callback14=function(B,A,C){if(_.singleton){_.singleton.instanceFolderError.call(_.singleton,B,A,C);}};_.callback15=function(C,B,A){if(_.singleton){_.singleton.instanceFolderSuccessUploadFileCount.call(_.singleton,C,B,A);}};_.KEY_PATH="path";_.newFile=function(F,E,G,H){var _=disk.ui.NativePluginFileUploader.parseDirInfo(F),J=(_!=null),D=J?_:F,I=D.substring(D.lastIndexOf("\\")+1),B=I,A=B.lastIndexOf(".");if(A!=-1){B=B.substring(A);}var C={id:disk.ui.FileUploader.obtainId(),name:I,type:B,server_path:E,progress:H,size:G,dir:J||0};C[disk.ui.NativePluginFileUploader.KEY_PATH]=F;return C;};_.getUpgradeVersion=function(){return disk.ui.NativePluginFileUploader.upgradeVersion;};_.prototype=new disk.ui.FileUploader();_.prototype.instanceReadFolderFiles=function(C,B,D,E){if(disk.DEBUG){console.log("read file from ",C," and count as ",E," and result ",D);}var _=this.getFileByPath(C,true);if(D==-1015){this.onSetFileStatus(_,A.ERROR);this.onSetFileSubstatus(_,D);this.dispatchFileAbrupted(_,this._mCurrentIndex,A.ERROR);}else{_.folderStatus=D;_.fileCount=E;this.dispatchUpdateStatus(_,this._mCurrentIndex);}};_.prototype.instanceFolderError=function(C,B,D){var _=this.getFileByPath(C,true);_.folderStatus=2;this._mErrorDetailMap[C]=D;this._mPrivateFlags&=~A.NOT_IDLE;this.onSetFileSubstatus(_,_[disk.ui.FileUploader.KEY_SUBSTATUS]);this.dispatchFileAbrupted(_,this._mCurrentIndex,A.ERROR);if(disk.DEBUG){console.log("folder error from ",C," error defail ",D,"\n",_);}};_.prototype.getErrorDetail=function(A){var B=this._mErrorDetailMap[A];if(typeof B=="undefined"){return null;}else{if(typeof B=="string"){var _=$.parseJSON(B);if(_!=null&&_.errorlist){this._mErrorDetailMap[A]=_.errorlist;return _.errorlist;}else{return null;}}else{return B;}}};_.prototype.instanceFolderSuccessUploadFileCount=function(D,C,_){if(disk.DEBUG){console.log("folder complete ",D," succ count ",_);}var B=this.getFileByPath(D,true);if(B!=null&&(B[A.KEY_STATUS]!=A.PAUSE)){B.succCount=_;this.dispatchUpdateStatus(B,this._mCurrentIndex);}};_.prototype.instanceCallbackInitEnd=function(){if(disk.DEBUG){console.log("******c++ plugin init complete, start high speed uploading******");}this.onAccepting(this._mTrigger);this._mClientAccepted=true;var _=disk.ui.FileUploader.RESTORE_FILES;if((this._mPrivateFlags&_)==_){this._mPrivateFlags&=~_;this._restoreFiles();}};_.prototype.instanceNetworkConnectivity=function(_){if(disk.DEBUG){console.log("NetworkConnectivity "+_);}this._mHasConnectivity=_;var B=this._mFileQueue.length;if(!_&&this.inSessionProgress()&&this._mCurrentIndex>=0&&this._mCurrentIndex<B){var A=this._mFileQueue[this._mCurrentIndex];this.dispatchProgressPauseEvent(A,this._mCurrentIndex,A.progress,true);}else{if(_&&this._mCurrentIndex>=0&&this._mCurrentIndex<B){A=this._mFileQueue[this._mCurrentIndex];this.dispatchProgressResumeEvent(A,this._mCurrentIndex,A.progress);}}};_.prototype.instanceTaskListUpdate=function(A,_,B){};_.prototype._storeFile=function(B,A,D,C){var _=disk.ui.FileUploader.RESTORE_FILES;if((this._mPrivateFlags&_)!=_){this._mPrivateFlags|=_;}this._mRestoreFiles.push([B,A,D,C]);};_.prototype._restoreFiles=function(){var A=null;this._mRestoreMode=true;for(var B=0,_=this._mRestoreFiles.length;B<_;B++){A=this._mRestoreFiles[B];if(typeof A[3]=="undefined"){this.instanceAddFileFailed(A[0],A[1]);}else{this.instanceAddFile(A[0],A[1],A[2],A[3]);}}this._mRestoreMode=false;this._mRestoreFiles.length=0;};_.prototype.instanceFileDisable=function(C,B,D){var _=this.getFileByPath(C,true);if(_&&(_[A.KEY_STATUS]!=A.PAUSE)){this.dispatchDisableEvent(_,D,this._mCurrentIndex);}};_.prototype.instanceUploadError=function(D,C,E){if(E==-1001){this.instanceNetworkConnectivity(false);return;}this._mPrivateFlags&=~A.NOT_IDLE;if(disk.DEBUG){console.log("UploadError ",D,C,"==>",E);}var B=this.getFileByPath(D,true);if(B==null){if(disk.DEBUG){console.warn("upload failed, file="+D);}}this.onSetFileStatus(B,A.ERROR);FileUtils._mDiskLog.send({type:"activex_upload_error",errno:E,filePath:D,isdir:B.dir,version:this.getVersion()});var _=this._mHasConnectivity?(!Utilities.hasEnoughSpacing(parseInt(B.size))?-999:-998):-9999;if(_==-998&&typeof E!="undefined"){if(typeof A.errorMap[E]!="undefined"){_=E;}}this.onSetFileSubstatus(B,_);this.dispatchFileAbrupted(B,this._mCurrentIndex,A.ERROR);};_.prototype.instanceAddFileFailed=function(C,E,D){var _=0;if(E==-1013){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6\u8d85\u51fa1000\u4e0a\u9650\u5566\uff0c\u524d1000\u4e2a\u5df2\u7ecf\u6dfb\u52a0\u5230\u4e0a\u4f20\u5217\u8868\u4e2d\u4e86\uff0c\u5269\u4f59\u7684\u91cd\u65b0\u6dfb\u52a0\u4e00\u4e0b\u5427",sticky:false});return;}else{if(typeof D!="undefined"){_=parseInt(D);}}if(!this._mClientAccepted){if(disk.DEBUG){console.warn("Store AddFileFailed ",C,E);}this._storeFile(C,E);}else{if(disk.DEBUG){console.log("AddFileFailed ",C,E);}var B=disk.ui.NativePluginFileUploader.newFile(C,"",_,0);this.onSetFileStatus(B,A.INCOMPLETE);this.onSetFileSubstatus(B,E);this.dispatchFileAccepted(B,this._mRestoreMode,this._mRestoreFiles.length);}};_.prototype.instanceAddFile=function(C,B,E,D){if(!this._mClientAccepted){if(disk.DEBUG){console.warn("Store Pend File ",C,B,E,D);}this._storeFile(C,B,E,D);}else{if(disk.DEBUG){console.log("Pend File ",C,B,E,D);}var _=disk.ui.NativePluginFileUploader.newFile(C,B,parseInt(D),E);this.onSetFileStatus(_,A.PENDING);this.dispatchFileAccepted(_,this._mRestoreMode,this._mRestoreFiles.length);}};_.prototype.instanceUploadSucceed=function(E,D,_,B){this._mPrivateFlags&=~A.NOT_IDLE;if(disk.DEBUG){console.log("UploadSucceed ",E,D,_,B);}var C=this.getFileByPath(E,true);FileUtils._mDiskLog.send({type:"activex_upload_success",uploadStyle:B,filePath:encodeURIComponent(E),isdir:C.dir,version:this.getVersion()});if(C){C.folderStatus=1;delete C[A.KEY_SUBSTATUS];C.uploadStyle=B;this.dispatchFileComplete(C);}};_.prototype.instanceUploadProcess=function(E,D,_,C){var B=this.getFileByPath(E,true);if(!B||(B[A.KEY_STATUS]==A.PAUSE)){if(disk.DEBUG){console.warn("Rejecting update progress, cause pause event are issued precedely or requested file not located");}return;}_=disk.ui.FileUploader.formatBytePerSeconds(_*1024*8);if(disk.DEBUG){console.log("###NativeUploader UploadProcess ",E,D,_,C,"; file msgValue=",B.folderStatus);}B.progress=Math.max(B.progress,C);B[A.KEY_SIZE_UPLOADED]=B.progress*B.size;B[A.KEY_SPEED]=_;this.dispatchFileProgress(B,this._mCurrentIndex,C,0,_);};_.prototype.instanceUndoneFile=function(A,_){if(disk.DEBUG){console.log("UndoneFile ",A,_);}};_.prototype.dispatchRemoveAllFile=function(){var _=disk.ui.FileUploader.prototype.dispatchRemoveAllFile;_.call(this);this._mNativeKernal.ClearUserData();this._mErrorDetailMap={};};_.prototype.dispatchProgressPauseEvent=function(B,C,D,_){if(disk.DEBUG){console.warn("*****call plugin to pause at ",C," for file ",B.path);}this.onSetFileStatus(B,A.PAUSE);delete B[A.KEY_SUBSTATUS];this._mNativeKernal.PauseUpload(B.path);var E=A.IN_SESSION_UPLOADING,F=false;if((this._mPrivateFlags&E)==E&&this._mCurrentIndex!=C&&this._mCurrentIndex!=-1){if(disk.DEBUG){console.log("pause pending item in uploading session, will not set idle flag");}}else{this._mPrivateFlags&=~A.NOT_IDLE;}if(_===true){this._mPrivateFlags&=~A.IN_SESSION_UPLOADING;}else{if(C>this._mCurrentIndex){_=true;F=true;}}this.onProgressPause(B,C,D,_,F);};_.prototype.dispatchProgressResumeEvent=function(_,B,C,E){if(this._mCurrentIndex>B){this._mLastResumeIndex=this._mLastResumeIndex==-1?B:Math.min(this._mLastResumeIndex,B);}if(!this.inSessionProgress()){this._mAutoUploadIndex=-1;}var D=_[A.KEY_STATUS];if(D==A.COMPLETE){if(_.folderStatus==2){this.onSetFileStatus(_,A.PENDING);delete _[A.KEY_SUBSTATUS];}}else{this.onSetFileStatus(_,A.PENDING);delete _[A.KEY_SUBSTATUS];}if(E!==true){_.resume=true;}this.onProgressResume(_,B,C);};_.prototype.autoUpload=function(){var _=disk.ui.FileUploader.prototype.autoUpload;if(this._mLastResumeIndex!=-1){this._mAutoUploadIndex=Math.max(-1,this._mLastResumeIndex-1);this._mLastResumeIndex=-1;}_.call(this);};_.prototype.setCloudPath=function(B,_){if(_[A.KEY_SUBSTATUS]===-1009){return;}if(B.charAt(B.length-1)!="/"){B+="/";}if(disk.DEBUG){console.log("=>sync cloud path = ",B);}this._mNativeKernal.SetNetDiskPath(_.path,B);};_.prototype.getVersion=function(){if(!this._mNativeKernal){return disk.ui.NativePluginFileUploader.upgradeVersion;}return this._mNativeKernal.GetVersion();};_.prototype.hasFeature=function(A){switch(A){case _.FEATURE_FOLDER_UPLOAD:return disk.ui.FileUploader.versionCompare(this.getVersion(),"1.1.0.0")>0;}return false;};_.prototype.getMachineUID=function(){if(!this._mNativeKernal){return"unknow";}return this._mNativeKernal.GetPCCode();};_.prototype.dispatchFileProgress=function(C,_,E,D,B){this.onSetFileStatus(C,A.UPLOADING);this.onFileProgress(C,_,E,0,0,B);};_.prototype.instanceMD5End=function(C,B){if(disk.DEBUG){console.log("MD5End ",C,B);}var _=this.getFileByPath(C,true);this.onSetFileSubstatus(_,-990);this.dispatchUpdateStatus(_,this._mCurrentIndex);delete _[A.KEY_SUBSTATUS];};_.prototype.instanceUploadCompleted=function(A,_){if(disk.DEBUG){console.log("UploadCompleted ",A,_);}FileUtils._mDiskLog.send({type:"activex_upload_count",filePath:A});};_.prototype._dispatchPrebuild=function(){var A=this;this._mNativeKernal=disk.ui.NativePluginFileUploader.getPluginHook();if(this._mNativeKernal==null){this.dispatchRejectingEvent("\u521d\u59cb\u5316\u6781\u901f\u4e0a\u4f20\u7ec4\u4ef6\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u5237\u65b0\u9875\u9762\u91cd\u8bd5");return;}if(typeof window.attachEvent!="undefined"){this._mNativeKernal.attachEvent("InitEnd",disk.ui.NativePluginFileUploader.nativeCallbackInitEnd);this._mNativeKernal.attachEvent("TaskListUpdate",disk.ui.NativePluginFileUploader.nativeCallbackTaskListUpdate);this._mNativeKernal.attachEvent("MD5End",disk.ui.NativePluginFileUploader.callback8);this._mNativeKernal.attachEvent("UploadProcess",disk.ui.NativePluginFileUploader.callback7);this._mNativeKernal.attachEvent("UploadSucceed",disk.ui.NativePluginFileUploader.callback6);this._mNativeKernal.attachEvent("UploadError",disk.ui.NativePluginFileUploader.callback5);this._mNativeKernal.attachEvent("UploadCompleted",disk.ui.NativePluginFileUploader.callback9);this._mNativeKernal.attachEvent("NetWorkConnectivity",disk.ui.NativePluginFileUploader.nativeCallbackNetworkConnectivity);this._mNativeKernal.attachEvent("UndoneFileModified",disk.ui.NativePluginFileUploader.callback11);this._mNativeKernal.attachEvent("AddFileFailed",disk.ui.NativePluginFileUploader.callback4);this._mNativeKernal.attachEvent("AddNewFile",disk.ui.NativePluginFileUploader.callback10);this._mNativeKernal.attachEvent("LockPause",disk.ui.NativePluginFileUploader.callback12);if(this.hasFeature(disk.ui.NativePluginFileUploader.FEATURE_FOLDER_UPLOAD)){this._mNativeKernal.attachEvent("ReadFolderFiles",disk.ui.NativePluginFileUploader.callback13);this._mNativeKernal.attachEvent("FolderError",disk.ui.NativePluginFileUploader.callback14);this._mNativeKernal.attachEvent("FolderSuccessUploadFileCount",disk.ui.NativePluginFileUploader.callback15);}}else{globalNativeUploadHandler=this._mNativeKernal;A=this;if(typeof this._mNativeKernal.AddEvent=="undefined"){if(this._mTryCount>50){if(disk.DEBUG){console.error("Call Active Failed");}return;}else{setTimeout(function(){A._dispatchPrebuild();},100);}this._mTryCount++;return;}else{this._mTryCount=0;if(disk.DEBUG){console.log("===>Create Plugin "+this._mNativeKernal);}}this._mNativeKernal.AddEvent("InitEnd","globalNativeUploadHandler.nativeCallbackInitEnd");globalNativeUploadHandler.nativeCallbackInitEnd=disk.ui.NativePluginFileUploader.nativeCallbackInitEnd;this._mNativeKernal.AddEvent("NetWorkConnectivity","globalNativeUploadHandler.nativeCallbackNetworkConnectivity");globalNativeUploadHandler.nativeCallbackNetworkConnectivity=disk.ui.NativePluginFileUploader.nativeCallbackNetworkConnectivity;this._mNativeKernal.AddEvent("TaskListUpdate","globalNativeUploadHandler.nativeCallbackTaskListUpdate");globalNativeUploadHandler.nativeCallbackTaskListUpdate=disk.ui.NativePluginFileUploader.nativeCallbackTaskListUpdate;this._mNativeKernal.AddEvent("AddFileFailed","globalNativeUploadHandler.callback4");globalNativeUploadHandler.callback4=disk.ui.NativePluginFileUploader.callback4;this._mNativeKernal.AddEvent("UploadError","globalNativeUploadHandler.callback5");globalNativeUploadHandler.callback5=disk.ui.NativePluginFileUploader.callback5;this._mNativeKernal.AddEvent("UploadSucceed","globalNativeUploadHandler.callback6");globalNativeUploadHandler.callback6=disk.ui.NativePluginFileUploader.callback6;this._mNativeKernal.AddEvent("UploadProcess","globalNativeUploadHandler.callback7");globalNativeUploadHandler.callback7=disk.ui.NativePluginFileUploader.callback7;this._mNativeKernal.AddEvent("MD5End","globalNativeUploadHandler.callback8");globalNativeUploadHandler.callback8=disk.ui.NativePluginFileUploader.callback8;this._mNativeKernal.AddEvent("UploadCompleted","globalNativeUploadHandler.callback9");globalNativeUploadHandler.callback9=disk.ui.NativePluginFileUploader.callback9;this._mNativeKernal.AddEvent("AddNewFile","globalNativeUploadHandler.callback10");globalNativeUploadHandler.callback10=disk.ui.NativePluginFileUploader.callback10;this._mNativeKernal.AddEvent("UndoneFileModified","globalNativeUploadHandler.callback11");globalNativeUploadHandler.callback11=disk.ui.NativePluginFileUploader.callback11;this._mNativeKernal.AddEvent("LockPause","globalNativeUploadHandler.callback12");globalNativeUploadHandler.callback12=disk.ui.NativePluginFileUploader.callback12;if(this.hasFeature(disk.ui.NativePluginFileUploader.FEATURE_FOLDER_UPLOAD)){this._mNativeKernal.AddEvent("ReadFolderFiles","globalNativeUploadHandler.callback13");globalNativeUploadHandler.callback13=disk.ui.NativePluginFileUploader.callback13;this._mNativeKernal.AddEvent("FolderError","globalNativeUploadHandler.callback14");globalNativeUploadHandler.callback14=disk.ui.NativePluginFileUploader.callback14;this._mNativeKernal.AddEvent("FolderSuccessUploadFileCount","globalNativeUploadHandler.callback15");globalNativeUploadHandler.callback15=disk.ui.NativePluginFileUploader.callback15;}}if(typeof FileUtils=="undefined"||typeof FileUtils.sysUID=="undefined"){throw new Error("Can not resolve user unique key");}this._mNativeKernal.Init(FileUtils.sysUID,disk.api.RestAPI.ACTIVEX_ORIGIN_HOST,"BDUSS="+FileUtils.cktoken,disk.api.RestAPI.ACTIVEX_SERVER_HOST);var _=disk.ui.NativePluginFileUploader.upgradeVersion;if(_==disk.ui.FileUploader.DEFAULT_VERSION){disk.ui.NativePluginFileUploader.upgradeVersion=this.getVersion();}FileUtils._mDiskLog.send({type:"machine_code",id:this.getMachineUID(),version:this.getVersion()});if(disk.DEBUG){console.log("**********************************","\nMachine UID: ",this.getMachineUID(),"\nVersion: ",this.getVersion(),"\nSupposed Version: ",disk.ui.NativePluginFileUploader.upgradeVersion,"\nHost: ",location.host,"\nPCS Host: ",disk.api.RestAPI.ACTIVEX_SERVER_HOST,"\n**********************************");}};_.prototype.onChoosingFiles=function(A){if(disk.DEBUG){console.log("be about to choose local file, waiting os...");}if(this._mNativeKernal!=null){if(A){this._mNativeKernal.AddUploadFolder(_.DEFAULT_CLOUD_DIRECTORY);}else{this._mNativeKernal.AddUploadFile(_.DEFAULT_CLOUD_DIRECTORY);}}};_.prototype.onUploadFile=function(B,_){if(disk.DEBUG){console.log("start uploading file "+B);}this._mCurrentIndex=_;this.onSetFileSubstatus(B,-991);this.dispatchUpdateStatus(B,_);if(B.resume===true){if(disk.DEBUG){console.log("$$$$start resume uploading at ",_," for file ",B.path);}this._mNativeKernal.ResumeUpload(B.path);delete B.resume;}else{if(disk.DEBUG){console.log("$$$$start pure uploading at ",_," for file ",B.path);}this._mNativeKernal.StartUpload(B.path);}this._mPrivateFlags|=A.NOT_IDLE;};_.prototype.getFileByPath=function(E,D){var A=null,F=disk.ui.NativePluginFileUploader.KEY_PATH,C=D===true?Math.max(this._mCurrentIndex,0):0;for(var B=C,_=this._mFileQueue.length;B<_;B++){A=this._mFileQueue[B];if(A[F]==E){return A;}}return null;};_.prototype.dispatchAcceptingEvent=function(_){this._dispatchPrebuild();};_.prototype.dispatchFileRemoved=function(B,_){A.prototype.dispatchFileRemoved.call(this,B,_);if(_<=this._mCurrentIndex){this._mCurrentIndex-=1;}};_.prototype.onCancelUpload=function(B,_,C){if(disk.DEBUG){console.log("$$$$$cancel upload file ",B.path);}delete B[A.KEY_SUBSTATUS];this._mNativeKernal.PauseUpload(B.path);};disk.ui.NativePluginFileUploader=_;var C=function(_){disk.ui.Panel.call(this,_);this._mAuthorityKey=null;this._mFileUploader=null;this._mViewFlags=0;this._mErrMsgHandler=null;this._mInfiniteListView=null;this._mPendingHighlightFiles=[];this._mMinProxyHandler=null;this._mCurrentUploadDocId=disk.obtainId();this._mCurrentUploadProgressId=disk.obtainId();this._mCurrentUploadRemainingId=disk.obtainId();this._mCurrentUploadMaxId=disk.obtainId();this._mCurrentUploadTitleId=disk.obtainId();this._mCurrentUploadTimer=null;this._mCheckInTimer=new disk.util.TimerService(disk.ui.UploadDialog.DELAY_TO_CHECK_IN,null);this._mWindowTitle=null;this._mWindowSetIdle=true;this._mLastErrorMsg=null;this._mExceptionMsgContainerDom=null;this._mExceptionRetryTrigger=null;this._mExceptionMsgDom=null;this._mListContainerHeight=0;this._mListColgroupHeight=0;this._mHeadlineProgressHandler=null;this._mSessionFailureCount=0;this._mSessionCompleteCount=0;this._mSessionUploadSize=0;this._mDialogSessionFailureInfo=[];this._mLastAvailSpeed=null;this._mLogTimestamp=null;this._mLogTimestamp2=0;this._mEnhancedFeature=false;this._mActivePlugin=false;this._mHTML5Plugin=false;this._mLastFileSize=0;this._mTipVersion=null;this._mLockIndex=-1;this._mErrorReportPane=null;this._mLastErrorReportPos=-1;this._mDndZoneMask=null;};C.VIEW_INIT=1;C.SERVER_URL_RESOLVE=2;C.START_TO_ULOADING=4;C.UPLOAD_SOMETHING=1024;C.HAS_BUILD=2048;C.UPLOAD_PROXY_TRANSITION=4096;C.UPLOAD_PROXY_VISIBLE=8192;C.DIRECTORY_CHOOSER_VISIBILITY=16384;C.SESSION_TREEVIEW_BUILD=32768;C.EXCEPTION_MSG_BUILD=65536;C.EXCEPTION_MSG_VISIBLE=131072;C.SCHEDULE_SESSION_COMPLETE=262144;C.INSTALL_HINT_BUILD=524288;C.GENERAL_MESSAGE=1048576;C.SHOW_BULK_FILE_CAUTION=2097152;C.SUCCESS=0;C.FAILURE=1;C.STATUS_PENDING=-1;C.STATUS_UPLOADING=0;C.STATUS_COMPLETE=1;C.RETRY_BUTTON_FAILURE=0;C.RETRY_BUTTON_RESTORE=1;C.PREVENT_UNLOADPAGE=false;C.PREF_KEY_INS_GUI="pref_upload_ins_guide";C.PREF_KEY_INS_GUI_2="pref_upload_ins_guide_2";C.PREF_KEY_INS_GUI_3="pref_upload_ins_guide_3";C.PREF_KEY_INS_GUI_4="pref_upload_ins_guide_4";C.LINK_URL="//bs.baidu.com/netdisk/UploadPlugin_%s.exe";C.INSTALL_TEXT='<i class="up-dd-tip"></i><dfn class="txt1 tips-prx ellipsis">\u652f\u6301\u6781\u901f\u4e0a\u4f20\u5566\uff014G\u5927\u6587\u4ef6\u9ad8\u901f\u79d2\u4f20\uff0c\u652f\u6301\u6587\u4ef6\u5939\u4e0a\u4f20\uff0c\u65ad\u70b9\u7eed\u4f20\u968f\u5fc3\u6240\u6b32\uff01</dfn><a target="_blank" class="two-pix-btn" href="//bs.baidu.com/netdisk/UploadPlugin_%s.exe">\u4e0b\u8f7d\u5b89\u88c5</a>';C.INSTALL_TEXT_2='<i class="up-dd-tip"></i><dfn class="txt1 tips-prx ellipsis">\u4f60\u4e0a\u4f20\u7684\u6587\u4ef6\u8f83\u5927\uff0c\u5efa\u8bae\u5b89\u88c5\u6781\u901f\u4e0a\u4f20\u63a7\u4ef6\uff0c\u652f\u6301\u65ad\u70b9\u7eed\u4f20\u3002</dfn><a target="_blank" class="two-pix-btn" href="//bs.baidu.com/netdisk/UploadPlugin_%s.exe">\u4e0b\u8f7d\u5b89\u88c5</a>';C.UPGRADE_TEXT='<i class="up-dd-tip"></i><dfn class="txt1 tips-prx ellipsis">\u4e0a\u4f20\u63a7\u4ef6\u6709\u65b0\u7248\u672c\u5566\uff0c4G\u5927\u6587\u4ef6\u9ad8\u901f\u79d2\u4f20\u3001\u65ad\u70b9\u7eed\u4f20\u968f\u5fc3\u6240\u6b32\uff0c\u5feb\u6765\u5b89\u88c5\u66f4\u65b0\u5427\u3002</dfn><a target="_blank" class="two-pix-btn" href="//bs.baidu.com/netdisk/UploadPlugin_%s.exe">\u66f4\u65b0\u5b89\u88c5</a>';C.DND_ZONE_EDGE_OFFSET_HOR=4;C.DND_ZONE_EDGE_OFFSET_VER=0;C.prototype=new disk.ui.Panel();C.installProDialog=function(B,_){return;if(typeof disk.ui.ActiveProDialog!="undefined"){var A=new disk.ui.ActiveProDialog(disk.util.MessageFormatter.sprintf(C.LINK_URL,B),_);A.setVisible(true);}else{$.getScript("/res/static/js/buss/dialog/active_pro_dialog.js").done(function(){var A=new disk.ui.ActiveProDialog(disk.util.MessageFormatter.sprintf(C.LINK_URL,B),_);A.setVisible(true);});}};C.prototype._checkActivePlugin=function(){if(disk.DEBUG){console.log("start checking plugin availability and figure out upgrading strategy");}if(typeof Page=="undefined"){if(disk.DEBUG){console.warn("wrong plugin checking spot");}}else{if(!disk.ui.NativePluginFileUploader.isPlatformCompatible()){if(disk.DEBUG){console.log("Not support platform");}return;}var K=localStorage.getItem(C.PREF_KEY_INS_GUI),L=false,F=false,D=this._mFileUploader,I=disk.ui.NativePluginFileUploader.getUpgradeVersion(),_=this._mActivePlugin?D.getVersion():disk.ui.FileUploader.DEFAULT_VERSION,G=C.INSTALL_TEXT;if(!K){K=disk.ui.FileUploader.DEFAULT_VERSION;F=true;}var A=disk.ui.FileUploader.versionCompare(I,_);if(A>0){_=I;}else{if(A<0){K=_;}}if(disk.ui.FileUploader.versionCompare(_.trim(),K.trim())>0){if(this._mActivePlugin||disk.ui.NativePluginFileUploader.hasPlugin()){G=C.UPGRADE_TEXT;}L=true;}if(this._mActivePlugin&&I==D.getVersion()){L=false;}if(!this._mActivePlugin&&F){L=true;}if(this._mActivePlugin&&!L){var E=localStorage.getItem(C.PREF_KEY_INS_GUI_4);if(!E){localStorage.setItem(C.PREF_KEY_INS_GUI_4,1);}}this._mTipVersion=I;if(L){var J=localStorage.getItem(C.PREF_KEY_INS_GUI_3);if(!this._mActivePlugin&&!J){C.installProDialog(_);localStorage.setItem(C.PREF_KEY_INS_GUI_3,1);return;}var B=Page.showNotification(true,disk.util.MessageFormatter.sprintf(G,I));if(B==null){if(disk.DEBUG){console.warn("show plugin nofication failed, not an idea checking spot");}}else{var H=B.getElementsByTagName("div")[0];H.setAttribute("_v",_);H.onclick=function(A){Page.showNotification(false);localStorage.setItem(C.PREF_KEY_INS_GUI,this.getAttribute("_v"));var _=A||window.event;if(typeof _.stopPropagation!="undefined"){_.stopPropagation();}else{_.cancelBubble=true;}return false;};}}}};C.prototype.hasPauseTask=function(){var D=this._mFileUploader,C=D.getFileQueue(),A=disk.ui.FileUploader.KEY_STATUS;for(var B=0,_=C.length;B<_;B++){if(C[B][A]==disk.ui.FileUploader.PAUSE){return true;}}return false;};C.prototype._prebuild=function(){var D=this;this._mUI.listContainer=document.getElementById("uploadFileListContainer");this._mUI.uploadCurrentDirLabel=document.getElementById("uploadCurrentDirLabel");var _={suggestOptionQuery:disk.ui.Utilities.getSuggestedOptionQuery()};if(disk.DEBUG){console.info("Suggested option query=",_.suggestOptionQuery);}this._mFileUploader=disk.ui.FileUploader.getInstance(this._mUI.trigger,null,_);if(this._mFileUploader instanceof disk.ui.NativePluginFileUploader){this._mEnhancedFeature=true;this._mActivePlugin=true;}else{if(this._mFileUploader instanceof disk.ui.HTML5FileUploader){this._mFileUploader.onCompileUrl=function(C,B){if(disk.DEBUG){console.log("html5 uploading->",B,C);}var _=D._parseServerFile(B);if(_.length==0){_="/";}var A=disk.util.MessageFormatter.sprintf(C,encodeURIComponent(_),encodeURIComponent(B.name));if(disk.DEBUG){console.log("upload url=> ",A);}return A;};this._mHTML5Plugin=true;}}if(this._mActivePlugin){$("#barCmdUpload .icon-update").addClass("icon-atv");var B=document.getElementById("uploadDialogHeadlineStrong");if(B){B.parentNode.insertBefore(document.createElement("dfn"),B);$(this._mUI.pane).addClass("rkt-on");}this._mFileUploader.onUpdateStatus=function(_,A){D._dispatchUpdateSubstatus(_,A);};this._mFileUploader.onProgressPause=function(A,B,C,_,E){if(_!==true){D.dispatchUpdateListView();D._mFileUploader.autoUpload();}else{D.dispatchUpdateListView();if(E===true){}else{D._mViewFlags|=disk.ui.UploadDialog.GENERAL_MESSAGE;D.dispatchUploadFailure(true,"\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc");}}};this._mFileUploader.onProgressResume=function(_,A,B){D.dispatchUploadFailure(false);if(!D._mFileUploader.inSessionProgress()){D._mViewFlags|=C.START_TO_ULOADING;D.dispatchUpdateListView();}else{D.dispatchUpdateListView();}};this._mFileUploader.onFileDisable=function(A,_,B){if(disk.DEBUG){console.warn("Lock file with status = ",_);}D._mLockIndex=_?B:-1;D.dispatchUpdateListView();};}this._mFileUploader.onAccepting=function(_){$(_).removeClass("disabled");D._build();};this._mFileUploader.onRejecting=function(_){D._mLastErrorMsg=_;};this._mFileUploader.onFileAccepted=function(E,F,B){if(disk.DEBUG){console.log("restore mode==>",F);}D._mLastFileSize=E.size;if(E){D._mSessionUploadSize+=E.size;}if(disk.DEBUG){console.log("[LOG]Accept File ",E);}var I=D.inSpecialMode()?"":FileUtils.getDirMgr().getDir();I=F===true?E.server_path.substring(0,E.server_path.length-1):I;if(disk.DEBUG){console.log(I,"<=>",E.server_path);}D.syncCloudPath(I,E);E[A.KEY_SERVER_MAPPED_PATH]=I;E[A.KEY_SERVER_MAPPED_SIMPLE_PATH]=FileUtils.parseNameFromPath(I);if(!D.isVisible()){D.setVisible(true);}var H=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE,G=disk.ui.UploadDialog.UPLOAD_PROXY_TRANSITION,_=disk.ui.UploadDialog.EXCEPTION_MSG_VISIBLE;if((D._mViewFlags&H)==H&&(D._mViewFlags&G)!=G){if(disk.DEBUG){console.log("Force Proxy To Appear");}if(F!==true){D.setMinimumProxyVisible(false);}else{if((D._mViewFlags&_)!=_){D.dispatchUploadFailure(true,"\u60a8\u4e0a\u6b21\u6709\u5f02\u5e38\u4e2d\u65ad\u672a\u5b8c\u6210\u4e0a\u4f20\u7684\u6587\u4ef6\uff0c\u53ef\u4ee5\u7ee7\u7eed\u4e0a\u4f20\u54e6\u3002",C.RETRY_BUTTON_RESTORE,B);}if(disk.DEBUG){console.warn("show tips");}}}if(!Utilities.hasEnoughSpacing(parseInt(E.size||0))){D._mFileUploader.onSetFileStatus(E,A.INCOMPLETE);D._mFileUploader.onSetFileSubstatus(E,-999);}if(F!==true){D._mViewFlags|=C.START_TO_ULOADING;}D.dispatchUpdateListView();D._setTitle();};this._mFileUploader.onChooseFile=function(){D._setTitle();};this._mFileUploader.onFileRemoved=function(A,_){D.dispatchUpdateListView();};this._mFileUploader.onFileAbrupted=function(C,_,B){if(C){var E=C[A.KEY_STATUS];if(E!=A.ABORT){if(typeof C.fileCount=="number"){D._mSessionFailureCount+=(C.fileCount-C.succCount);}else{D._mSessionFailureCount++;}}}D.dispatchUpdateListView();if(disk.DEBUG){console.log("[LOG]abrupt file at ",_," and session complete ",D._mSessionFailureCount);}D._logUploadingState(1,C.type);D._checkSessionComplete();if(C.dir){var F=C[A.KEY_SERVER_MAPPED_PATH];if(!D.inSpecialMode()&&F==FileUtils.getDirMgr().getDir()){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.issueProxyLoading(true,true);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());Utilities.scheduleQueryQuota();}}if(B==A.ERROR){D.pcsSpeedReport(C.size,B);}};this._mFileUploader.onFileComplete=function(B,_){if(D._mActivePlugin||D._mHTML5Plugin){D._mSessionCompleteCount++;D._checkSessionComplete();D._mFileUploader.onSetFileStatus(B,A.COMPLETE);var E=B[A.KEY_SERVER_MAPPED_PATH];if(!D.inSpecialMode()&&E==FileUtils.getDirMgr().getDir()){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.issueProxyLoading(true,true);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());Utilities.scheduleQueryQuota();}D.dispatchUpdateListView();D._mFileUploader.autoUpload();D.pcsSpeedReport(B.size,0,B.server_mapped_path+"/"+B.name);}else{D.dispatchCheckInFile(B,_,function(_){if(disk.DEBUG){console.warn("[SIGNAL]Complete Upload "+B.index);}if(_==C.SUCCESS){D._mSessionCompleteCount++;}else{D._mSessionFailureCount++;}D._checkSessionComplete();});}D._logUploadingState(0,B.type);FileUtils.sendAwardTaskRequest("upload");};this._mFileUploader.onFileProgress=function(H,_,K,J,G,B){if(B=="0 B/s"){if(D._mLastAvailSpeed!=null){B=D._mLastAvailSpeed;}}else{D._mLastAvailSpeed=B;}D.dispatchUpdateProgressbar(H,_,K,J,G,B);var F=D.getRemainingTime(B,_),I=A.toFriendlyTiming(B,D._mSessionUploadSize),E=Math.max(0,100-100*F[0]/I[0]);D._updateTitleBar(C.STATUS_UPLOADING,_,B,F[1],E);};this._mFileUploader.onSessionProgressComplete=function(A){if(disk.DEBUG){console.log("Session Complete "+D._mSessionFailureCount);}D._mSessionUploadSize=0;D._checkSessionComplete(true);D._notifySessionComplete();D.putSessionFailure(D._mSessionFailureCount);var _=(FileUtils.getModule()==FileUtils.MODULE_CATEGORY);if(D._mSessionFailureCount!=D._mInfiniteListView.getCount()&&D._mSessionCompleteCount>0){if(_){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.triggerType(FileUtils.getType());}else{if(D.inSpecialMode()){}else{}}}D._updateTitleBar(C.STATUS_COMPLETE,D._mSessionCompleteCount);Utilities.scheduleQueryQuota();D.preventPageChange(false);D.setMinimumProxyVisible(true);};if(this._mFileUploader instanceof disk.ui.HTML5FileUploader){this._mFileUploader.onDragAcrossBoundary=function(F,A){if(A){if(!D._mDndZoneMask){D._mDndZoneMask=document.createElement("div");D._mDndZoneMask.className="html5-dnd-zone";this._mMaskContainer.appendChild(D._mDndZoneMask);this.addDropTarget(D._mDndZoneMask);}D._mDndZoneMask.style.display="block";var H=$(this._mSurroundingView).offset(),E=this._mSurroundingView.offsetWidth,G=this._mSurroundingView.offsetHeight,B=C.DND_ZONE_EDGE_OFFSET_HOR+H.left,_=C.DND_ZONE_EDGE_OFFSET_VER+H.top;E-=C.DND_ZONE_EDGE_OFFSET_HOR*2;G-=C.DND_ZONE_EDGE_OFFSET_VER*2;$(D._mDndZoneMask).css({display:"block",left:B+"px",top:_+"px",width:E+"px",height:G+"px"});}else{D._mDndZoneMask.style.display="none";}return D._mDndZoneMask;};this._mFileUploader.onDrop=function(_){D._mDndZoneMask.style.display="none";D._mViewFlags|=C.START_TO_ULOADING;D.dispatchUpdateListView();if(disk.DEBUG){console.log("[LOG]Drop Files ",_);}};}this._mFileUploader.setAutoUploadEnabled(true);$("#uploadDialogUpload").addClass("disabled");};C.prototype._buildFolderReportPane=function(L,D){var P=this._mInfiniteListView.getRenderingChildByPosition(L);if(P!=null){var N=this._mErrorReportPane,M=this;if(N==null){N=document.createElement("div");this._mUI.pane.appendChild(N);N.className="upload-failure-report";this._mErrorReportPane=N;this._mReportTimer=new disk.util.TimerService(500,function(){M._mErrorReportPane.style.display="none";});N.onmouseover=function(_){if(M._mReportTimer&&M._mReportTimer.isAlive()){M._mReportTimer.interrupt();}};var E=function(_){if(M._mReportTimer){M._mReportTimer.start();}};N.onmouseout=E;D.onmouseout=E;}if(this._mReportTimer&&this._mReportTimer.isAlive()){this._mReportTimer.interrupt();}if(L!=this._mLastErrorReportPos){if(disk.DEBUG){console.warn("build error report panel at ",L);}var G=[];G.push('<span class="upload-fr-arw"></span>');var S=this._mFileUploader.getFileQueue()[L][disk.ui.NativePluginFileUploader.KEY_PATH],_=this._mFileUploader.getErrorDetail(S);if(_==null||_.length==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u65e0\u6cd5\u83b7\u5f97\u9519\u8bef\u4fe1\u606f",sticky:false});return;}var A=_.length,J=null,B=null,T=null;G.push('<ul class="row-lst'+(A>9?" row-lst-scrollable":"")+'">');for(var O=0;O<A;O++){B=_[O];if(O==0){J=" first";}else{if(O==A-1){J=" last";}else{J="";}}T=FileUtils.parseDirFromPath(B.filename);G.push('<li class="row clearfix'+J+'">'+'<div class="cn1 b-fl" title="'+T+'"><span class="ellipsis ellip-col ellip-col1">'+T+"</span></div>"+'<div class="cn2 b-fl">'+FileUtils.toFriendlyFileSize(parseInt(B.file_size))+"</div>"+'<div class="cn3 b-fl"><span class="ellipsis ellip-col ellip-col2">'+(disk.ui.FileUploader.errorMap[B.errno]||"\u7f51\u7edc\u9519\u8bef")+"</span></div></li>");}G.push("</ul>");N.innerHTML=G.join("");}N.style.display="block";var I=$(this._mUI.pane).offset(),R=$(P).offset(),K=R.top-I.top,C=this._mUI.pane.offsetHeight,F=N.offsetHeight,H=P.offsetHeight,Q=5;if(K+H+F<=C){N.style.top=K+H-Q+"px";N.className="upload-failure-report";}else{N.style.top=Q+K-F+"px";N.className="upload-failure-report upload-failure-report-btt";}this._mLastErrorReportPos=L;}};C.prototype._parseServerFile=function(_){var C=null;if(!_){C=FileUtils.getDirMgr().getDir();}else{var B=_[A.KEY_SERVER_MAPPED_PATH];if(typeof B=="undefined"){if(disk.DEBUG){console.error("Could Not Found A Mapped Server Path for file "+_.name);}C=FileUtils.getDirMgr().getDir();}else{C=B;}}return C;};C.prototype.inSpecialMode=function(){return!Page.inViewMode(Page.VIEW_HOME)||(FileUtils.getModule()==FileUtils.MODULE_CATEGORY)||FileUtils.inSearchMode();};C.prototype.checkInFile=function(E,B,_){var F=this,D=this._parseServerFile(B);FileUtils.sendCreateNewFileMessage(D+"/"+B.name,B.size,0,E,function(H){try{var G=$.parseJSON(H);if(G.errno==0){var E=FileUtils.parseDirFromPath(G.path);if(disk.DEBUG){console.log("[LOG]the newly uploaded file is ",E);}F._mPendingHighlightFiles.length=0;F._mPendingHighlightFiles.push(D+"/"+E);if(F._mPendingHighlightFiles.length>0){FileUtils.pendingHighlights(F._mPendingHighlightFiles);}var J=B[A.KEY_SERVER_MAPPED_PATH],I=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE;if(!F.inSpecialMode()&&J==FileUtils.getDirMgr().getDir()){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.issueProxyLoading(true,true);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());}_.call(F,G.errno==0?C.SUCCESS:C.FAILURE);}else{_.call(F,C.FAILURE);}}catch(K){_.call(F,C.FAILURE);}});};C.prototype.setGravity=function(A){var B=disk.ui.Panel.prototype.setGravity;if(A==disk.ui.Panel.CENTER){var _=($(window).height()-this._mUI.pane.offsetHeight)/2+$(window).scrollTop();_=Math.max(0,_-20);this.setLocation(($(window).width()-this._mUI.pane.offsetWidth)/2,_);}else{B.call(this,A);}};C.prototype.dispatchCheckInFile=function(E,_,I){this._mViewFlags|=C.UPLOAD_SOMETHING;if(disk.DEBUG){console.log("[LOG]Upload success",E,_);}var F=null,D=0,H=this;try{var B=$.parseJSON(_);F=B.md5;D=B.error||B.Error;}catch(G){}this.pcsSpeedReport(E.size,D);if(_.trim().length==0||F==null){FileUtils._mDiskLog.send({type:"S3ServiceUploadFailure",md5:F});this.onSetFileStatus(E,A.ERROR);if(typeof I=="function"){I.call(H,C.FAILURE);}this.dispatchUpdateListView();this._mFileUploader.autoUpload();}else{if(disk.DEBUG){console.log(">>>>>>>>after upload received md5 ",F,"<DataStream>",_);}if(H._mCheckInTimer.isAlive()){if(disk.DEBUG){console.log("[ELOG]jeez, it should not happen(abrupt check in process)");}H._mCheckInTimer.interrupt();}H._mCheckInTimer.setActionListener(function(){H.checkInFile(F,E,function(_){H._mFileUploader.onSetFileStatus(E,_!=C.SUCCESS?A.ERROR:A.COMPLETE);if(typeof I=="function"){I.call(H,_);}H.dispatchUpdateListView();H._mFileUploader.autoUpload();});});H._mCheckInTimer.start();}};C.prototype.dispatchUpdateProgressbar=function(G,_,J,I,D,C){var E=null,B=0,K=false,H=this._mInfiniteListView;if(H.hitInVisibleRegion(_)){E=H.getRenderingChildByPosition(_);if(E!=null){K=true;this._setRowStatus(A.UPLOADING,E,null,(J*100).toFixed(0),C,G.progress||0,G.uploadStyle);}}if(!K){var F=Math.min(_+1,H.getCount());H.scrollToPosition(F);}};C.prototype._resolveDirUploadStatus=function(E,L){var C=this._mActivePlugin,J=this,H=L.getElementsByTagName("span")[0],M=H.parentNode;if(C&&E.dir){var H=L.getElementsByTagName("span")[0],M=H.parentNode,F=M.childNodes,G=null,K=E[A.KEY_NAME],_=E.folderStatus==2;if(E.folderStatus==0){G=" (\u8bfb\u53d6"+E.fileCount+"\u4e2a\u6587\u4ef6...)";}else{if(E.folderStatus==1){if(typeof E.succCount=="undefined"){G="(0/"+E.fileCount+"\u4e2a\u6587\u4ef6)";}else{G="("+(E.succCount>0&&E.succCount<E.fileCount?E.succCount+"/":"")+E.fileCount+"\u4e2a\u6587\u4ef6)";}}else{G=(E.succCount>0?"("+E.succCount+"\u4e2a\u6587\u4ef6)":"");}}var I=M.getElementsByTagName("b"),B=null;if(I&&I.length>0){B=I[0];B.style.display="block";}else{B=document.createElement("b");B.className="input";M.insertBefore(B,F[0]);}M.replaceChild(document.createTextNode(K),F[2]);if(_){B.innerHTML=G+" <i>"+(E.fileCount-E.succCount)+"\u4e2a\u5931\u8d25</i>";var D=B.getElementsByTagName("i");if(D&&D[0].getAttribute("_installed")!="1"){D[0].onmouseover=function(){var _=parseInt(this.parentNode.getAttribute("_position"));J._buildFolderReportPane(_,this);};D[0].setAttribute("_installed","1");}B.setAttribute("_position",L.getAttribute("_position"));L.setAttribute("_fail",1);}else{B.innerHTML=G;}}else{I=M.getElementsByTagName("b"),B=null;if(I&&I.length>0){B=I[0];B.style.display="none";}}};C.prototype._dispatchUpdateSubstatus=function(E,_){var C=null,B=0,F=this._mInfiniteListView;if(!F.hitInVisibleRegion(_)){var D=Math.min(_+1,F.getCount());F.scrollToPosition(D);}C=F.getRenderingChildByPosition(_);if(C!=null){this._resolveDirUploadStatus(E,C);this._setRowStatus(A.UPLOADING,C,null,0,E[A.KEY_SPEED]||"0",E.progress||0,E.uploadStyle);}};C.prototype._checkSessionComplete=function(_){var B=this,A=disk.ui.UploadDialog.SCHEDULE_SESSION_COMPLETE;if((B._mViewFlags&A)==A){if(disk.DEBUG){console.warn("Catch Session Complete Schedule, report status now");}B._mViewFlags&=~A;if(_===true){}else{this._notifySessionComplete();}return true;}return false;};C.prototype._notifySessionComplete=function(){var _=this;if(_._mSessionFailureCount>0){_._mViewFlags|=disk.ui.UploadDialog.GENERAL_MESSAGE;_.dispatchUploadFailure(true,'\u6709<b class="red">'+_._mSessionFailureCount+"</b>\u4e2a\u6587\u4ef6\u4e0a\u4f20\u5931\u8d25",C.RETRY_BUTTON_FAILURE,_._mSessionFailureCount);}else{_.dispatchUploadFailure(false);}};C.prototype.dispatchUpdateListView=function(){var _=this._mFileUploader.getFileQueue();if(disk.DEBUG){console.log("child count ",_.length);}this._mInfiniteListView.updateBackedData(_);};C.prototype.dispatchRemoveRow=function(H){var _=H.parentNode.parentNode,D=parseInt(_.getAttribute("_position")),B=this._mActivePlugin,G=this._mFileUploader.getFileQueue(),C=G[D],E=this._mFileUploader;if(typeof C!="undefined"){var F=C[A.KEY_STATUS];if(F==A.UPLOADING||F==A.PENDING){this._mSessionUploadSize-=C[A.KEY_SIZE];}if(F==A.UPLOADING||F==A.PENDING||B){if(disk.DEBUG){console.log("[LOG]On remove uploading task for file ",C.name);}E.dispatchCancelUpload(C,D);}else{E.dispatchFileRemoved(C,D);}this.dispatchUploadFailure(false);}};C.prototype.getFileUploader=function(){return this._mFileUploader;};C.prototype._updateTitleBar=function(E,B,F,_,I){var H=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE,G=disk.ui.UploadDialog.UPLOAD_PROXY_TRANSITION,K=(this._mViewFlags&H)==H,D=(this._mViewFlags&G)==G,J=this._mInfiniteListView.getCount(),A=[];if(K&&D){I=0;}if(disk.DEBUG){console.warn("[TotalProgressAt]=====>",I,", ProxyVisibility ",K,"-",F);}if(E==C.STATUS_UPLOADING){A.push('<b class="upload-bar-info ellipsis" style="margin:0 0 0 '+(this._mActivePlugin?5:20)+'px">\u6b63\u5728\u4e0a\u4f20\uff1a'+(B+1)+"/"+J+"</b>");if(K){if(F&&!D){A.push('<b class="upload-bar-info ellipsis">\u901f\u5ea6\uff1a'+F+"</b>");}if(this._mHeadlineProgressHandler==null){this._mHeadlineProgressHandler=document.getElementById("uploadHeadlineProgress");}if(typeof I!="undefined"){if(isNaN(I)){I=0;}this._mHeadlineProgressHandler.style.width=I>=100?"0":I+"%";}}else{if(this._mHeadlineProgressHandler){this._mHeadlineProgressHandler.style.width="0";}}}else{if(E==C.STATUS_COMPLETE){A.push("\u4e0a\u4f20\u5b8c\u6210");if(this._mHeadlineProgressHandler){this._mHeadlineProgressHandler.style.width="0";}}else{A.push("\u4e0a\u4f20\u6587\u4ef6");if(this._mHeadlineProgressHandler){this._mHeadlineProgressHandler.style.width="0";}}}if(this._mHeadlineHandler==null){this._mHeadlineHandler=document.getElementById("uploadDialogHeadlineStrong");}this._mHeadlineHandler.innerHTML=A.join("");};C.prototype._build=function(){var G=disk.obtainId(),N=disk.obtainId(),L=disk.obtainId(),M=disk.obtainId(),_=disk.obtainId(),F=disk.obtainId(),H=this;disk.Context.requestFeature(disk.Context.FEATURE_STORAGE,{succ:function(){if(disk.api.RestAPI.ACTIVEX_NOTIFICATION){H._checkActivePlugin();}}});var E=['<dl id="'+F+'" class="infinite-listview"></dl>'];E.push('<div style="right: -1px" class="scrollbar" unselectable="on" id="'+G+'">');E.push('<div id="'+N+'" class="scrollbar-arrow scrollbar-arrow-up sprite" unselectable="on"></div>');E.push('<div style="height: 314px" class="scrollbar-tracker" unselectable="on" id="'+M+'">');E.push('<div class="scrollbar-thumb" unselectable="on" id="'+_+'"></div>');E.push("</div>");E.push('<div id="'+L+'" class="scrollbar-arrow scrollbar-arrow-down sprite" unselectable="on"></div>');E.push("</div>");this._mUI.listContainer.innerHTML=E.join("");var P=document.getElementById(G);this._mUI.listContainer.parentNode.appendChild(P);this._mInfiniteListView=new disk.ui.RecycleListView({listContainer:document.getElementById(F),tracker:document.getElementById(M),thumb:document.getElementById(_),upArrow:document.getElementById(N),downArrow:document.getElementById(L),scrollbar:P},{flags:disk.ui.RecycleListView.USING_MOUSE_WHEEL_SENSOR|disk.ui.RecycleListView.USING_SCROLLBAR|disk.ui.RecycleListView.USING_KEYBOARD_DISPATCHER});this._mInfiniteListView.getView=function(N,G,C){var _=G;if(_==null){_=this.buildView(N,G,C);}_.setAttribute("_position",C);var D="clearfix file-item upload-file-item";if(C==H._mLockIndex){D+=" flock";}_.className=D;var E=this._mElementsData[C],I=_.getElementsByTagName("span"),L=_.getElementsByTagName("em"),M=I[0].parentNode,F=E[A.KEY_NAME];H._resolveDirUploadStatus(E,_);if(E.dir){}else{M.replaceChild(document.createTextNode(F),M.lastChild);}M.setAttribute("title",E[A.KEY_NAME]);var J=L[0];J.innerHTML=E.dir?"-":FileUtils.toFriendlyFileSize(E[A.KEY_SIZE]);_.setAttribute("_dir",E.dir?"1":"0");FileUtils.resolveFileSmallIcon(E.dir||0,null,A.getFileExtension(E[A.KEY_NAME],true),$(I[0]));var O=_.getElementsByTagName("a"),P=O[1],B=O[2];if(!P.getAttribute("_installed")){P.onclick=function(){if(this.parentNode.parentNode.className.indexOf("flock")!=-1){return false;}var A=this.className.indexOf("status-btn-retry")!=-1;if(A){var _=this.parentNode.parentNode.getAttribute("_position");H.dispatchUploadFailureRetry(parseInt(_));}else{H.dispatchRemoveRow(this);}return false;};O[0].onclick=function(){if(this.parentNode.parentNode.className.indexOf("flock")!=-1){return false;}if(this.className.indexOf("disabled")==-1){H.dispatchOpenRowFile(this.parentNode.parentNode.getAttribute("_position"));}return false;};B.onclick=function(){if(this.parentNode.parentNode.className.indexOf("flock")!=-1){return false;}if(this.className.indexOf("disabled")==-1){H.dispatchMultiStateEvent(this.parentNode.parentNode.getAttribute("_position"));}return false;};P.setAttribute("_installed",1);}P.className="b-in-blk sprite-new status-btn status-btn-waiting";P.title="\u53d6\u6d88";var K=E[A.KEY_SERVER_MAPPED_PATH];if(typeof K=="undefined"){K="";}$(O[0]).text(K==""?"\u6211\u7684\u6587\u4ef6":E[A.KEY_SERVER_MAPPED_SIMPLE_PATH]);O[0].title=K==""?"\u6211\u7684\u6587\u4ef6":K;H._setRowStatus(E[A.KEY_STATUS],_,null,0,E[disk.ui.FileUploader.KEY_SPEED]||0,E.progress||0,E.uploadStyle);return _;};var B=document.getElementById("doc_main");if(B){B.onclick=function(){H.setMinimumProxyVisible(true);};}this._mInfiniteListView.buildView=function(C,D,A){var B=document.createElement("dd");B.className="clearfix file-item upload-file-item";var _=['<div class="inline-mask"></div><div class="b-fl overlay-col pf-c1 '+(H._mActivePlugin?"ellipsis-ex":"ellipsis")+'"><span class="b-in-blk sprite-ic b-ic-book idt-10"></span>FileName</div>'];_.push('<div class="b-fl overlay-col pf-c2 size-cell"><em>0.0K</em></div>');_.push('<div class="b-fl overlay-col pf-c5 ellipsis"><a hidefocus="true" class="b-no-ln" href="javascript:;" title="\u70b9\u51fb\u6253\u5f00\u76ee\u5f55">\u6211\u7684\u6587\u4ef6</a></div>');_.push('<div class="b-fl overlay-col pf-c3 clearfix"><dfn class="state-txt-btn sprite-new prog-v">0%&nbsp;(0kb/s)</dfn></div>');_.push('<div class="b-fl overlay-col pf-c4"><a hidefocus="true" class="b-in-blk sprite-new status-btn status-btn-waiting" href="javascript:;"></a><a hidefocus="true" class="b-in-blk sprite-new status-btn mf-state-btn" href="javascript:;"></a></div>');B.innerHTML=_.join("");return B;};this._mInfiniteListView.getIdForPosition=function(_){return this._mElementsData[_][A.KEY_NAME];};this._mInfiniteListView.lookupPositionForId=function(D){var B=this._mElementsData;for(var C=0,_=B.length;C<_;C++){if(B[C][A.KEY_NAME]==D){return C;}}return-1;};this._mInfiniteListView.onSystemNotify=function(A,D){if(A==disk.ui.RecycleListView.NOTIFY_LIST_REPAINT){var _=C.START_TO_ULOADING;if((H._mViewFlags&_)==_){var B=H._mFileUploader;if(B.isIdle()){if(disk.DEBUG){console.warn("[WARNING]repaint and be about to auto-upload");}H._resetSessionSettings();H.dispatchUploadFailure(false);B.autoUpload();H._mLogTimestamp=new Date().getTime();H._mLogTimestamp2=H._mLogTimestamp;}}H._mViewFlags&=~_;}};this._mInfiniteListView.setBackedData([]);this._mViewFlags|=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE;$("#uploadDialogCloseTop").click(function(){if(this.className.indexOf("disabled")!=-1){return false;}var _=H._mFileUploader;if(!_.isIdle()||_.inSessionProgress()||H.hasPauseTask()){H.cancelingAllTasks();}else{H.setVisible(false);}return false;});$("#uploadDialogCloseMinimumTop").click(function(){var A=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE,_=(H._mViewFlags&A)==A;H.setMinimumProxyVisible(!_);return false;});$("#uploadDialogHeadline").click(function(A){var _=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE;H.setMinimumProxyVisible((H._mViewFlags&_)!=_);return false;});if(this._mActivePlugin){var D=document.getElementById("barCmdUpload");if(D&&this._mFileUploader.hasFeature(disk.ui.NativePluginFileUploader.FEATURE_FOLDER_UPLOAD)){var J=D.parentNode,O=document.createElement("ul");O.className="pull-down-menu upload-methods";$(D).addClass("ex-dd-menu");$("b",D).text("\u4e0a\u4f20");var K=document.createElement("dfn");D.appendChild(K);K.innerHTML='<strong class="sprite-ic"></strong>';var I=[];I.push('<li><a action="0" href="javascript:;">\u4e0a\u4f20\u6587\u4ef6</a></li>');I.push('<li><a action="1" href="javascript:;">\u4e0a\u4f20\u6587\u4ef6\u5939</a></li>');J.appendChild(O);J.className+=" b-rlv haspulldown";O.innerHTML=I.join("");$(J).hover(function(){$(this).addClass("b-img-over");},function(){$(this).removeClass("b-img-over");});O.onclick=function(C){var B=disk.util.HistoryManager.interpretCurrentWindow(true);if(Object.prototype.toString.call(B)=="[object Array]"&&B[1]!="undefined"&&B[1].type=="2"){FileUtils._mDiskLog.send({type:"click_upload_button_on_timeline"});}var A=window.event||C,_=A.target||A.srcElement;if(_.nodeName=="A"){H._mFileUploader.dispatchChoosingFiles(_.getAttribute("action")=="1");}if(typeof A.preventDefault!="undefined"){A.preventDefault();A.stopPropagation();}else{A.cancelBubble=true;A.returnValue=false;}$(J).removeClass("b-img-over");return false;};}}};C.prototype._setRowStatus=function(R,Y,L,P,_,S,K){var X=Y.getElementsByTagName("a"),U=Y.getElementsByTagName("dfn")[0],M=Y.getElementsByTagName("div")[0],H=true,F=false,N=this._mActivePlugin;U.className="prog-v";X[1].style.display="block";M.style.width="0";var Q=Y.getAttribute("_fail");Y.setAttribute("_fail",0);var W=Q=="1",B=(Y.getAttribute("_dir")==="1");if(R==A.UPLOADING){$(L).css("display","");$(U).html(P==100?"\u8bf7\u7a0d\u5019&hellip;":P+"%("+_+")");M.style.width=P+"%";if(N){var V=null,C=parseInt(Y.getAttribute("_position")),E=this._mFileUploader,D=E.getFileQueue()[C],O=E.getFileSubstatus(D);if(O==-998){V="\u7f51\u7edc\u9519\u8bef";}else{if(O==-990){V="\u51c6\u5907\u4e0a\u4f20&hellip;";}else{if(O==-991){V=B?"\u8bfb\u53d6\u6587\u4ef6&hellip;":"\u6bd4\u5bf9\u6587\u4ef6&hellip;";}}}var T=Math.max(P,(S*100).toFixed(0));M.style.width=T+"%";if(V!=null){$(U).html(V);}else{$(U).html(T+"%("+_+")");}if(X){X[2].style.display="block";X[2].className="b-in-blk sprite-new status-btn mf-state-btn status-btn-pause";X[2].title="\u6682\u505c\u4e0a\u4f20";}}}else{$(U).addClass((R==A.PENDING||R==A.COMPLETE)?"clr-theme":"");var V=null,C=parseInt(Y.getAttribute("_position")),E=this._mFileUploader,D=E.getFileQueue()[C],O=E.getFileSubstatus(D),J=false,G=false,I=false;if(R==A.PENDING){V="\u6392\u961f\u4e2d&hellip;";}else{if(R==A.INCOMPLETE||R==A.ERROR){V="\u4e0a\u4f20\u5931\u8d25";J=true;}else{if(R==A.COMPLETE){V=K=="1"?"<i>\u6781\u901f\u79d2\u4f20</i>":"\u4e0a\u4f20\u5b8c\u6210";H=false;}else{if(R==A.ABORT){V="\u5df2\u53d6\u6d88";J=true;F=true;G=true;}else{if(R==A.PAUSE){V="\u5df2\u6682\u505c";H=false;J=true;F=true;}else{V="\u4e0a\u4f20\u5931\u8d25";J=true;}}}}}if(O!=null){if(O==-110){V="\u8d85\u8fc71G\u9650\u5236";}else{if(O==-1005){V="\u8d85\u8fc74G\u9650\u5236",I=true;}else{if(O==-999){V="\u5269\u4f59\u7a7a\u95f4\u4e0d\u8db3",I=!B;}else{if(O==-120){V="\u6587\u4ef6\u5927\u5c0f\u4e3a\u7a7a";}else{if(O==-998){V="\u7f51\u7edc\u9519\u8bef";}else{if(O==-990){V="\u51c6\u5907\u4e0a\u4f20&hellip;";}else{if(O==-991){V=B?"\u8bfb\u53d6\u6587\u4ef6&hellip;":"\u6bd4\u5bf9\u6587\u4ef6&hellip;";}else{if(O==-1002){V="\u6587\u4ef6\u4e0d\u5b58\u5728",I=true;}else{if(O==-1003){V="\u6587\u4ef6\u4e0d\u5408\u6cd5",I=true;}else{if(O==-1013){V="\u8d85\u8fc71000\u4e2a\u6587\u4ef6";}else{if(O==-1009){V="\u4efb\u52a1\u5df2\u5b58\u5728",I=true;}else{if(O==-9999){V="\u7f51\u7edc\u65ad\u5f00";}}}}}}}}}}}}if(typeof disk.ui.FileUploader.errorMap[O]!="undefined"){V=disk.ui.FileUploader.errorMap[O];}if(O==-1015){I=true;}if(!$(Y).hasClass("status-row-cau")&&R>A.PAUSE&&!B){$(Y).addClass("status-row-cau");}U.className+=" clr-ction";if(!N){J=false;}}$(U).html(V);if(J){M.style.width="0";if(G){X[1].style.display="none";}if(!F){U.className+=" sprite-new state-txt-btn";}if(X!=null){if(N){if(R==A.PAUSE){X[2].style.display="block";X[2].className="b-in-blk sprite-new status-btn mf-state-btn status-btn-rsm";X[2].title="\u6062\u590d\u4e0a\u4f20";T=Math.max(P,(S*100).toFixed(0));M.style.width=T+"%";}else{U.className=W?"prog-v clr-ction sprite-new state-txt-btn state-txt-btn-complete":"prog-v clr-ction";X[2].style.display=I?"none":"block";X[2].className="b-in-blk sprite-new status-btn mf-state-btn status-btn-rst";X[2].title="\u91cd\u65b0\u4e0a\u4f20"+(B?"\u5931\u8d25\u6587\u4ef6":"");}X[1].style.display=(I||G)?"none":"block";X[1].className="b-in-blk sprite-new status-btn status-btn-waiting";X[1].title="\u53d6\u6d88";}else{X[1].style.display="none";}}}else{if(!H){U.className+=" sprite-new state-txt-btn state-txt-btn-complete"+(K=="1"?" state-txt-btn-complete-hit":"");X[1].style.display="none";M.style.width="0";}if(N){if(R==A.PENDING){X[2].style.display="block";X[2].className="b-in-blk sprite-new status-btn mf-state-btn status-btn-pause";X[2].title="\u6682\u505c\u4e0a\u4f20";}else{X[2].style.display="none";}}}if(X){X[0].className="b-no-ln";}}};C.prototype.dispatchMessageReceived=function(_){return;this._ensureMessageHandler();if(!$(this._mErrMsgHandler).hasClass("red")){$(this._mErrMsgHandler).addClass("red");}this._mErrMsgHandler.innerHTML=_==null?"":_;};C.prototype.getRemainingTime=function(C,G){var F=this._mFileUploader,E=F.getFileQueue(),J=E.length,I=0,_=null,H=null;for(var B=G;B<J;B++){_=E[B];H=_[A.KEY_STATUS];if(H==A.PENDING){I+=_[A.KEY_SIZE];}else{if(H==A.UPLOADING){I+=(_[A.KEY_SIZE]-_[A.KEY_SIZE_UPLOADED]);}}}var D=A.toFriendlyTiming(C,I);return D;};C.prototype._ensureMessageHandler=function(){if(this._mErrMsgHandler==null){var A=$("#uploadDialogHeadline")[0],_=document.createElement("span");_.className="red";_.style.padding="1px 0 0 10px";A.appendChild(_);this._mErrMsgHandler=_;}};C.prototype.dispatchUploadFailure=function(G,E,_,J){var Q=disk.ui.UploadDialog.EXCEPTION_MSG_BUILD,S=disk.ui.UploadDialog.EXCEPTION_MSG_VISIBLE,O=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE,B=disk.ui.UploadDialog.UPLOAD_PROXY_TRANSITION,P=disk.ui.UploadDialog.SHOW_BULK_FILE_CAUTION,A=(this._mViewFlags&S)==S,K=(this._mViewFlags&Q)==Q,F=(this._mViewFlags&O)==O,D=(this._mViewFlags&B)==B,N=(this._mViewFlags&P)==P,I=this;if(!K){this._mExceptionMsgContainerDom=document.getElementById("uploadExceptionMsgContainer");this._mExceptionRetryTrigger=document.getElementById("uploadExceptionRetry");this._mExceptionMsgDom=document.getElementById("uploadExceptionMsg");$(this._mExceptionRetryTrigger).click(function(){var _=parseInt(this.getAttribute("_type"));if(_==C.RETRY_BUTTON_FAILURE){I.dispatchUploadFailure(false);I.setMinimumProxyVisible(false);I.dispatchUploadFailureRetry();}else{if(_==C.RETRY_BUTTON_RESTORE){I._mViewFlags|=disk.ui.UploadDialog.START_TO_ULOADING;var A=disk.ui.UploadDialog.UPLOAD_PROXY_VISIBLE;if((I._mViewFlags&A)==A){I.setMinimumProxyVisible(false);}I.dispatchUpdateListView();}}});this._mViewFlags|=Q;}if(E){$(this._mExceptionMsgDom).html('<dfn class="b-in-blk ic-upload-caution"></dfn>'+E);}if(this._mActivePlugin){var H=this._mExceptionRetryTrigger.getElementsByTagName("em")[0];H.style.display=(typeof _=="number")?"block":"none";var L=(_==C.RETRY_BUTTON_FAILURE)?"\u91cd\u65b0\u4e0a\u4f20":"\u5168\u90e8\u91cd\u4f20";if(typeof J=="number"&&J>0){J=J>100?"100+":J;L+="("+J+")";}H.innerHTML=L;H.parentNode.parentNode.setAttribute("_type",_);}else{var M=disk.ui.UploadDialog.INSTALL_HINT_BUILD,R=disk.ui.UploadDialog.GENERAL_MESSAGE;if((this._mViewFlags&M)==M&&(this._mViewFlags&R)!=R&&!G){if(disk.DEBUG){console.log("reject shutdown activex hint");}return;}}if(A==G&&!N){return;}if(N){this._mViewFlags&=~disk.ui.UploadDialog.SHOW_BULK_FILE_CAUTION;}if(G){$(this._mExceptionMsgContainerDom).animate({top:0},function(){I._mViewFlags|=S;});if(F&&!D){this.setMinimumProxyVisible(true,null,true);}}else{if(K){this._mExceptionMsgContainerDom.style.top=-this._mExceptionMsgContainerDom.offsetHeight+"px";this._mViewFlags&=~S;}}};C.prototype.dispatchUploadFailureRetry=function(E){var D=this._mDialogSessionFailureInfo,F=4;if(D.length>F){var H=null,_=D.length,G=true;for(var B=_-1;B>=_-F;B--){if(D[B]==0){G=false;break;}if(H==null){H=D[B];continue;}G=G&&(H==D[B]);}if(G){this._mDialogSessionFailureInfo.length=0;if(disk.DEBUG){console.log("[ERROR]Bad Network Connection or Server Exception");}var A=disk.Context.getService(disk.Context.SERVICE_DIALOG),I=this;A.setMessage("\u91cd\u4f20\u9891\u7e41\u5931\u8d25","\u670d\u52a1\u5668\u6216\u7f51\u7edc\u8fde\u63a5\u5f02\u5e38\uff0c\u8bf7\u7a0d\u5019\u5237\u65b0\u9875\u9762\u91cd\u8bd5",function(){A.setVisible(false);location.reload();},function(){A.setVisible(false);});A.setVisible(true);return;}}if(disk.DEBUG){console.log("UploadFailure Retry "+E);}if(this._mFileUploader.inSessionProgress()){if(disk.DEBUG){console.warn("Catch An In-Session Upload request");}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6709\u6587\u4ef6\u6b63\u5728\u4e0a\u4f20\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});return;}if(typeof E=="undefined"){this._mFileUploader.resetFileStatusAll();this._mViewFlags|=C.START_TO_ULOADING;this.dispatchUpdateListView();}else{this._mSessionFailureCount=Math.max(0,this._mSessionFailureCount-1);this._mFileUploader.resetFileStatus(E,E+1);this._mViewFlags|=disk.ui.UploadDialog.SCHEDULE_SESSION_COMPLETE;this._mFileUploader.upload(E);}};C.prototype.dispatchOpenRowFile=function(C){if(disk.DEBUG){console.log("Open File At Row "+C);}var B=this._mInfiniteListView.getBackedData();if(B){var _=B[C];if(typeof _!="undefined"){var E=_[A.KEY_SERVER_MAPPED_PATH];if(typeof E!="undefined"){if(!Page.inViewMode(Page.VIEW_HOME)){location.href="/disk/home";return;}this._mPendingHighlightFiles.length=0;this._mPendingHighlightFiles.push(E+"/"+_[A.KEY_NAME]);if(this._mPendingHighlightFiles.length>0){FileUtils.pendingHighlights(this._mPendingHighlightFiles);}FileUtils.issueProxyLoading(true,true);FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();if(!this.inSpecialMode()&&E==FileUtils.getDirMgr().getDir()){FileUtils.loadDir(FileUtils.resolveCurrentDirKey());}else{var D=FileUtils.historyNavigate(E==disk.util.DirectoryLocation.DIR_ROOT?{}:{path:E});if(disk.DEBUG){console.log("==Navigated ",D);}}this.setMinimumProxyVisible(true);}}}};C.prototype.dispatchMultiStateEvent=function(A){A=parseInt(A);if(disk.DEBUG){console.log("function state changed at ",A);}var C=this._mFileUploader.getFileQueue(),_=C[A],B=this._mFileUploader.getFileStatus(_);if(B==disk.ui.FileUploader.UPLOADING||B==disk.ui.FileUploader.PENDING){if(disk.DEBUG){console.log("pause at ",A);}this._mFileUploader.dispatchProgressPauseEvent(_,A);}else{if(B==disk.ui.FileUploader.PAUSE){this._mFileUploader.dispatchProgressResumeEvent(_,A,0);if(disk.DEBUG){console.log("resume at ",A);}}else{if(disk.DEBUG){console.log("start over at ",A);}this._mFileUploader.dispatchProgressResumeEvent(_,A,0,true);}}};C.prototype.dispatchLoadingEvent=function(_){return;this._ensureMessageHandler();if($(this._mErrMsgHandler).hasClass("red")){$(this._mErrMsgHandler).removeClass("red");}this._mErrMsgHandler.innerHTML=_?"\u6b63\u5728\u521d\u59cb\u5316\u4e0a\u4f20\u7ec4\u4ef6, \u8bf7\u7a0d\u5019&hellip;":"";};C.prototype._resolveServerUrl=function(){this._mFileUploader.setURL(this._mHTML5Plugin?disk.api.RestAPI.UPLOAD_ROUTE+"&BDUSS="+FileUtils.cktoken:disk.api.RestAPI.UPLOAD+"&BDUSS="+FileUtils.cktoken);this._mFileUploader.dispatchAcceptingEvent();return;};C.prototype.cancelingAllTasks=function(){var _=disk.Context.getService(disk.Context.SERVICE_DIALOG),A=this;_.setMessage("\u653e\u5f03\u4e0a\u4f20","\u5217\u8868\u4e2d\u6709\u672a\u4e0a\u4f20\u5b8c\u6210\u7684\u6587\u4ef6\uff0c\u786e\u5b9a\u8981\u653e\u5f03\u4e0a\u4f20\u5417\uff1f",function(){var B=A._mFileUploader;if(!B.isIdle()||B.inSessionProgress()){B.dispatchRemoveAllFile();}A._updateTitleBar(C.STATUS_PENDING);_.setVisible(false);A.setVisible(false);if(A._mActivePlugin&&!A.inSpecialMode()){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.issueProxyLoading(true,true);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());Utilities.scheduleQueryQuota();}A.preventPageChange(false);},function(){_.setVisible(false);});_.setVisible(true);};C.prototype.syncCloudPath=function(A,_){if(this._mActivePlugin){this._mFileUploader.setCloudPath(A,_);}};C.prototype._confirmClosing=function(){var A=this,_=A._mFileUploader;if(!_.isIdle()||_.inSessionProgress()){this.cancelingAllTasks();}else{this.setVisible(false);}};C.prototype.putSessionFailure=function(_){if(this._mDialogSessionFailureInfo.length>10){this._mDialogSessionFailureInfo.shift();}this._mDialogSessionFailureInfo.push(_);};C.prototype._resetSessionSettings=function(){this._mSessionFailureCount=0;this._mSessionCompleteCount=0;};C.prototype.preventPageChange=function(_){if(disk.DEBUG){console.log("[LOG]prevent unloading page =",_,"old prevent is ",C.PREVENT_UNLOADPAGE);}if(C.PREVENT_UNLOADPAGE===_){return;}C.PREVENT_UNLOADPAGE=_;if(_){window.onbeforeunload=function(_){if(C.PREVENT_UNLOADPAGE===true){return"\u60a8\u6253\u5f00\u4e86\u4e0a\u4f20\u7a97\u53e3\uff0c\u7ee7\u7eed\u64cd\u4f5c\u4f1a\u4e2d\u65ad\u4e0a\u4f20\uff0c\u8981\u7ee7\u7eed\u5417?";}};}else{window.onbeforeunload=null;}};C.prototype._resetDialogSessionSettings=function(){this._resetSessionSettings();this._mDialogSessionFailureInfo.length=0;};C.prototype.install=function(){var B=disk.ui.UploadDialog.VIEW_INIT,A=(this._mViewFlags&B)==B,_=disk.ui.UploadDialog.SERVER_URL_RESOLVE,C=(this._mViewFlags&_)==_;this._mWindowTitle=document.title;if(!A){this._prebuild();this._mViewFlags|=B;}if(!C){this._resolveServerUrl();}};C.prototype.onVisibilityChange=function(_){var A=this;if(_){if(document.title.indexOf("#")==-1){this._mWindowTitle=document.title;}FileUtils._mDiskLog.send({type:"upload_window_show"});this._setTitle();FileUtils.hideLoadingToast(true);}else{this._mWindowTitle=null;disk.Context.getService(disk.Context.SERVICE_CANVAS).setOnBlurCallback(null);this._mFileUploader.dispatchRemoveAllFile();this._resetDialogSessionSettings();this.dispatchUploadFailure(false);FileUtils.hideLoadingToast(false);this._mLastErrorReportPos=-1;}};C.prototype.isProxyVisible=function(){return(this._mViewFlags&C.UPLOAD_PROXY_VISIBLE)==C.UPLOAD_PROXY_VISIBLE;};C.prototype.setMinimumProxyVisible=function(F,A,E){if((this._mViewFlags&C.UPLOAD_PROXY_TRANSITION)==C.UPLOAD_PROXY_TRANSITION){return;}var _=(this._mViewFlags&C.UPLOAD_PROXY_VISIBLE)==C.UPLOAD_PROXY_VISIBLE;if(E!==true&&F===_){return;}var D=this._mMinProxyHandler,B=300,G=this;if(D==null){D=document.getElementById("uploadDialogBody");this._mListContainerHeight=document.getElementById("uploadFileListContainer").offsetHeight;this._mListColgroupHeight=document.getElementById("uploadDialogColgroup").offsetHeight;this._mMinProxyHeight=this._mListColgroupHeight+this._mListContainerHeight;this._mMinProxyHandler=D;}this._mViewFlags|=C.UPLOAD_PROXY_TRANSITION;if(F){$(D).animate({height:E===true?this._mListColgroupHeight:0},B,function(){G._mViewFlags&=~C.UPLOAD_PROXY_TRANSITION;G._mViewFlags|=C.UPLOAD_PROXY_VISIBLE;if(typeof A=="function"){A.call(G,true);}G.dispatchMinimumProxyVisibilityChange(true);});}else{$(D).animate({height:this._mMinProxyHeight},B,function(){if(G._mHeadlineProgressHandler){G._mHeadlineProgressHandler.style.width="0";}G._mViewFlags&=~C.UPLOAD_PROXY_TRANSITION;G._mViewFlags&=~C.UPLOAD_PROXY_VISIBLE;if(typeof A=="function"){A.call(G,true);}G.dispatchMinimumProxyVisibilityChange(false);});}};C.prototype.dispatchMinimumProxyVisibilityChange=function(A){if(!this._mActivePlugin&&!A){if(disk.api.RestAPI.ACTIVEX_NOTIFICATION&&(this._mViewFlags&disk.ui.UploadDialog.INSTALL_HINT_BUILD)!=disk.ui.UploadDialog.INSTALL_HINT_BUILD&&disk.ui.NativePluginFileUploader.isPlatformCompatible()){this._mViewFlags|=disk.ui.UploadDialog.INSTALL_HINT_BUILD;if(disk.DEBUG){console.log("complaining on user not install active plugin");}var _=disk.util.MessageFormatter.sprintf(this._mLastFileSize>10*1024*1024?disk.ui.UploadDialog.INSTALL_TEXT_2:disk.ui.UploadDialog.INSTALL_TEXT,this._mTipVersion);this.dispatchUploadFailure(true,_);this._mViewFlags|=disk.ui.UploadDialog.SHOW_BULK_FILE_CAUTION;}}if(A){$(this._mUI.pane).addClass("dlg-sys-win-min");$("#uploadDialogCloseMinimumTop").attr("title","\u6700\u5927\u5316");FileUtils.hideLoadingToast(false);}else{$(this._mUI.pane).removeClass("dlg-sys-win-min");$("#uploadDialogCloseMinimumTop").attr("title","\u6700\u5c0f\u5316");FileUtils.hideLoadingToast(true);}A=true;if(A&&!this._mFileUploader.inSessionProgress()){A=false;}this.preventPageChange(A);};C.prototype.setVisible=function(B){if(!B){var A=disk.ui.FolderBuilder.getDefault();if(A.isVisible()){A.dispatchNegativeAction();}}else{if(this._mLastErrorMsg!=null){var _=disk.Context.getService(disk.Context.SERVICE_DIALOG),D=this;_.setMessage("\u4e0a\u4f20\u6587\u4ef6",this._mLastErrorMsg,function(){_.setVisible(false);},function(){_.setVisible(false);});_.setVisible(true);return;}}if((this._mViewFlags&C.HAS_BUILD)!=C.HAS_BUILD){disk.ui.Panel.prototype.setVisible.call(this,B);this._mViewFlags|=C.HAS_BUILD;if(disk.DEBUG){console.log("[LOG]use old approach",B);}}else{if(disk.DEBUG){console.log("[LOG]use another set visible approach",B);}if(B==this.isVisible()){return;}if(B){this._mPrivateFlags|=disk.ui.Panel.VISIBLE;this._mUI.pane.style.visibility="visible";}else{this._mPrivateFlags&=~disk.ui.Panel.VISIBLE;this._mUI.pane.style.visibility="hidden";}this.onVisibilityChange(B);}};C.prototype._setTitle=function(){var _=this;if(!this._mWindowSetIdle){return;}if(disk.DEBUG){console.log("[LOG]update title ",_._mWindowTitle);}setTimeout(function(){if(_._mWindowTitle!=null){document.title=_._mWindowTitle;_._mWindowSetIdle=true;}},500);this._mWindowSetIdle=false;};C.prototype._logUploadingState=function(B,_){var A=(new Date()).getTime(),C=A-this._mLogTimestamp;FileUtils._mDiskLog.send({type:"uploadfile",time:C,success:B,suffix:_});this._mLogTimestamp=A;};C.prototype.pcsSpeedReport=function(E,F,A){var C=(new Date()).getTime(),G=C-this._mLogTimestamp2,B=[];B.push("clienttype=0@#devuid=@#channel=chunlei@#version=");B.push("@#subject=speed");B.push("@#request_url=");B.push("PROTECTED");B.push("@#timestamp=");B.push(this._mLogTimestamp);B.push("@#process_time=");B.push(G);B.push("@#bytes_send=");B.push(E);B.push("@#bytes_recved=");B.push(E);B.push("@#status=");B.push(F==0?"200":"!200");B.push("@#error_code=");B.push(F);B.push("@#user_agent=");B.push(encodeURIComponent(navigator.userAgent));if(A){B.push("@#full_path=");B.push(encodeURIComponent(A));}B.push("@#upload_engine=");var _=this._mFileUploader,D=null;if(_ instanceof disk.ui.NativePluginFileUploader){D="activex";}else{if(_ instanceof disk.ui.HTML5FileUploader){D="html5";}else{D="flash";}}B.push(D);FileUtils._mDiskLog.send({type:"SpeedReport",content:encodeURIComponent(B.join(""))});this._mLogTimestamp2=C;if(disk.DEBUG){console.log("PCS speed report complete");}};disk.ui.UploadDialog=C;})();var Utilities={_mSortingColsHandler:null,_mSortingColsWakedup:null,_mTotalSpacing:null,_mUsedSpacing:null,_mInterval:6*60*60*1000,keyCode:function(A,_){A.keydown(function(B){var A=B?B:window.event;switch(A.keyCode){case 27:_[27]();break;case 40:_[40]();break;case 39:_[39]();break;case 38:_[38]();break;case 37:_[37]();break;case 34:_[34]();break;case 33:_[33]();break;case 13:_[13]();break;}});},mouseWheel:function(_,C,B){var A=function(A){var A=A||window.event||arguments[0],_=0;if(A.wheelDelta){_=-A.wheelDelta/120;}else{if(A.detail){_=A.detail/3;}}if(_){if("string"==typeof B||B instanceof String){C(_>0?true:false);}else{if("number"==typeof B||B instanceof Number){C(_*B);}}}if(A.preventDefault){A.preventDefault();}else{A.returnValue=false;}};if(typeof window.attachEvent!="undefined"){_.attachEvent("onmousewheel",A);}else{if("onmousewheel"in window){_.onmousewheel=A;}else{if(typeof window.addEventListener!="undefined"){_.addEventListener("DOMMouseScroll",A,false);}}}},resolveLayout:function(E){var _=$("#fileList"),F=$("#subwindowContainer").offset().top,B,C=document.body.className,D=$(window).height(),G=$(window).width();_.length&&(B=_.offset().top);var A=300;if(G<1024){$(".aside").css("width","175px");$(".b-uploader",".aside").css("left","7px");$(".b-list-3 a .text1").css("margin-left","26px");if(!Page.inViewMode(Page.VIEW_PROPERTY_OTHER)&&!Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){$("#subwindowContainer").css("margin-left","175px");}$("#upload-dialog-btn").css("padding-left","5px");$("#scrollbar,#scrollbarGrid").css({left:$(".doc:first").width()-16,right:"auto"});if(document.getElementsByTagName("iframe")){if($("iframe").css("margin-left")==0){$("iframe").css("margin-left","0px");}}$("#awardBubbleP").css("margin-left","12px");$(".side-options").css("margin-left","2px");$(".share-warn-tit").css("marginLeft","14px");}else{$(".aside").css("width","210px");$(".b-uploader",".aside").css("left","26px");$("#upload-dialog-btn").css("padding-left","25px");if(!Page.inViewMode(Page.VIEW_PROPERTY_OTHER)&&!Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){$("#subwindowContainer").css("margin-left","209px");}$("#scrollbar,#scrollbarGrid").css({left:"auto",right:"0px"});if(document.getElementsByTagName("iframe")){$("iframe").css("margin-left","0px");}$("#awardBubbleP").css("margin-left","28px");if($(".award-img-section")){$(".award-img-section").css("margin-left","15px");}$(".side-options").css("margin-left","18px");$(".share-warn-tit").css("marginLeft","44px");}asideMenuOffsetTop=F+($("#upload-dialog-btn").height()?$("#upload-dialog-btn").height():0);sideOptions=$(".side-options").height()+15;if(D>A){if($("#awardBubbleP:visible").length){$("#genere").height(D-asideMenuOffsetTop-10);}else{$("#genere").height(D-asideMenuOffsetTop);}if(E){$("#subwindowContainer").height(D-F-3);return;}_.height(D-B);$(".flag2-pan-right").height($("#subwindowContainer").height());$(".flag10-pan-right").height($("#subwindowContainer").height()-$(".homeheader").height());}else{$("#genere").height(D-asideMenuOffsetTop-10);if(E){$("#subwindowContainer").height(A-F-3);return;}_.height(A-B);}var K=26,H=0;if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){if($(".flag2-fns").length>0){H=$(".flag2-fns").offset().top;}}else{if($(".all-files-headers").length>0){H=$(".all-files-headers").offset().top;}}if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){$("#scrollbar").css("left",$("#sortColsHeader").offset().left+$("#sortColsHeader").width());}$("#scrollbar,#scrollbarGrid").css("top",H);$("#scrollbarTracker,#scrollbarTrackerGrid").css("height",D-H-K);if(disk.DEBUG){console.log("reset scrollBar css");}if($.browser.msie&&$.browser.version<7){$("#scrollbarArrowDown").css("position","static").css("position","absolute");}if($(".no-result-file-download").length){var I=$(".no-result-file-download"),J=_.height()-30;I.height(J);if($.browser.msie&&$.browser.version=="6.0"){if(I.width()<855){$(".no-result-file-bottom").width("auto");}else{$(".no-result-file-bottom").width(788);}}}if(Page.inViewMode(Page.VIEW_HOME)&&FileUtils.getModule()==="category"&&FileUtils.getType()===2){var L=$("#timeLineGuide");if(L.length>0){L.css("top",$(".all-files-headers").offset().top-L.height());}}},layoutSubwindow:function(A){var _=document.getElementById("subwindowContainer");A.style.width=$(_).width()+"px";A.style.height=$(_).height()+"px";A.style.top="0";A.style.left="0";A.style.position="absolute";A.style.background="#fff";_.appendChild(A);},updateUsageQuota:function(D,E,H,C){var F=document.getElementById("remainingSpaceUi_tail"),G=document.getElementById("remainingSpace"),A,_,B;A=Math.floor(Math.min(100,D)*155/100);if(F){F.style.width=A+"px";}if(G&&(typeof E!="undefined")){G.innerHTML=FileUtils.toFriendlyFileSize(H);}$(F).attr("title")&&$(F).removeAttr("title");$("#awardBubbleP ul li").first().addClass("hidden");if(FileUtils.quota.expire=="true"){$("#awardBubbleP ul li").first().removeClass("hidden");}if(D>=90&&E>=0){$(F).css("background","#FC7736");$(F).attr("title","\u4f60\u4f7f\u7528\u7684\u5bb9\u91cf\u5df2\u8d85\u8fc790%\u5566");}else{if(E<0){$(F).css("background","#c00");$("#awardBubbleP ul li").first().removeClass("hidden");$("#awardBubbleP span.pay-quota").html("\u4f60\u7684\u5bb9\u91cf\u5230\u671f\u4e86");$("#awardBubbleP a.pay-quota").html("\u8d2d\u4e70").attr("href","http://yun.baidu.com/buy/center?tag=2");}else{$(F).css("background","#3482DA");}}if(typeof C!="undefinded"&&C){$("#remainingSpace").siblings(":first").text("/"+FileUtils.toFriendlyFileSize(C));}},updateSpacing:function(_,A){this._mTotalSpacing=parseInt(_);this._mUsedSpacing=parseInt(A);},hasEnoughSpacing:function(A){var _=(typeof A=="number")?A:0;return _+this._mUsedSpacing<this._mTotalSpacing;},isOverdue:function(){var F=this;if($("#remainingSpaceUi_tail").length==0){return;}var _=FileUtils.quota,D=parseFloat(_.total)-parseFloat(_.used);F.updateSpacing(_.total,_.used);var B=parseFloat((_.used*100/_.total).toFixed(4)),C=parseFloat(_.total-_.used),E=parseFloat(_.used),A=parseFloat(_.total);Utilities.updateUsageQuota(B,C,E,A);if(_.expire=="true"){$("#awardBubbleP ul li").first().removeClass("hidden");}},isFullAward:function(){var _=15*1024*1024*1024;if(FileUtils.quota.free=="null"||parseFloat(FileUtils.quota.free)<_){$(".award-img-section").show();$("#awardBubbleP .b-no-ln").html("\u514d\u8d39\u6269\u5bb9").attr("href","http://yun.baidu.com/disk/award");}},updateQuotaExpireData:function(_){if(!_||!FileUtils||!FileUtils.quota){return;}if(typeof _.total!="undefined"){FileUtils.quota.total=_.total;}if(typeof _.used!="undefined"){FileUtils.quota.used=_.used;}if(typeof _.expire!="undefined"){FileUtils.quota.expire=""+_.expire;}if(typeof _.free!="undefined"){FileUtils.quota.free=_.free;}},scheduleQueryQuota:function(A,_,B){var C=this;param={};if(_){param.checkexpire=1;}if(B){param.checkfree=1;}$.get(disk.api.RestAPI.QUOTA+"&t="+(new Date().getTime()),param,function(E){if(disk.DEBUG){console.log("[LOG]got quota detail:"+E);}var _=null;try{_=$.parseJSON(E);}catch(G){}if(_!=null&&_.errno==0){C.updateSpacing(_.total,_.used);var D=(_.used*100/_.total).toFixed(4),F=_.total-_.used,H=_.used,B=_.total;Utilities.updateQuotaExpireData(_);Utilities.updateUsageQuota(D,F,H,B);if(typeof A==="function"){A(B,H);}}});},toDateString:function(C){if(!this._dateFormater){this._dateFormater=new Date();}this._dateFormater.setTime(C*1000);var _=this._dateFormater.getMonth()+1,D=this._dateFormater.getDate(),A=this._dateFormater.getHours(),B=this._dateFormater.getMinutes();return this._dateFormater.getFullYear()+"-"+(String(_).length<2?"0"+_:_)+"-"+(String(D).length<2?"0"+D:D)+" "+(String(A).length<2?"0"+A:A)+":"+(String(B).length<2?"0"+B:B);},dateDiff:function(B,A){var _=24*60*60*1000,C=B+_*10-parseInt(A);return Math.max((C/_).toFixed(0),0);},useToast:function(B){var E={toastMode:B.toastMode,msg:B.msg,sticky:B.sticky,positionRB:B.position,closeType:B.closeType},_=disk.Context.getService(disk.Context.SERVICE_TOAST);_.setVisible(true,E.sticky);_.setMessage(E.toastMode,E.msg);_.setClose(E.closeType);if(E.positionRB){if(E.positionRB==disk.ui.Panel.TOP){_.setGravity(disk.ui.Panel.TOP);}else{_.setPositionRB(0,0);}}else{if(disk.Context.getService(disk.Context.SERVICE_CANVAS).isVisible()){_.setGravity(disk.ui.Panel.CENTER);}else{try{if(!this._mFileListDOM){this._mFileListDOM=$("#fileList").length?$("#fileList"):$("body");}var G=this._mFileListDOM.offset(),D=(this._mFileListDOM.width()-_._mUI.pane.offsetWidth)/2+G.left,C=50,A=60;_.setLocation(D,A);}catch(F){}}}return _;},useCloseToast:function(){var _=disk.Context.getService(disk.Context.SERVICE_TOAST);_.setVisible(false);}},MoreOptionsDropDown=function(){disk.ui.Panel.call(this,this._prebuild());this._mMenuItems=null;this._mLastAttached=null;this._mLastAttachedData=null;this._mLastWrapper=null;this._mMenuContainer=null;};MoreOptionsDropDown.MENU_OPEN=0;MoreOptionsDropDown.MENU_DOWNLOAD=1;MoreOptionsDropDown.MENU_DEVICE=2;MoreOptionsDropDown.MENU_PRINT=3;MoreOptionsDropDown.MENU_SHARE=4;MoreOptionsDropDown.MENU_MOVE=5;MoreOptionsDropDown.MENU_COPY=6;MoreOptionsDropDown.MENU_RENAME=7;MoreOptionsDropDown.MENU_DELETE=8;MoreOptionsDropDown.MENU_EDIT_PIC=9;MoreOptionsDropDown.MENU_REVISION_LIST=10;MoreOptionsDropDown.MENU_SELL_FILE=11;MoreOptionsDropDown.MENU_SHOW_IN_FOLDER=12;MoreOptionsDropDown.MENU_CANCLE_SHARE=0;MoreOptionsDropDown.MENU_SHARE_LINK=0;MoreOptionsDropDown.MENU_CANCLE_PUBLIC=1;MoreOptionsDropDown.MENU_TRANSFER=2;MoreOptionsDropDown.MENU_RESTORE=0;MoreOptionsDropDown.MENU_PERSIST_REMOVE=1;MoreOptionsDropDown.singleton=null;MoreOptionsDropDown.obtain=function(){if(MoreOptionsDropDown.singleton==null){MoreOptionsDropDown.singleton=new MoreOptionsDropDown();MoreOptionsDropDown.singleton.init();}return MoreOptionsDropDown.singleton;};MoreOptionsDropDown.prototype=new disk.ui.Panel();MoreOptionsDropDown.prototype._prebuild=function(){var _=document.createElement("ul");_.className="b-panel b-options-dd-menu b-list-drop b-bdr-7 bdr-rnd-2 box-shadow3";_.id="right-context-menu";document.body.appendChild(_);return{pane:_};};MoreOptionsDropDown.prototype.installDeviceHanle=function(){$("#rightDeviceMenu").show();$("#rightDeviceMenu").mouseenter(function(A){var _=$(this).offset().left-$("#fileActionHeader").offset().left;if($(document).width()-_>480){_+=121;}else{_-=112;}if($("#netdiskTips:visible").length){$(".device-menu").css({left:_,top:$(this).offset().top-164}).show();}else{$(".device-menu").css({left:_,top:$(this).offset().top-129}).show();}Page.obtain().installDevice();}).mouseleave(function(){$(".device-menu").hide();});};MoreOptionsDropDown.prototype._useBTTMode=function(){if(this._mMenuContainer==null){this._mMenuContainer=document.getElementById("fileList");}var _=this._mLastAttached;if(_){var A=$(_).offset().top-$(this._mMenuContainer).offset().top+_.offsetHeight;if(A+this._mUI.pane.offsetHeight>this._mMenuContainer.offsetHeight){return true;}}return false;};MoreOptionsDropDown.prototype._useReverseYMode=function(_){if(this._mMenuContainer==null){this._mMenuContainer=document.getElementById("fileList");}var A=_-$(this._mMenuContainer).offset().top;if(A+$(this._mUI.pane).height()>$(this._mMenuContainer).height()){return true;}return false;};MoreOptionsDropDown.prototype._useReverseXMode=function(_){if(this._mMenuContainer==null){this._mMenuContainer=document.getElementById("fileList");}var A=_-$(this._mMenuContainer).offset().left;if(A+$(this._mUI.pane).width()>$(this._mMenuContainer).width()){return true;}return false;};MoreOptionsDropDown.prototype.attach=function(Q,B,L){var K=Q.childNodes[0].childNodes[0],F=Q.childNodes[0],I=Q,B=B,L=L;if(this._useReverseYMode(B)){B=B-$(this._mUI.pane).height();}if(this._useReverseXMode(L)){L=L-$(this._mUI.pane).width();}var P=this._mUI.pane;P.style.zIndex="20";$(P).css({position:"absolute",top:B,left:L});var X=I.getAttribute("_position");if(X!=null){var R=parseInt(X),Y=FileUtils.getElementData(R);if(typeof Y!="undefined"){var V=FileUtils.getModule()=="category",U=Y.property||-1,C=FileUtils.inSearchMode()||FileUtils.isListViewLocked(),O=FileUtils.ifSpecialFolder(FileUtils.parseDirPath(Y.path||Y.typicalPath)),M=FileUtils.isInParticularDir(FileUtils.parseDirPath(Y.path||Y.typicalPath)),J=FileUtils.isTopParticularDir(FileUtils.parseDirPath(Y.path||Y.typicalPath)),Z=Y.isdir!=1?false:true,D=FileUtils.isRevisionCheck(FileUtils.getListViewCheckedItems()),S=FileUtils._checkIsBuyFile(Y.path),W=FileUtils.getListViewCheckedItems();FileUtils.SELECT_PIC_NUM=0;var G=FileUtils.isAllPic(W[0].category);if(Page.inViewMode(Page.VIEW_HOME)){if(W.length>1){for(var H=0,_,A=W.length;H<A;H++){_=W[H];if(!U){U=_.property==0||_.property==2;}if(!O){O=FileUtils.ifSpecialFolder(FileUtils.parseDirPath(_.path));}if(!M){M=FileUtils.isInParticularDir(FileUtils.parseDirPath(_.path));}if(!J){J=FileUtils.isTopParticularDir(FileUtils.parseDirPath(_.path));}if(!S){S=FileUtils._checkIsBuyFile(_.path);}if(!Z){Z=_.isdir!=1?false:true;}if(G){G=FileUtils.isAllPic(_.category);}}}if(G){this.setItemDisplay(MoreOptionsDropDown.MENU_EDIT_PIC,true);var T=$(this._mMenuItems[MoreOptionsDropDown.MENU_EDIT_PIC]);if(G==1){T.text("\u7f8e\u5316");}else{T.text("\u62fc\u56fe");}}else{this.setItemDisplay(MoreOptionsDropDown.MENU_EDIT_PIC,false);}this.setItemDisplay(MoreOptionsDropDown.MENU_SELL_FILE,false);this.setItemEnabled(MoreOptionsDropDown.MENU_DOWNLOAD,!C);this.setItemEnabled(MoreOptionsDropDown.MENU_PRINT,(G?true:false));this.setItemEnabled(MoreOptionsDropDown.MENU_REVISION_LIST,(D?true:false));this.setItemEnabled(MoreOptionsDropDown.MENU_RENAME,!C&&U==-1&&!O&&!J);this.setItemDisplay(MoreOptionsDropDown.MENU_SELL_FILE,false);this.setItemEnabled(MoreOptionsDropDown.MENU_PUBLIC,!C);this.setItemEnabled(MoreOptionsDropDown.MENU_DELETE,!C&&!O&&!J);this.setItemEnabled(MoreOptionsDropDown.MENU_SHARE,!C);this.setItemEnabled(MoreOptionsDropDown.MENU_COPY,!C&&!O);this.setItemEnabled(MoreOptionsDropDown.MENU_MOVE,!C&&U==-1&&!O&&!J);this.setItemDisplay(MoreOptionsDropDown.MENU_SHOW_IN_FOLDER,W.length==1&&(FileUtils.inSearchMode()||V));if(FileUtils.inSearchMode()){this.setItemEnabled(MoreOptionsDropDown.MENU_DOWNLOAD,true);this.setItemEnabled(MoreOptionsDropDown.MENU_PUBLIC,true);this.setItemEnabled(MoreOptionsDropDown.MENU_SHARE,true);this.setItemEnabled(MoreOptionsDropDown.MENU_COPY,true);this.setItemEnabled(MoreOptionsDropDown.MENU_RENAME,U==-1&&!O&&!J);this.setItemEnabled(MoreOptionsDropDown.MENU_MOVE,U==-1&&!O&&!J);this.setItemEnabled(MoreOptionsDropDown.MENU_DELETE,!O&&!J);}if(!G){this.setItemDisplay(MoreOptionsDropDown.MENU_PRINT,false);}if(W.length>1){this.setItemDisplay(MoreOptionsDropDown.MENU_RENAME,false);this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,false);}else{if(W.length==1){this.setItemDisplay(MoreOptionsDropDown.MENU_RENAME,true);var E=W[0].path,N="";if(E){N=E.slice(E.lastIndexOf("."));}if(W[0].isdir||W[0].category==Category.Doc_oth||W[0].category==Category.PIC||W[0].category==Category.MUS||FileUtils.acceptOpenFileTypes(N)){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,true);}else{if(Page.inViewMode(Page.VIEW_HOME)&&W[0].category==Category.MOV){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,true);}else{this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,false);}}}}}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){if(FileUtils.sysISSELF){this.setItemDisplay(MoreOptionsDropDown.MENU_TRANSFER,false);}if(W.length>1){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,false);}else{if(W.length==1){if(W[0].isdir||W[0].category==Category.Doc_oth||W[0].category==Category.PIC||W[0].category==Category.MUS||W[0].category==Category.MOV){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,true);}else{if(Page.inViewMode(Page.VIEW_HOME)&&W[0].category==Category.MOV){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,true);}else{this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,false);}}}}}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){}}}if(FileUtils.inSearchMode()){this.setItemEnabled(MoreOptionsDropDown.MENU_DOWNLOAD,true);this.setItemDisplay(MoreOptionsDropDown.MENU_RENAME,true);this.setItemDisplay(MoreOptionsDropDown.MENU_PUBLIC,true);this.setItemDisplay(MoreOptionsDropDown.MENU_DELETE,true);this.setItemDisplay(MoreOptionsDropDown.MENU_SHARE,true);this.setItemDisplay(MoreOptionsDropDown.MENU_COPY,true);this.setItemDisplay(MoreOptionsDropDown.MENU_MOVE,true);if(W.length>1){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,false);}else{if(W.length==1){this.setItemDisplay(MoreOptionsDropDown.MENU_OPEN,true);}}}this._mLastAttached=Q;this._mLastAttachedData=Y;this._mLastWrapper=F;}else{this._mLastAttached=null;this._mLastAttachedData=null;this._mLastWrapper=null;}}return this;};MoreOptionsDropDown.prototype.init=function(){if(Page.inViewMode(Page.VIEW_HOME)){this._mUI.pane.innerHTML='<li><a _i="0" hideFocus="true" href="javascript:;">\u6253\u5f00</a></li><li><a _i="1" hideFocus="true" href="javascript:;">\u4e0b\u8f7d</a></li><li id="rightDeviceMenu"><a _i="2" hideFocus="true" href="javascript:;">\u63a8\u9001\u5230\u8bbe\u5907\u25b6</a></li><li><a _i="3" hideFocus="true" href="javascript:;">\u4e91\u51b2\u5370</a></li><li><a _i="4" hideFocus="true" href="javascript:;">\u5206\u4eab</a></li><li><a _i="5" _data="move" hideFocus="true" href="javascript:;">\u79fb\u52a8\u5230</a></li><li><a _i="6" _data="copy" hideFocus="true" href="javascript:;">\u590d\u5236\u5230</a></li><li><a _i="7" hideFocus="true" href="javascript:;">\u91cd\u547d\u540d</a></li><li><a _i="8" hideFocus="true" href="javascript:;">\u5220\u9664</a></li><li><a _i="9" hideFocus="true" href="javascript:;">\u7f8e\u5316</a></li><li><a _i="10" hideFocus="true" href="javascript:;">\u5386\u53f2\u7248\u672c</a></li><li><a _i="11" hideFocus="true" href="javascript:;">\u51fa\u552e</a></li><li class="menu-separator b-bdr-7"><a _i="12" hideFocus="true" href="javascript:;">\u67e5\u770b\u6587\u4ef6\u5939</a></li>';}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){this._mUI.pane.innerHTML='<li><a _i="0" hideFocus="true" href="javascript:;">\u53d6\u6d88\u5206\u4eab</a></li>';}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){this._mUI.pane.innerHTML='<li><a _i="0" hideFocus="true" href="javascript:;">\u6253\u5f00</a></li><li><a _i="1" hideFocus="true" href="javascript:;">\u4e0b\u8f7d</a></li><li><a _i="2" hideFocus="true" href="javascript:;">\u4fdd\u5b58</a></li>';}else{if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){this._mUI.pane.innerHTML='<li><a _i="0" hideFocus="true" href="javascript:;">\u8fd8\u539f</a></li><li><a _i="1" hideFocus="true" href="javascript:;">\u5f7b\u5e95\u5220\u9664</a></li>';}}}}var _=this;this._mMenuItems=this._mUI.pane.getElementsByTagName("a");_.installDeviceHanle();$(this._mUI.pane).mousedown(function(_){_.stopPropagation();});$(this._mUI.pane).click(function(F){var B=F.target,D=null;if(B.nodeName.toLowerCase()=="a"&&B.className.indexOf("disabled")==-1){var C=B.getAttribute("_i");if(C==null){throw new Error("Found Not Registered Menu Item");}C=parseInt(C);D=C;var E=_._mMenuItems[C];if(E){_.dispatchMenuItemClick(C,F);}if(_._mLastWrapper!=null){$(_._mLastWrapper).removeClass("dd-hover");}}else{return false;}$(B).parent().parent().hide();var A=FileUtils.getListViewCheckedItems();if(!(A.length==1&&!A[0].isdir&&D==MoreOptionsDropDown.MENU_DOWNLOAD)){if(F.preventDefault){F.preventDefault();}if(F.stopPropagation){F.stopPropagation();}}FileUtils._hideRightMouseMenu();});};MoreOptionsDropDown.prototype.dispatchMenuItemClick=function(B,C){if(!this._mLastAttachedData){return;}var _=FileUtils.getListViewCheckedItems();if(Page.inViewMode(Page.VIEW_HOME)){switch(B){case MoreOptionsDropDown.MENU_OPEN:FileUtils.anchorFoldOpen(C,FileUtils,this._mLastAttached);break;case MoreOptionsDropDown.MENU_DOWNLOAD:Page.obtain().performSelectionDownload();break;case MoreOptionsDropDown.MENU_PRINT:Page.obtain().performSelectPrint();break;case MoreOptionsDropDown.MENU_REVISION_LIST:Page.obtain().performRevisionList();break;case MoreOptionsDropDown.MENU_RENAME:FileUtils.prepareFolderBuilder(FileUtils.UPDATE,this._mLastAttachedData,this._mLastAttached,true);break;case MoreOptionsDropDown.MENU_DELETE:Page.obtain().performSelectionDelete();break;case MoreOptionsDropDown.MENU_EDIT_PIC:Page.obtain().performSelectionEditPic("right");break;case MoreOptionsDropDown.MENU_SHARE:Page.obtain().performSelectionShareAll(_);break;case MoreOptionsDropDown.MENU_COPY:var A=Page.obtain().dispatchActionPerformed(Page.MENU_COPY,C.target);if(!A){if(disk.DEBUG){console.log("Suppress a download event, hand it over");}return false;}break;case MoreOptionsDropDown.MENU_MOVE:A=Page.obtain().dispatchActionPerformed(Page.MENU_MOVE,C.target);if(!A){if(disk.DEBUG){console.log("Suppress a download event, hand it over");}return false;}break;case MoreOptionsDropDown.MENU_SELL_FILE:Page.obtain().installSellDialog();break;case MoreOptionsDropDown.MENU_SHOW_IN_FOLDER:Page.obtain().performSelectionShowFolder();break;}}if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){switch(B){case MoreOptionsDropDown.MENU_CANCLE_SHARE:if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){Page.obtain().performSelectionCancelShare();}break;}}if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){switch(B){case MoreOptionsDropDown.MENU_OPEN:FileUtils.anchorFoldOpen(C,FileUtils,this._mLastAttached);break;case MoreOptionsDropDown.MENU_DOWNLOAD:Page.obtain().performSelectionDownload();break;case MoreOptionsDropDown.MENU_TRANSFER:Page.obtain().performSelectionTransfer();break;}}if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){switch(B){case Page.MENU_RESTORE:Page.obtain().performSelectionRestore();return true;case Page.MENU_PERSIST_REMOVE:Page.obtain().performSelectionRemoval();return true;}}};MoreOptionsDropDown.prototype.setItemEnabled=function(_,B){if(this._mMenuItems.length==0){this.init();}var A=this._mMenuItems[_];if(!A){if(disk.DEBUG){console.log("Try To Set Menu Item At ",_," and menu length ",this._mMenuItems.length);}return;}A.className=B?"":"disabled";if(B){this.setItemDisplay(_,B);}};MoreOptionsDropDown.prototype.setItemDisplay=function(_,B){if(this._mMenuItems.length==0){this.init();}var A=this._mMenuItems[_];if(!A){if(disk.DEBUG){console.log("Try To Set Menu Item At ",_," and menu length ",this._mMenuItems.length);}return;}$(A).parent().css("display",B?"block":"none");};var DiskFileFilter=function(){this._mCount=0;this._mEligibles={};this._mTag=null;};DiskFileFilter.MAX=200;DiskFileFilter.filter=function(B,A){var D=null,E=0;for(var _=A.length,C=_-1;C>=0;C--){D=A[C].server_filename;if(D){if(B.getEligibles()==0){break;}if(B.match(D)){A.splice(C,1);}}E++;if(E>DiskFileFilter.MAX){break;}}if(disk.DEBUG){console.log("kill all duplicate files with advanced count ",E);}return A;};DiskFileFilter.prototype={clear:function(){if(disk.DEBUG){console.log("drop out all filter eligibles");}if(this._mCount>0){this._mEligibles={};}this._mCount=0;},setTag:function(_){this._mTag=_;},getTag:function(){return this._mTag;},addRule:function(_){if(_==null||_.length==0){return false;}if(typeof this._mEligibles[_]=="undefined"){if(disk.DEBUG){console.log("add new filter file ",_);}this._mEligibles[_]=true;this._mCount++;return true;}return false;},removeRule:function(_){if(_==null||_.length==0){return false;}if(typeof this._mEligibles[_]!="undefined"){delete this._mEligibles[_];this._mCount--;}return false;},hasEligibles:function(){return this._mCount>0;},getEligibles:function(){return this._mCount;},match:function(_){if(this._mCount==0){return false;}if(_==null||_.length==0){return false;}if(typeof this._mEligibles[_]!="undefined"){if(disk.DEBUG){console.log("kill a eligible filter in the pool:",_);}delete this._mEligibles[_];this._mCount--;return true;}return false;}};var FileUtils={ACTION_DELETE:0,ACTION_COPY:1,ACTION_MOVE:2,ACTION_RENAME:3,ACTION_SHARE:4,ACTION_PUBLIC:5,ACTION_UPLOAD:6,ACTION_PRINT:8,PART_TOP_FOLDER:1,PART_KID_FOLDER:2,PART_KID_IMAGE:3,USER_VIEW_MODE:0,FLAG_USER_CHANGED_MODE:false,SELECT_PIC_NUM:0,SHARE_PUBLIC_LINK:1,SHARE_PRIVATE_LINK:0,SHARE_CHANNEL_PUBLIC_LINK:0,SHARE_CHANNEL_PUBLIC_SNS:1,PARTICULAR_DIR_MAP:{"/apps":"/\u6211\u7684\u5e94\u7528\u6570\u636e","/\u767e\u5ea6\u4e91\u6536\u85cf":"/\u767e\u5ea6\u4e91\u6536\u85cf","/\u6765\u81eaPC\u7684\u5907\u4efd\u6587\u4ef6":"/\u6765\u81eaPC\u7684\u5907\u4efd\u6587\u4ef6","/\u6211\u7684\u5206\u4eab":"/\u6211\u7684\u5206\u4eab","/\u6211\u7684\u4f5c\u54c1":"/\u6211\u7684\u4f5c\u54c1"},quota:{total:"0",used:"0",free:"null",expire:"false"},onPersonalPageTabChange:function(F,C){var A,E=parseInt($("span.sharenum-arrow").outerWidth()/2);$("a.publiccnt").parent().removeClass("on-publiccnt on-concerncnt on-fanscnt");var D=FileUtils.sysUK_Master||FileUtils.sysUK,B=Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)?"Ta":"\u6211",_=!(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)&&FileUtils.sysUK_Master!==FileUtils.sysUK)-0;if(F=="share"){A=$(".publiccnt").offset().left;if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){$("a.publiccnt").parent().addClass("on-publiccnt");}setTimeout(function(){$("#followPanel iframe").attr("src","").parent().css("display","none");},10);$("span.sharenum-arrow").css({left:A,width:$("a.publiccnt").width()});}},getFlagHaveBTPlugs:function(){return true;},acceptOpenFileTypes:function(_){if(!Page.inViewMode(Page.VIEW_HOME)){return false;}_=_||"";_=_.toLowerCase();var A=false;if(_==".torrent"){if(FileUtils.getFlagHaveBTPlugs()){A=true;}}else{if(_==".zip"||_==".rar"){A=true;}else{if(_==".html"&&(FileUtils.getModule()!="category"&&(!FileUtils.inSearchMode()))){var B=FileUtils.getDirMgr().getDir();if(B=="/\u767e\u5ea6\u4e91\u6536\u85cf/\u6587\u7ae0"||B.indexOf("/\u767e\u5ea6\u4e91\u6536\u85cf/\u6587\u7ae0/")==0){A=true;}}else{if(_==".dws"||_==".dwt"||_==".dxf"||_==".dwg"){A=true;}}}}return A;},sliceDir:function(_){if(_=="/"){_="";}return _.split("/");},removeFormatForPathName:function(_){_=_||"";return _.replace(/\n|\r|\t/g,"");},getNormalizedPathFromFolder:function(A,_){if(A.indexOf("/")!=0){A="/"+A;}return this.getNormalizedPath(A,_);},getNormalizedPath:function(F,C){var E=this.PARTICULAR_DIR_MAP,G=E[F],_=G;if(typeof G=="undefined"){var B=this.sliceDir(F),A="/"+B[1],D=E[A];if(typeof D!="undefined"){_=F.replace(A,D);}else{_=F;}}return C===true?this.parseDirFromPath(_):_;},parseLongFileName:function(E,B,C){var D=30;if(typeof C!="undefined"){D=C;}var J="";if(!B&&E.lastIndexOf(".")!=-1){J=E.substring(E.lastIndexOf("."));}var F=0,K="",H="";for(var G=0,_=E.length;G<_;G++){if(E.charCodeAt(G)>255){F+=2;}else{F+=1;}if(F>=(D-J.length-6-3)&&K.length==0){K=E.substring(0,G+1);}if(F>(D-J.length-3)){var I="",M=E;if(E.lastIndexOf(".")!=-1){M=E.substring(0,E.lastIndexOf("."));}var A=0;for(var L=M.length;L>M.length-6;L--){if(M.charCodeAt(L)>255){A++;}I=M.substring(L,L+1)+I;if(A>=3){break;}}H=K+"..."+I+J;}}if(F>D){return H;}return E;},isTopParticularDir:function(C){var A=this.sliceDir(C),B=this.PARTICULAR_DIR_MAP,_="/"+A[1];return A.length<=2&&(typeof B[_]!="undefined")&&_!="/\u6211\u7684\u4f5c\u54c1";},isAllPic:function(_){if(_==3){this.SELECT_PIC_NUM++;}else{this.SELECT_PIC_NUM=0;}return this.SELECT_PIC_NUM;},isRevisionCheck:function(_){if(_.length==1&&_[0].category==4){return true;}else{return false;}},isInParticularDir:function(C){var A=this.sliceDir(C),B=this.PARTICULAR_DIR_MAP,_="/"+A[1];return A.length>=2&&(typeof B[_]!="undefined");},actionDenied:function(E,F,A){var C=this.sliceDir(F),D=this.PARTICULAR_DIR_MAP,B="/"+C[1],_=C.length;if(_>=2&&(typeof D[B]!="undefined")){switch(E){case FileUtils.ACTION_DELETE:return _<=2;case FileUtils.ACTION_COPY:return!FileUtils.isInParticularDir(A);case FileUtils.ACTION_RENAME:case FileUtils.ACTION_MOVE:return true;case FileUtils.ACTION_SHARE:return false;case FileUtils.ACTION_PUBLIC:return false;case FileUtils.ACTION_UPLOAD:return true;default:return false;}}else{return false;}},uniqueFileList:function(D){var E=[],C={};for(var B=0,A,_=D.length;B<_&&(A=this.parseDirFromPath(D[B].path).toLowerCase())!="";B++){if(!C[A]){E.push(D[B]);C[A]=true;}}return E;},MODULE_DIR:"dir",MODULE_SEARCH:"s",MODULE_NOTI:"noti",MODULE_CATEGORY:"category",MODULE_LOCATION:"location",URLPATH:"/netdisk/",TYPE_QUERY:["categoryinfo","webcategorylist"],TYPE_PARAM:"category",TYPES:[[1,"\u97f3\u4e50"],[2,"\u56fe\u7247"],[3,"\u89c6\u9891"],[4,"\u6587\u6863"],[5,"\u5e94\u7528"],[6,"\u5176\u5b83"],[7,"\u79cd\u5b50"]],TYPESNAMEHASH:[0,3,1,2,4,5,6,7],UPDATE:0,CREATE:1,SORT_BY_NAME:0,SORT_BY_SIZE:1,SORT_BY_TIME:2,SORT_BY_REMAINING:3,SORT_BY_VCNT:4,SORT_BY_TCNT:5,SORT_BY_DCNT:6,MODE_NORMAL:0,MODE_SEARCH:1,ROOT_ID:0,VIEW_LIST:0,VIEW_GRID_ICON:1,VIEW_GRID_THUMB:2,_mDropdownDrawerFlag:-1,_firstEnter:true,_lastclick:null,_mSortColsDisplayed:true,_mLayoutMode:0,_mLastSearchKey:null,_mPrecedeSortHandler:null,_mFileListDOM:null,_mFileGridDOM:null,_mDirMgr:null,_mLocationDOM:null,_mSelection:null,_mPendingHighlights:null,_mHighlightTimer:null,_mPendingHighlightIndexes:[],_mPendingHighlightFirst:-1,_mModule:null,_mType:null,_mLocalCache:new disk.util.FileCache(),_mPropertyCache:new disk.util.LocalCache(),_mPendingRequestShareProperty:null,_mSpecialFolders:new Array("/\u6211\u7684\u6587\u6863","/\u6211\u7684\u7167\u7247","/\u6211\u7684\u97f3\u4e50","/\u6211\u7684\u89c6\u9891"),_mPropertyNode:null,_mInfiniteListView:null,_mInfiniteGridView:null,_mSortIndicatorCache:{},_mSortTriggers:[],_mQuerying:false,_mGridStep:5,_mLastViewMode:0,_mViewMode:0,_mMboxPlayer:null,_mMboxPlayerIndex:536000,_mDocumentReader:null,_mImgPreviewer:null,_mPushDevice:null,_mHtmlTarget:null,_mCloudPrint:null,_mRevisionList:null,_mOfflineList:null,_mNewOffline:null,_mResolveBTOffline:null,_mResolveUNZip:null,_mDraging:false,_mDragIcon:null,_mMoveSound:null,_mUsePBPLoading:false,_mPBPPage:-1,_mScheduleProxyLoading:false,_mProxyLoader:null,_mProxyCallback:null,_mCategoryProxyLoader:null,_mPendingPageSize:-1,_mProxySortingBy:["time","1"],_mHideLoadingToast:false,_mDataAwardIntrCache:null,_mRecommendBtPanel:null,_mCommentPanel:null,bImgReady:true,AWARD_DIALOG_INSTALL:"award_dialog_install",_mFileFilter:(new DiskFileFilter()),_mLastQueryTerms:null,getFileFilter:function(){return this._mFileFilter;},FLAG_COMING_BY_SEARCH:0,_mMessageFromList:false,_mViewModeSwitchWatcher:null,hideLoadingToast:function(_){this._mHideLoadingToast=_;if(disk.DEBUG){console.log("assign hiding toast = ",_);}},getModule:function(){return this._mModule;},sendUserReport:function(_){var A=disk.api.RestAPI.USER_REPORT;$.ajax(A,{type:"POST",data:{timestamp:Math.round(new Date/1000),action:disk.getParam("from")||_||"web_home"}});},sendAwardTaskRequest:function(_){var A={share_sina:10,upload:6};if(_=="upload"){FileUtils._mDataAwardIntrCache=1;}if(typeof localStorage!="undefined"&&!(localStorage.getItem(_+"_"+FileUtils.sysUID.replace(/@/g,"")))){$.ajax({type:"POST",timeout:3000,url:disk.api.RestAPI.normalize(disk.api.RestAPI.TASK_CREATE,FileUtils.bdstoken),dataType:"json",data:{type:A[_],sign:FileUtils.taskKey,timestamp:FileUtils.taskTime},success:function(B){if(B&&(B.errno==0||B.errno==-36||B.errno==-29)){if(disk.DEBUG){console.log("..........type="+_+"data.errno"+B.errno);}localStorage.setItem(_+"_"+FileUtils.sysUID.replace(/@/g,""),A[_]);}}});}else{return false;}},showAwardIntrDialog:function(C){if(C&&C.task_detail){FileUtils._mDataAwardIntrCache=C.task_detail[6];}var A=5*1024*1024*1024,_=null,B={newtext:'\u4f60\u5df2\u6709<em class="nu">5G</em>\u6c38\u4e45\u514d\u8d39\u5bb9\u91cf\uff0c\u5b8c\u6210\u4efb\u52a1\u53ef\u8fbe<em class="nu">15G</em>\u54e6\uff01',oldtext:'\u514d\u8d39\u4efb\u52a1\u6709\u65b0\u4efb\u52a1\u5566\uff0c<br/>\u5b8c\u6210\u4efb\u52a1\u53ef\u8fbe<em class="nu">15G</em>\u54e6\uff01'};if(C.task_quota>=C.total_quota){return;}else{if(C.task_quota<=A){_=new disk.ui.AwardDialog();}else{if(A<C.task_quota&&C.task_quota<C.total_quota){_=new disk.ui.AwardIntr({msg:B.oldtext});}}}_.localStorageKey=FileUtils.AWARD_DIALOG_INSTALL+"_"+FileUtils.sysUID.replace(/@/g,"");_.localStorageVal=1;},checkCategoryProxyLoaderIntegrality:function(){var A=this._mCategoryProxyLoader;if(A!=null){if(!A.isIdle()){var _=A.getTag();if(disk.DEBUG){console.log("[1]Drop All Category Cache from category "+_);}if(_!=null){FileUtils.getLocalCache().removeCategorys();}}A.setTag(null);A.reset();}},proxyCategoryLoad:function(A,_){var C=this._mCategoryProxyLoader,E=this;if(C!=null){if(!C.isIdle()){var D=C.getTag();if(D!=null){if(disk.DEBUG){console.log("[2]Drop All Category Cache from category "+D);}FileUtils.getLocalCache().removeCategorys();}}C.setTag(null);C.reset();}if(C==null){C=new disk.util.RestfulDataLoader(disk.api.RestAPI.LIST_CATEGORY+"&"+E.TYPE_PARAM+"=%s&pri=%s&num=100","get",null,null);C.onDataAvailable=function(B,D){var A=this.getTag();if(A!=null){FileUtils.getLocalCache().removeCategorys();E.triggerTypeUi(false);FileUtils._mDirMgr._mAfterSearch=false;FileUtils._mDirMgr.cd("",false,true);var G='\u5206\u7c7b:"'+E.TYPES[A-1][1]+'"';FileUtils.getLocalCache().add(G,D);FileUtils._mDirMgr.cd(G,false,B.length!=D.length);FileUtils._mDirMgr._mAfterSearch=true;}if(B.length==D.length){}else{switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:var _=E.setGroupData(D,E._mGridStep);E._mInfiniteGridView.updateBackedData(_,true);E.changeProperty();break;case FileUtils.VIEW_LIST:default:E._mInfiniteListView.updateBackedData(FileUtils.getLocalCache().obtain(G),true);E.changeProperty();break;}}var H=true;if(this.hasMorePage()){var F=E._mViewMode==FileUtils.VIEW_LIST?E._mInfiniteListView:E._mInfiniteGridView,C=F.getScrollbar();if(C==null||!C.isAwake()){this.load();H=false;}}else{this.setTag(null);}if(H){E.shutdownNonListMessageToast();}};C.onDataUnavailable=function(C,D,A){disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);var _=this.getCachedListData(),B=(_.length>0?"\u90e8\u5206":"")+"\u5217\u8868\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5";if(E._mViewMode==FileUtils.VIEW_LIST){if(E._mInfiniteListView!=null){E._mInfiniteListView.setBackedData([]);}else{$("#infiniteListView .loading-data").text(B);}}else{if(E._mInfiniteGridView!=null){E._mInfiniteGridView.setBackedData([]);}else{$("#infiniteGridView .loading-data").text(B);}}if(A!==true){}};C.onLoadingEvent=function(A){E._mQuerying=A;var _=this.getTag();if(A){if(_!=null&&!E._mHideLoadingToast){$("#dirData .loadedDate").html("\u52a0\u8f7d"+E.TYPES[_-1][1]+"\u5206\u7c7b&hellip;");}}else{}};C.setPagingBaseOne(true);this._mCategoryProxyLoader=C;}C.setTag(A);var B=null;if(this._mProxySortingBy.length>0){if(FileUtils._mType&&FileUtils._mProxySortingBy[0]=="time2"){FileUtils._mProxySortingBy[0]="time";}B={};B.order=this._mProxySortingBy[0];if(this._mProxySortingBy[0]){B.desc=this._mProxySortingBy[1];}}C.setRequestData(B);C.setRequestArgReplacements([Category.HASH[A],_]);C.setNeedLoadMorePage(true);FileUtils.getLocalCache().removeAll();C.load();return true;},checkProxyLoaderIntegrality:function(){var _=this._mScheduleProxyLoading,B=this._mProxyLoader;if(_&&B!=null){if(!B.isIdle()){var A=B.getTag();if(A!=null){if(disk.DEBUG){console.log("1------>DROP OUT CACHE AT "+A);}FileUtils.getLocalCache().remove(A);}}B.setTag(null);B.reset();}},figureOutPageSizeFromPendingFiles:function(){var _=100;if(this._mPendingHighlights!=null&&this._mPendingHighlights.length>_){this._mPendingPageSize=this._mPendingHighlights.length;}},issueProxyLoading:function(A,_){this._mScheduleProxyLoading=A;if(_===true){this.figureOutPageSizeFromPendingFiles();if(FileUtils._mType){FileUtils._mProxySortingBy[0]="time";}else{FileUtils._mProxySortingBy[0]="time2";}FileUtils._mProxySortingBy[1]=1;}},shutdownNonListMessageToast:function(){var _=this._mMessageFromList;this._mMessageFromList=false;if(!_){disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);}},proxyLoad:function(D,G,A){var H=this,_=this._mScheduleProxyLoading;this._mScheduleProxyLoading=false;var C=100,F=C;if(this._mPendingPageSize!=-1){F=this._mPendingPageSize;this._mPendingPageSize=-1;}var E=this._mProxyLoader;if(E!=null){if(!E.isIdle()){G=E.getTag();if(G!=null){FileUtils.getLocalCache().remove(G);if(disk.DEBUG){console.log("2------>DROP OUT CACHE AT "+G);}}}E.setTag(null);this._mProxyCallback=null;E.reset();}if(!_){return false;}else{if(E==null){var B=disk.api.RestAPI.LIST;if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){B=disk.api.RestAPI.RECORD_SHARE;}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){B=disk.api.RestAPI.LIST_SHARE;}else{if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){B=disk.api.RestAPI.LIST_RECYCLE;}else{if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){B=disk.api.RestAPI.LIST_SHARE_HOME+"&uk="+FileUtils.share_uk;}}}}E=new disk.util.RestfulDataLoader(B+"&num=%s","get",null,null);E.onDataAvailable=function(B,D){var F=this.getTag();if(F!=null){FileUtils.getLocalCache().update(F,D,true);}if(B.length==D.length){FileUtils.onBeforeRenderingListView(B);if(typeof H._mProxyCallback=="function"){H._mProxyCallback.call(H,D);}else{H.load(F);}}else{var A=FileUtils.getFileFilter();if(A.hasEligibles()){DiskFileFilter.filter(A,D);}switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:var _=H.setGroupData(D,H._mGridStep);H._mInfiniteGridView.updateBackedData(_,true);H.changeProperty();break;case FileUtils.VIEW_LIST:default:H._mInfiniteListView.updateBackedData(D,true);H.changeProperty();break;}}var G=true;if(this.hasMorePage()){var E=H._mViewMode==FileUtils.VIEW_LIST?H._mInfiniteListView:H._mInfiniteGridView,C=E.getScrollbar();if(C==null||!C.isAwake()){this.load();G=false;}}else{this.setTag(null);}if(G){H.shutdownNonListMessageToast();}};E.onDataUnavailable=function(C,D,A){disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);var _=this.getCachedListData(),B=(_.length>0?"\u90e8\u5206":"")+"\u5217\u8868\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5";if(H._mViewMode==FileUtils.VIEW_LIST){if(H._mInfiniteListView!=null){H._mInfiniteListView.setBackedData([]);}else{$("#infiniteListView .loading-data").text(B);}}else{if(H._mInfiniteGridView!=null){H._mInfiniteGridView.setBackedData([]);}else{$("#infiniteGridView .loading-data").text(B);}}if(A!==true){}};E.onLoadingEvent=function(_){H._mQuerying=_;if(_&&!H._mHideLoadingToast){$("#dirData .loadedDate").html("\u83b7\u53d6\u66f4\u591a\u6570\u636e&hellip;");}};E.setPagingBaseOne(true);this._mProxyLoader=E;}E.setTag(G);if(this._mProxySortingBy.length>0){D.order=this._mProxySortingBy[0];if(this._mProxySortingBy[1]){D.desc=this._mProxySortingBy[1];}}else{D.order=this._mProxySortingBy[0];D.desc=this._mProxySortingBy[1];}E.setRequestData(D);E.setRequestArgReplacements([F]);this._mProxyCallback=A;E.setNeedLoadMorePage(true);this._mFileFilter.clear();E.load();return true;}},onBeforeRenderingListView:function(_){if(disk.DEBUG){console.log("do functions : onBeforeRenderingListView");}if(FileUtils.FLAG_USER_CHANGED_MODE==false){if(Page.inViewMode(Page.VIEW_HOME)){if(FileUtils.getModule()!="category"&&(!FileUtils.inSearchMode())){var A=FileUtils.getDirMgr().getDir();if(A=="/\u767e\u5ea6\u4e91\u6536\u85cf/\u56fe\u7247"||A.indexOf("/\u767e\u5ea6\u4e91\u6536\u85cf/\u56fe\u7247/")==0){if(this._mViewMode!=FileUtils.VIEW_GRID_ICON){FileUtils.switchViewMode(FileUtils.VIEW_GRID_ICON);}}else{if(this._mViewMode!=FileUtils.VIEW_LIST){FileUtils.switchViewMode(FileUtils.VIEW_LIST);}}}}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){if(this.judgeViewMode(_)=="gride"){if(this._mViewMode!=FileUtils.VIEW_GRID_ICON){FileUtils.switchViewMode(FileUtils.VIEW_GRID_ICON);}}else{if(this._mViewMode!=FileUtils.VIEW_LIST){FileUtils.switchViewMode(FileUtils.VIEW_LIST);}}}}}},judgeViewMode:function(_){var A,E,C=[],D="list",B;C.dir=C.noThumb=0;for(A=0,E=_.length;A<E;++A){B=_[A];if(B.isdir){C.dir++;}else{if(!B.thumbs&&!B.thumburl){C.noThumb++;}C.push(B);}}if(C.noThumb/C.length<=1/3){D="gride";}return D;},getProxyLoader:function(){return this._mProxyLoader;},getCategoryProxyLoader:function(){return this._mCategoryProxyLoader;},dispatchProxyLoading:function(_){this._mScheduleProxyLoading=_;},setModule:function(_){this._mModule=_;},getType:function(){return this._mType;},setType:function(_){this._mType=_;},typeTable:function(_){if(typeof t!="undefined"){this.getLocalCache()._typeTable=_;return this;}return this.getLocalCache()._typeTable;},triggerTypeUi:function(_){$("#module-slide").css("left","93px");$("#module-type").removeClass("unon");$("#module-path").addClass("unon");$("#choosetype").fadeOut();},getListViewCheckedItems:function(){var _=this._mViewMode==FileUtils.VIEW_LIST?this._mInfiniteListView:this._mInfiniteGridView;return _.getCheckedItems();},deactivateListView:function(A){var _=this._mViewMode==FileUtils.VIEW_LIST?this._mInfiniteListView:this._mInfiniteGridView;if(_){_.deactivate(A);}},isListViewFullyChecked:function(){if(this._mViewMode==FileUtils.VIEW_LIST){return this._mInfiniteListView.getCheckedItems().length==this._mInfiniteListView.getCount();}else{return this._mInfiniteGridView.getCheckedItems().length==this._mInfiniteGridView.getCountEx();}},createCategoryUI:function(C,D,B){var E=this;if(D==this.MODULE_DIR){$("#tab-home").attr("href","home");$("#module-slide").css("left","2px");$("#module-path").removeClass("unon");$("#module-type").addClass("unon");$("#choosetype").fadeOut();}else{$("#module-slide").css("left","93px");$("#module-type").removeClass("unon");$("#module-path").addClass("unon");$("#choosetype").fadeIn();var A=$("#type-size-allnumber").text(),_=$("#type-sizebar").width();$(".type-num").html(function(_){$("#type-num-"+(_+1)).html("("+B[Category.HASH[_+1]].count+"\u4e2a)");});$(".type-size-num").html(function(_){$("#type-size-"+(_+1)).html(FileUtils.toFriendlyFileSize(B[Category.HASH[_+1]].size));});$(".type-sizebar-a1").html(function(C){$("#type-bar-"+(C+1)).width(Math.ceil(B[Category.HASH[C+1]].size/A*_)).css("borderLeftWidth","0");});}$("#type-container .type-div .type-a").hover(function(){$(".type-folder",this).css("top","-10px");},function(){$(".type-folder",this).removeAttr("style");});},initAddSong:function(A){if(this._mMboxPlayer==null||this._mMboxPlayer._mViewState){return;}var _='<span class="b-in-blk sprite-ic b-ic-book" style="background-position: -253px -191px; "></span>';if(this._mMoveSound===null){this._mMoveSound=$("<div>").attr("id","add_song");this._mMoveSound.css({position:"absolute","z-index":100});}this._mMoveSound[0].innerHTML=_+A.innerHTML;this._mMoveSound.css({top:$(A).offset().top-10,left:$(A).offset().left-26});this._mMoveSound.appendTo("body").show();this._mMboxPlayer.startAni(this._mMoveSound,this._mMoveSound.offset().top,this._mMoveSound.offset().left);},initAddBackSong:function(A){if(this._mMboxPlayer==null||this._mMboxPlayer._mViewState){return;}var _='<div class="bubble-panel bubble-panel-back" id="bubbleAwardPanel" ><div class="bubble-arrow reverse"></div><div class="bubble-panel-main" id="bubbleMainContent">\u5df2\u52a0\u5165\u64ad\u653e\u5217\u8868</div></div>';if(this._mMoveSound===null){this._mMoveSound=$("<div>").attr("id","add_song");this._mMoveSound.css({position:"absolute","z-index":100});}this._mMoveSound[0].innerHTML=_;this._mMoveSound.css({top:$(A).offset().top-10,left:$(A).offset().left-26});this._mMoveSound.appendTo("body").fadeIn("fast");this._mMboxPlayer.startAddBackSong(this._mMoveSound,this._mMoveSound.offset().top,this._mMoveSound.offset().left);},triggerDragFile:function(A){var B=this;if(A===false){$(document).unbind("mousemove",B.listenDragDocumentMove).unbind("mouseup",B.listenDragDocumentUp);if(B._mDragIcon){B._mDragIcon.remove();}$("#infiniteListView").removeClass("dragging");B._mDraging=false;return;}B._mDraging=true;$("#infiniteListView").addClass("dragging");if(B._mDragIcon===null){B._mDragIcon=$("<div>").attr("id","drag_file_icon").html("<em></em>").hide();B._mDragIcon.mouseover(function(_){B._mDragIcon.css({top:_.pageY+1,left:_.pageX+1});});if($.browser.webkit){B._mDragIcon.find("em").css({top:"11px","-webkit-text-size-adjust":"none"});}}B._mDragIcon.appendTo("body").hide();var _=FileUtils.getListViewCheckedItems().length;if(_>9){if(_>99){_=99;}B._mDragIcon.find("em").text(_).css("left","16px");}else{B._mDragIcon.find("em").text(_).css("left","19px");}$(document).mousemove(function(_){B.listenDragDocumentMove(_);}).mouseup(function(_){B.listenDragDocumentUp(_);});},listenDragDocumentMove:function(_){if(!_||this._mDraging!==true){return;}this._mDragIcon.css({top:_.pageY+1,left:_.pageX+1}).show();},listenDragDocumentUp:function(_){if(!_||this._mDraging===false){return;}this.triggerDragFile(false);},triggerCategory:function(A){return;this.setType(0);this.checkCategoryProxyLoaderIntegrality();var _=this.getLocalCache(),B=this;Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e&hellip;",sticky:true});if(_._typeTable==null){$.get(disk.api.RestAPI.INFO_CATEGORY+"&time="+(new Date().getTime()),function(C){try{result=$.parseJSON(C);}catch(D){if(disk.DEBUG){console.log("[LOG]====>parse json error on get data",e.message);}}if(result==null||result.errno!=0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}else{_._typeTable=result.info;toast.setVisible(false);B.createCategoryUI(B.getModule(),A,result.info);FileUtils._firstEnter=false;B.setModule(A);}});}else{this.createCategoryUI(this.getModule(),A,_._typeTable);this.setModule(A);toast.setVisible(false);}return this;},triggerType:function(B){if(typeof B=="string"||B>7||B<1){return;}if(B==1){$("#barCmdPlayAll").removeClass("none");}else{$("#barCmdPlayAll").addClass("none");}this.setType(B);var A=this.getLocalCache(),E=B,F=this,D='\u5206\u7c7b:"'+this.TYPES[B-1][1]+'"',_=-1;if(Page.inViewMode(Page.VIEW_HOME)){}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){_=0;}}F.triggerTypeUi(false);var C=this.getFlagTimeLine(B);this.resolveTimelineView(C);if(!A.obtain(D)){this.deactivateListView(true);this.proxyCategoryLoad(B,_);}else{FileUtils._mDirMgr._mAfterSearch=false;FileUtils._mDirMgr.cd("",false,true);FileUtils._mDirMgr.cd(D,false);FileUtils._mDirMgr._mAfterSearch=true;}F.switchLayoutMode(FileUtils.MODE_NORMAL);this.clearCache.interrupt();this.clearCache.start();FileUtils.showTimelineGuide();},flagSendTimeLine:false,timeLineStatus:0,getFlagTimeLineByCookie:function(){if(FileUtils.timeLineStatus===true){var A=("timelinestatus_"+FileUtils.sysUID).replace(/@|\*/g,"");if(typeof localStorage!=="undefined"&&typeof localStorage.getItem!=="undefined"){window.localStorage.setItem(A,1);}FileUtils.flagSendTimeLine=true;FileUtils.updateTimeLineLinkUrl();return true;}else{if(FileUtils.timeLineStatus===false){return false;}}if(typeof localStorage==="undefined"||typeof localStorage.getItem==="undefined"||($.browser.msie&&parseInt($.browser.version,10)<=6)){return false;}var _=localStorage.getItem(("timelinestatus_"+FileUtils.sysUID).replace(/@|\*/g,""));if(_==1){if(!FileUtils.flagSendTimeLine){FileUtils.flagSendTimeLine=true;FileUtils.updateTimeLineLinkUrl();}return true;}else{if(!FileUtils.flagSendTimeLine){FileUtils.flagSendTimeLine=true;FileUtils.updateTimeLineStatus();}return false;}},getFlagTimeLine:function(_){var A=_==2&&FileUtils.getFlagTimeLineByCookie();return A;},removeTimelineView:function(){var _=$("#panInner");_.removeClass("timeline-contains").parent().removeClass("timeline-contains-hide-tips");$("#timeline-tabs").hide();$(".location").show();$("#timeline-frame").remove();},resolveTimelineView:function(A){FileUtils.removeTimelineView();if(!A){return;}if($("#timeline-tabs").length<=0){return;}var _=$("#panInner");_.addClass("timeline-contains").parent().addClass("timeline-contains-hide-tips");$("#timeline-tabs").show();$(".location").hide();$(window).resize();setTimeout(function(){FileUtils._mDiskLog.send({type:"timeline_image_grid_view"});},2000);},timeLineGuideState:"0",showTimelineGuide:function(){$("#timeLineGuide").remove();if($.browser.msie&&parseInt($.browser.version,10)<=6){return;}var _=("flag_timeline_guide_"+FileUtils.sysUID).replace(/@|\*/g,""),A;if(typeof localStorage!=="undefined"&&typeof localStorage.getItem!=="undefined"){A=window.localStorage.getItem(_);}if(A!=1&&FileUtils.getFlagTimeLineByCookie()==false&&FileUtils.timeLineGuideState!="1"&&(FileUtils.getModule()==null||FileUtils.getModule()==="category")&&FileUtils.getType()===2){$(document.body).append('<div id="timeLineGuide"><a class="timeline-apply" href="javascript:;">\u7533\u8bf7\u4f18\u5148\u4f53\u9a8c</a><a class="timeline-close" href="javascript:;">\u5173\u95ed</a></div>');$("#timeLineGuide").delegate(".timeline-close","click",function(){$("#timeLineGuide").remove();var _=("flag_timeline_guide_"+FileUtils.sysUID).replace(/@|\*/g,"");if(typeof localStorage!=="undefined"&&typeof localStorage.getItem!=="undefined"){window.localStorage.setItem(_,1);}}).delegate(".timeline-apply","click",function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u7533\u8bf7\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});FileUtils.updateTimelineGuide();});$("#timeLineGuide").css("top",$(".all-files-headers").offset().top-$("#timeLineGuide").height());}},updateTimeLineStatus:function(){$.getJSON("/api/image/getuinfo",function(_){if(_&&_.errno==0&&_.lt_flag==2){if(typeof localStorage!=="undefined"&&typeof localStorage.setItem!=="undefined"){localStorage.setItem(("timelinestatus_"+FileUtils.sysUID).replace(/@|\*/g,""),1);}FileUtils.updateTimeLineLinkUrl();}});},updateTimeLineLinkUrl:function(){var _=$(".b-list-3 a[cat=2]","#aside");_.attr("href","/disk/timeline");},updateTimelineGuide:function(){var _=function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7533\u8bf7\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});};$.getJSON("/api/image/apply",function(A){if(A&&(A.errno==0||A.errno==110)){FileUtils.timeLineGuideState="1";Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u7533\u8bf7\u6210\u529f\uff0c\u4e24\u5929\u540e\u518d\u6765\u4f53\u9a8c\u65f6\u5149\u8f74\u529f\u80fd\u5427\uff01",sticky:false});$("#timeLineGuide").remove();}else{_();}}).error(function(){_();});FileUtils._mDiskLog.send({type:"timeline_image_apply"});},layout:function(_,B){var C=this;if(_){var A=null;return function(){if(A){clearTimeout(A);}A=setTimeout(function(){Utilities.resolveLayout();disk.Context.EmbedApp.dispatchResizeWindow();if(FileUtils.isListViewLocked()){if(FileUtils._mLocalCache.obtain(FileUtils.resolveCurrentDirKey())&&FileUtils._mLocalCache.obtain(FileUtils.resolveCurrentDirKey()).length>2){disk.ui.FolderBuilder.getDefault().dispatchNegativeAction();}else{return false;}}switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(FileUtils._mGridStep!==Math.floor($(".location:first").outerWidth()/150)||2){FileUtils.switchViewMode(FileUtils.VIEW_GRID_ICON);}if(C._mInfiniteGridView!=null){C._mInfiniteGridView.requestLayout();}break;case FileUtils.VIEW_LIST:default:if(C._mInfiniteListView!=null){C._mInfiniteListView.requestLayout();}break;}},B);};}else{return function(){Utilities.resolveLayout();disk.Context.EmbedApp.dispatchResizeWindow();switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(C._mInfiniteGridView!=null){C._mInfiniteGridView.requestLayout();}break;case FileUtils.VIEW_LIST:default:if(C._mInfiniteListView!=null){C._mInfiniteListView.requestLayout();}break;}};}},computeHidingStrategy:function(D){if(!D){return;}var C=FileUtils.parseDirPath(D),B=FileUtils.parseDirFromPath(D);if("/"+B==C){this._mDirMgr.setHidingInfo(0,"");return;}var _=C.substring(0,C.lastIndexOf("/"));if(disk.DEBUG){console.log("Base Path = ",_);}var A=_.substring(1).split("/").length;this._mDirMgr.setHidingInfo(A,_);},hitInHidingRoot:function(C){var B=this._mLocalCache.obtain(FileUtils.ROOT_ID);for(var A=0,_=B.length;A<_;A++){if(B[A].path==C){return true;}}return false;},tryToUseHidingStrategy:function(D){if(D==null){return;}var E=D[1].path;if(typeof E=="undefined"){return;}var B=this._mLocalCache.obtain(FileUtils.ROOT_ID),C=null;for(var A=0,_=B.length;A<_;A++){C=B[A].path;if(E.indexOf(C)==0){this.computeHidingStrategy(C);}}},sortBy:function(C,_){if(disk.DEBUG){console.log("[LOG]sort by ",C," and reverse ",_);}var B=this.resolveCurrentDirKey();if(this._mLayoutMode==FileUtils.MODE_SEARCH&&this._mLastSearchKey!=null){B=this._mLastSearchKey;}var A=this._mLocalCache.obtain(B);if(typeof A!="undefined"){if(this.inHomeMode()){switch(C){case FileUtils.SORT_BY_SIZE:this._mProxySortingBy[0]="size";break;case FileUtils.SORT_BY_TIME:this._mProxySortingBy[0]="time";break;default:this._mProxySortingBy[0]="name";break;}this._mProxySortingBy[1]=_===true?1:0;this._mScheduleProxyLoading=true;FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.loadDir(FileUtils.resolveCurrentDirKey());}else{if(Page.inViewMode(Page.VIEW_HOME)&&FileUtils.getModule()=="category"){switch(C){case FileUtils.SORT_BY_SIZE:FileUtils._mProxySortingBy[0]="size";break;case FileUtils.SORT_BY_TIME:FileUtils._mProxySortingBy[0]="time";break;default:FileUtils._mProxySortingBy[0]="name";break;}FileUtils._mProxySortingBy[1]=_===true?1:0;this._mScheduleProxyLoading=true;FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();this.triggerType(FileUtils.getType());}else{this._sortFiles(A,C,_);this.load(B);}}}},switchLayoutMode:function(_){this._mLayoutMode=_;},inHomeMode:function(){return Page.inViewMode(Page.VIEW_HOME)&&(this._mModule!="category");},inSearchMode:function(){return this._mLayoutMode==FileUtils.MODE_SEARCH;},_sortFiles:function(A,E,_){if(!A){if(disk.DEBUG){console.log("sort ending... files does not exists. ");}return false;}var C=document.body.className,D=this.PARTICULAR_DIR_MAP,B=function(B,H){var F=FileUtils.parseDirPath(B.path||B.typicalPath),G=FileUtils.parseDirPath(H.path||H.typicalPath);if(C!="flag-4"){if(typeof D[G]!="undefined"){return 1;}else{if(typeof D[F]!="undefined"){return-1;}}}if(!Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)&&!Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){var A=H.isdir-B.isdir;if(A!=0){return A;}}switch(E){case FileUtils.SORT_BY_SIZE:if(typeof B.size=="undefined"){B.size=0;}if(typeof H.size=="undefined"){H.size=0;}A=B.size-H.size;break;case FileUtils.SORT_BY_TIME:A=(B.server_mtime||B.server_ctime||B.ctime||0)-(H.server_mtime||H.server_ctime||H.ctime||0);break;case FileUtils.SORT_BY_REMAINING:A=(B.dateDiff-H.dateDiff)||FileUtils.parseDirFromPath(B.path||B.typicalPath).localeCompare(FileUtils.parseDirFromPath(H.path||H.typicalPath));break;case FileUtils.SORT_BY_VCNT:A=B.vCnt-H.vCnt;break;case FileUtils.SORT_BY_TCNT:A=B.tCnt-H.tCnt;break;case FileUtils.SORT_BY_DCNT:A=B.dCnt-H.dCnt;break;case FileUtils.SORT_BY_NAME:default:A=FileUtils.parseDirFromPath(B.path||B.typicalPath).localeCompare(FileUtils.parseDirFromPath(H.path||H.typicalPath));break;}if(_===true){A=-A;}return A;};A.sort(B);},parseDirPath:function(_){return _.substring(_.indexOf(":/")+1);},parseDirFromPath:function(_){return _.substring(_.lastIndexOf("/")+1);},parseFullDirFromPath:function(_){return _.substring(0,_.lastIndexOf("/"));},parseNameFromPath:function(_){return _.substring(_.lastIndexOf("/")+1,_.length);},ifSpecialFolder:function(A,_){return false;},resolveDirKey:function(_){return _==disk.util.DirectoryLocation.DIR_ROOT?FileUtils.ROOT_ID:_;},resolveCurrentDirKey:function(){if(this._mModule=="category"){return'\u5206\u7c7b:"'+this.TYPES[this._mType-1][1]+'"';}return this.resolveDirKey(this._mDirMgr.getDir());},getLocalCache:function(){return this._mLocalCache;},getCategory:function(){return this._mCategory;},getDirMgr:function(){return this._mDirMgr;},scheduleQueryDir:function(D,H){if(D&&D.length>4&&D.search(/:/)==2){var J=D.split(":");if(J[0]==="\u641c\u7d22"){Page.obtain().performGlobalSearch(J[1].substring(1,(J[1].length-1)));return;}else{if(J[0]==="\u5206\u7c7b"){}}}this._mQuerying=true;var F=this;if(this._mUsePBPLoading){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6587\u4ef6\u6570\u91cf\u8f83\u591a\uff0c\u52a0\u8f7d\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u65f6\u95f4&hellip;",sticky:true});}var I={dir:D==FileUtils.ROOT_ID?"/":D,t:Math.random().toFixed(5)};if(this._mPendingRequestShareProperty!=null){I.pri=this._mPendingRequestShareProperty;this._mPendingRequestShareProperty=null;}var A=document.body.className;if(A.indexOf("flag-2")!=-1){I.uk=FileUtils.share_uk;I.shareid=FileUtils.share_id;}else{if(A.indexOf("flag-3")!=-1){I.uk=FileUtils.sysUK;}else{if(A.indexOf("flag-5")!=-1){}}}var E=2000,C=Page.inViewMode(Page.VIEW_HOME),_=disk.api.RestAPI.LIST,G=C||Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)||Page.inViewMode(Page.VIEW_PROPERTY_OTHER)||Page.inViewMode(Page.VIEW_RECYCLE_BIN),K=Page.obtain();if(K&&K._mMoveCopyDialog&&K._mMoveCopyDialog.isVisible&&typeof K._mMoveCopyDialog.isVisible==="function"&&K._mMoveCopyDialog.isVisible()===true){G=false;if(disk.DEBUG){console.log("not remove cache becourse MoveCopyDialog is visible");}}if(G){var B=this.proxyLoad(I,D,H);if(B){if(disk.DEBUG){console.log("[LOG]","proxy loader inject, job accepted");}this._mQuerying=false;return true;}_=disk.api.RestAPI.LIST+"&num="+E;if(this._mUsePBPLoading){_+="&page="+this._mPBPPage;}else{_+="&page=1";}}else{if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){_=disk.api.RestAPI.LIST_RECYCLE;}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){_=disk.api.RestAPI.LIST_SHARE+location.search;}}}$.get(_,I,function(_){disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);var A=null;try{A=$.parseJSON(_);}catch(B){}if(A!=null&&parseInt(A.errno)==0&&A.list!=null){if(F._mUsePBPLoading){F._mPBPPage++;if(A.list.length>0){F._mLocalCache.appendList(D,A.list);F.loadDir(D,H);F.lockActiveRenderingView(true);F.scheduleQueryDir(D,H);}else{F._mUsePBPLoading=false;F._mPBPPage=-1;F.lockActiveRenderingView(false);F.loadDir(D,H);F._mQuerying=false;}}else{if(C&&A.list.length>=E){F._mUsePBPLoading=true;F._mPBPPage=2;F.lockActiveRenderingView(true);F._mLocalCache.add(D,A.list);F.loadDir(D,H);F.scheduleQueryDir(D,H);}else{F._mLocalCache.add(D,A.list);F.loadDir(D,H);F._mQuerying=false;}}}else{if(F._mUsePBPLoading){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u90e8\u5206\u6587\u4ef6\u672a\u6210\u529f\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});F._mUsePBPLoading=false;F._mPBPPage=-1;F.lockActiveRenderingView(false);F.loadDir(D,H);}else{if(FileUtils.inSearchMode()){disk.util.HistoryManager.getDefault();}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u90e8\u5206\u6587\u4ef6\u672a\u6210\u529f\u52a0\u8f7d\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});if(!F._mDirMgr.atRoot()){if(disk.DEBUG){console.error("something wired happened");}disk.util.HistoryManager.getDefault().go(-1);}else{F._mLocalCache.add(D,[]);F.loadDir(D,H);}}}F._mQuerying=false;}});},loadDir:function(B,A){if(!this.bImgReady&&FileUtils.getModule()!="category"){this._mLocalCache.removeAll();this.bImgReady=true;}this.checkProxyLoaderIntegrality();if(this._mSelectionArbitrate){this._mSelectionArbitrate.removeClass("on");}var _=FileUtils.getLocalCache()._pathByType;if(!this._mLocalCache.contains(B)||(_&&_[B])){this.scheduleQueryDir(B,A);}else{if(typeof A=="function"){A.call(this,this._mLocalCache.obtain(B));}else{FileUtils.onBeforeRenderingListView(this._mLocalCache.obtain(B));this.load(B);}}this.clearCache.interrupt();this.clearCache.start();},clearCache:new disk.util.TimerService(Utilities._mInterval||3600000,function(){if(FileUtils.isListViewLocked()){disk.ui.FolderBuilder.getDefault().dispatchNegativeAction();}if(FileUtils.getModule()=="category"){if(FileUtils.getType()){FileUtils.triggerType(FileUtils.getType()-0);}}else{if(FileUtils._mDirMgr.atRoot()&&!Page.inViewMode(Page.VIEW_HOME)){if(disk.DEBUG){console.log("Block Non-Home Root Refreshing");}}else{FileUtils.issueProxyLoading(true);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());}}this.start();}),switchToDir:function(_){this._mDirMgr.switchDir(disk.util.DirectoryLocation.toDirArray(_));},toCategorizedCrumb:function(){return'<li id="dirPath"><span class="dirCategory">\u5168\u90e8'+this.TYPES[this._mType-1][1]+'</span><span id="dirLocation"></span></li><li id="dirData"><span><span class="loadedDate">-</span></span></li>';},buildDirMgr:function(){var _=new disk.util.DirectoryLocation(),A=this;_.onDirChange=function(_){if(A.isListViewLocked()){return;}if(A._mPrecedeSortHandler!=null){if(Page.inViewMode(Page.VIEW_HOME)&&FileUtils.getModule()=="category"){}else{$(A._mPrecedeSortHandler).removeClass("desc");}}A._mLocationDOM.html(FileUtils.getModule()!="category"?this.toCrumbString(A._mLocationDOM.attr("label")):A.toCategorizedCrumb());var B=function(D){if(this.className.indexOf("disabled")!=-1){return false;}if(A._mModule=="category"){if(A._mQuerying){return false;}var B=this.getAttribute("cat");if(B){B=parseInt(B);if(B==A._mType){return false;}A.deactivateListView(true);Page.obtain().performType(B-1);}else{A.deactivateListView(true);disk.util.HistoryManager.getDefault().navigate(FileUtils.MODULE_CATEGORY,null);}return false;}A.switchLayoutMode(FileUtils.MODE_NORMAL);if(A.isListViewLocked()){return false;}var _=this.getAttribute("deep");if(disk.DEBUG){console.assert(_!=null);}if(_){_=parseInt(_);if(_<0){return false;}if(A._mQuerying){return false;}A.deactivateListView(true);if(disk.DEBUG){console.log(A._mDirMgr.getLookback(_),"<<<DIR");}var C=A._mDirMgr.getLookback(_);FileUtils.historyNavigate(C==disk.util.DirectoryLocation.DIR_ROOT?{}:{path:C});return false;}};$("a",A._mLocationDOM).each(function(A,_){$(_).click(B);});A.loadDir(A.resolveDirKey(_));};_.setPathFilter(function(B){var _=A._mDirMgr.getDir();if(FileUtils.isInParticularDir(_)){return A.getNormalizedPathFromFolder(B,true);}else{return B;}});this._mDirMgr=_;this._mLocationDOM=$(".dir-path:first");disk.util.HistoryManager.getDefault().listen(FileUtils.MODULE_DIR,function(B){var _=A._mFileFilter.getTag(),D=B.path;if(A._mFileFilter.hasEligibles()){if(_!=null&&_!=D){A._mFileFilter.clear();}}A._mFileFilter.setTag(D||"/");if(FileUtils.isListViewLocked()){disk.ui.FolderBuilder.getDefault().dispatchNegativeAction();}A.checkCategoryProxyLoaderIntegrality();if(disk.DEBUG){console.log("Start to navigate to = ",B.path);}A._mScheduleProxyLoading=true;A.deactivateListView(true);FileUtils.createCategoryUI(FileUtils.getModule(),FileUtils.MODULE_DIR);FileUtils.setModule(FileUtils.MODULE_DIR);$("#barCmdPlayAll").addClass("none");$("#barCmdNewFolder").removeClass("none");if(Page.inViewMode(Page.VIEW_HOME)){$("#tab-home").addClass("on");$("#aside-menu a.b-no-ln").removeClass("on");}FileUtils.switchLayoutMode(FileUtils.MODE_NORMAL);var C=B.path;if(typeof C!="undefined"){if(!Page.inViewMode(Page.VIEW_HOME)&&FileUtils.hitInHidingRoot(C)){FileUtils.computeHidingStrategy(C);}A.switchToDir(A.parseDirPath(C));}else{A._mDirMgr.cd(disk.util.DirectoryLocation.DIR_ROOT,false);}});window.onresize=FileUtils.layout($.browser,50);},pendingHighlights:function(_){this._mPendingHighlights=_;},cancelQuestionnaire:function(_){_&&_();return null;},cancelShareInView:function(A){var B=this,_=disk.Context.getService(disk.Context.SERVICE_DIALOG);_.setVisible(true);$("#chunleireader").css("visibility","hidden");_.setMessage("\u53d6\u6d88\u5206\u4eab","\u53d6\u6d88\u5206\u4eab\u540e\uff0c\u8be5\u6761\u5206\u4eab\u8bb0\u5f55\u5c06\u88ab\u5220\u9664\uff0c\u597d\u53cb\u5c06\u65e0\u6cd5\u518d\u8bbf\u95ee\u6b64\u5206\u4eab\u94fe\u63a5\u3002<br/>\u4f60\u786e\u8ba4\u8981\u53d6\u6d88\u5206\u4eab\u5417\uff1f",function(){this.setVisible(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6b63\u5728\u5220\u9664\u5916\u94fe\uff0c\u6210\u529f\u540e\u5c06\u5173\u95ed\u7a97\u53e3&hellip;",sticky:true,closeType:true});$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.CANCEL_SHARE,FileUtils.bdstoken),A,function(C){try{if(disk.DEBUG){console.log("cancel share response:",C);}var A=$.parseJSON(C);if(A.errno==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u5916\u94fe\u5df2\u5220\u9664\u3002",sticky:false});B.cancelQuestionnaire(function(){try{window.opener=null;window.close();}catch(_){}finally{window.location.reload();}});}else{var _=disk.util.shareErrorMessage[A.errno]||"\u672a\u77e5\u9519\u8bef\uff0cerrno:"+A.errno;Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:_,sticky:true,closeType:true});}}catch(D){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u670d\u52a1\u5668\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}}).error(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u9a8c\u8bc1\u670d\u52a1\u5668\u9519\u8bef:"+textStatus,sticky:true,closeType:true});});},function(){$("#chunleireader").css("visibility","visible");});return;},downloadCounter:function(C,B){if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){var F=FileUtils.share_uk,D=FileUtils.share_id,A=[];for(var _ in C){if(C.hasOwnProperty(_)){var E={fid:C[_].fs_id,category:C[_].category};A.push(E);}}$.post(disk.api.RestAPI.MIS_COUNTER,{uk:F,filelist:$.stringify(A),sid:D,ctime:FileUtils.share_ctime,"public":FileUtils.share_public_type});B&&$.get(disk.api.RestAPI.SHARE_COUNTER,{type:1,shareid:D,uk:F,sign:FileUtils.share_sign,timestamp:FileUtils.share_timestamp,t:new Date().getTime(),_:Math.random()});}},cancelShare:function(C){var B=disk.Context.getService(disk.Context.SERVICE_DIALOG),F=[],D,J=this,G=0,E=0,I=disk.ui.ShareDialog,D="\u5206\u4eab";for(var A=0,_=C.length;A<_;A++){var H=C[A];F.push(H.shareId);if(H.status==1||H.status==3||(!H.fsIds)||H.fsIds.length==0){continue;}if(H.public==FileUtils.SHARE_PUBLIC_LINK){G++;}else{E++;}}if(C.length>0){B.setVisible(true);B.setMessage("\u786e\u8ba4\u53d6\u6d88"+D,"\u53d6\u6d88\u5206\u4eab\u540e\uff0c\u8be5\u6761\u5206\u4eab\u8bb0\u5f55\u5c06\u88ab\u5220\u9664\uff0c\u597d\u53cb\u5c06\u65e0\u6cd5\u518d\u8bbf\u95ee\u6b64\u5206\u4eab\u94fe\u63a5\u3002<br/>\u4f60\u786e\u8ba4\u8981\u53d6\u6d88\u5206\u4eab\u5417\uff1f",function(){this.setVisible(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u53d6\u6d88"+D+"\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.CANCEL_SHARE,FileUtils.bdstoken),{shareid_list:$.stringify(F)},function(F){try{if(disk.DEBUG){console.log("cancel share response:",F);}var C=$.parseJSON(F);if(C.errno==0){if(J._mViewMode==FileUtils.VIEW_LIST){J._mInfiniteListView.updateBackedData(J._mLocalCache.obtain(J.resolveCurrentDirKey()));}else{var _=J.setGroupData(J._mLocalCache.obtain(J.resolveCurrentDirKey()),J._mGridStep);if(J._mInfiniteGridView!=null){J._mInfiniteGridView.updateBackedData(_);}}var A=disk.Context.getService(disk.Context.SERVICE_TOAST);A.setVisible(false);FileUtils._shareDropdownDrawerTrigger(null,true);FileUtils.proxyReloadDir();A.pending(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u53d6\u6d88\u5916\u94fe"+D+"\u6210\u529f",sticky:false});});$("em.publiccnt").html($("em.publiccnt").html()-G);$("em.secretcnt").html($("em.secretcnt").html()-E);J.cancelQuestionnaire();}else{var B=disk.util.shareErrorMessage[C.errno]||"\u672a\u77e5\u9519\u8bef\uff0cerrno:"+C.errno;Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:B,sticky:true,closeType:true});}Page.obtain().resolveToolbarMenu();}catch(H){if(disk.DEBUG){console.log("[LOG]=====>cancel public failure msg:",H.message);}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u53d6\u6d88\u5916\u94fe"+D+"\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});}});});}},proxyReloadDir:function(){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.issueProxyLoading(true);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());},getListView:function(){return this._mViewMode==this.VIEW_LIST?this._mInfiniteListView:this._mInfiniteGridView;},repaintListView:function(){if(this._mViewMode==this.VIEW_LIST){this._mInfiniteListView.requestLayout();}else{this._mInfiniteGridView.requestLayout();}},disableSearchAndMediaChoosingFeature:function(D){var B=[document.getElementById("tab-home"),document.getElementById("tab-share"),document.getElementById("tab-public"),document.getElementById("tab-recyle")],C=null;for(var A=0,_=B.length;A<_;A++){C=B[A];if(D){if($(C).hasClass("on")){C.setAttribute("_on","1");$(C).removeClass("on");break;}}else{if(C.getAttribute("_on")=="1"){$(C).addClass("on");break;}}}if(D){$("#search").css("display","none");$("#module").css("display","none");}else{$("#search").css("display","block");$("#module").css("display","block");}},hideHisTrigger:function(A){if(A){var _=document.getElementById("hisTrigger");if(_&&$("#hisTrigger").hasClass("aside-history-on")){_.setAttribute("_hide","1");$("#hisTrigger").removeClass("aside-history-on");}}else{_=document.getElementById("hisTrigger");if(_&&_.getAttribute("_hide")=="1"){_.setAttribute("_hide","0");$("#hisTrigger").addClass("aside-history-on");}}},deleteFiles:function(E,G){var A=disk.Context.getService(disk.Context.SERVICE_DIALOG),H=[],C=this,J=null,B=null,I=null,K=false;for(var F=0,_=E.length;F<_;F++){J=FileUtils.parseDirPath(E[F].path);if(FileUtils.ifSpecialFolder(J)){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u9884\u7f6e\u6587\u4ef6\u5939\u4e0d\u53ef\u5220\u9664\u3002",sticky:false});return;}if(!K&&FileUtils.isInParticularDir(J)){if(J.indexOf(FileUtils.PARTICULAR_DIR_MAP["/\u6765\u81eaPC\u7684\u5907\u4efd\u6587\u4ef6"])!=-1){K=false;}else{K=true;}}H.push(J);}B="\u4f60\u9009\u62e9\u7684\u6587\u4ef6\u5305\u542b\u7b2c\u4e09\u65b9\u5e94\u7528\u4e2d\u7684\u6587\u4ef6";if(J.indexOf("/apps/\u8054\u901a\u51b2\u5370")!=-1){I="\u5220\u9664\u540e\u5c06\u5bfc\u81f4\u8054\u901a\u51b2\u5370\u670d\u52a1\u8bfb\u53d6\u6570\u636e\u5f02\u5e38";}else{if(J.indexOf("/apps/album")!=-1){B="\u4f60\u9009\u62e9\u7684\u6587\u4ef6\u5305\u542b\u767e\u5ea6\u76f8\u518c\u4e2d\u7684\u6587\u4ef6";I="\u5220\u9664\u540e\u767e\u5ea6\u76f8\u518c\u4e2d\u7684\u6587\u4ef6\u4e5f\u5c06\u540c\u6b65\u5220\u9664";}else{if(J.indexOf("/\u6211\u7684\u5206\u4eab")!=-1){B="\u8be5\u6587\u4ef6\u5df2\u7ecf\u5206\u4eab\u7ed9\u4f60\u7684\u670b\u53cb\u4eec\u4e86";I="\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u518d\u88ab\u67e5\u770b";}else{I="\u5220\u9664\u540e\u8be5\u5e94\u7528\u4e2d\u7684\u6587\u4ef6\u4e5f\u5c06\u540c\u6b65\u88ab\u5220\u9664";}}}var D=K?B+"\uff0c"+I+"<br />\u662f\u5426\u7ee7\u7eed\uff1f(\u5220\u9664\u7684\u6587\u4ef6\u53ef\u4ee5\u5728\u56de\u6536\u7ad9\u8fd8\u539f)":"\u786e\u8ba4\u8981\u628a\u6240\u9009\u6587\u4ef6\u653e\u5165\u56de\u6536\u7ad9\u5417\uff1f<br />(\u5220\u9664\u7684\u6587\u4ef6\u53ef\u4ee5\u5728\u56de\u6536\u7ad9\u8fd8\u539f)";if(E.length>0){A.setVisible(true);if($(".img-dialog").length>0&&$(".img-dialog").css("display")!="none"){$(".b-canvas").css("z-index","991");}A.setMessage("\u786e\u8ba4\u5220\u9664",D,function(){A.setVisible(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u5220\u9664\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.FILE_MANAGER+"&opera=delete",FileUtils.bdstoken),{filelist:$.stringify(H)},function(B){var A=null;try{A=$.parseJSON(B);}catch(J){if(disk.DEBUG){console.log("delete falure msg:",J.message);}}if(A!=null&&A.errno==0){var _=disk.Context.getService(disk.Context.SERVICE_TOAST);_.setVisible(false);var F=-1,I=null;if(FileUtils.getModule()=="category"){F=disk.util.FileCache.KEY_MODE_CATEGORY;I=FileUtils.getType();}else{if(FileUtils.inSearchMode()){F=disk.util.FileCache.KEY_MODE_SEARCH;I=FileUtils._mLastQueryTerms;}else{F=disk.util.FileCache.KEY_MODE_NORMAL;I=FileUtils.resolveCurrentDirKey();}}var E=FileUtils.getLocalCache().deleteByMode(F,I,H);if(E){FileUtils.clearAllDocData();var D=FileUtils.getListView();D.setItemsChecked(false);B=FileUtils.getLocalCache().obtainByMode(F,I);if(C._mViewMode!=FileUtils.VIEW_LIST){B=C.setGroupData(B,C._mGridStep);}D.updateBackedData(B);Page.obtain().resolveToolbarMenu();if(typeof G=="function"){G();}Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:'\u6587\u4ef6\u5df2\u5220\u9664\u5230"\u56de\u6536\u7ad9"',sticky:false});return;}}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5220\u9664\u6587\u4ef6\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});});if($(".img-dialog").length>0&&$(".img-dialog").css("display")!="none"){$(".b-canvas").css("z-index","890");}},function(){if($(".img-dialog").length>0&&$(".img-dialog").css("display")!="none"){$(".b-canvas").css("z-index","890");}});}},transferFiles:function(K,E,B,L){var G=this,A=disk.ui.LoginDialog.obtain(),M=[],P=FileUtils.sysUK||B,_=Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u4fdd\u5b58\u6587\u4ef6...",sticky:true});if(!E){E=FileUtils.share_id;}var N=K,H=null,F=1,J=function(A){_=Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u52a0\u8f7d\u6570\u636e",sticky:true});H=A;if(!H||H.length<=0){if(disk.DEBUG){console.log("transfer more files is empty");}_=Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u60a8\u8fd8\u6ca1\u6709\u9009\u62e9\u4fdd\u5b58\u7684\u6587\u4ef6",sticky:false});return;}if(FileUtils.loginState!="1"){_.setVisible(false);disk.PassportInit.netdiskLogin({reload:true});}else{if(!G._mMoveSaveDialog){G._mMoveSaveDialog=new disk.ui.MoveSaveDialog();}G._mMoveSaveDialog.onConsent=function(I){if(disk.DEBUG){console.log("move save more files to path:"+I);}var C=I,D=[],A=E,J=Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,position:disk.ui.Panel.TOP,msg:"\u6b63\u5728\u4fdd\u5b58\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});if(typeof B!="undefined"){J.setGravity(disk.ui.Panel.CENTER);}if(A.length>0){D.push("&shareid=");D.push(A);}$.ajax({type:"post",url:disk.api.RestAPI.normalize(disk.api.RestAPI.TRANSFER+"&ondup=newcopy&async="+F+"&from="+encodeURIComponent(P)+D.join(""),FileUtils.bdstoken),data:{path:I,filelist:$.stringify(H)},timeout:100000,success:function(O){try{var P=$.parseJSON(O);}catch(T){if(disk.DEBUG){console.log("[LOG]====>parse json error on show property dialog ",T.message);}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,position:disk.ui.Panel.TOP,msg:"\u6570\u636e\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}if(P==null){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,position:disk.ui.Panel.TOP,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}else{if(P.errno==-6){_.setVisible(false);G._mMoveSaveDialog.setVisible(false);disk.PassportInit.netdiskLogin({reload:true});}else{if(P.errno==0){var R=FileUtils.share_uk,A=FileUtils.share_id,B=P.task_id,I=[];for(var J in N){var K={fid:N[J].fs_id,category:N[J].category};I.push(K);}if(B>0){var H,Q=setInterval(function(){$.get("/share/taskquery?taskid="+B,function(_){_=$.parseJSON(_);if(!_){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,position:disk.ui.Panel.TOP,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});clearInterval(Q);return;}if(_.errno==0){if(_.task_errno!=0){var A="";if(_.task_errno==-30){A="\u4fdd\u5b58\u7684\u6587\u4ef6\u90e8\u5206\u5df2\u5b58\u5728\uff0c<a style='color:blue;text-decoration:underline' href='//pan.baidu.com/disk/home#dir/path="+encodeURIComponent(C||"/")+"'>\u70b9\u51fb\u67e5\u770b</a>\u5df2\u5b58\u5728\u7684\u6587\u4ef6";}else{A=disk.util.shareErrorMessage[_.task_errno]||"\u6587\u4ef6\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5";}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:A,sticky:true,position:disk.ui.Panel.TOP,closeType:true});clearInterval(Q);}else{if(_.status=="pending"){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u51c6\u5907\u4fdd\u5b58\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true,position:disk.ui.Panel.TOP,closeType:false});}else{if(_.status=="running"){var B=0;if(typeof H!="undefined"&&(!_.progress)){B=H;}else{if(!_.progress){B=0;}else{B=Math.min(Math.max(parseInt(_.progress,10),0),100);}H=B;}Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u4fdd\u5b58\uff0c\u8bf7\u7a0d\u5019&hellip;&nbsp;&nbsp;&nbsp;\u5df2\u5b8c\u6210\uff1a"+B+"%",sticky:true,position:disk.ui.Panel.TOP,closeType:false});}else{if(_.status=="success"){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u4fdd\u5b58\u6210\u529f\uff0c<a style='color:blue;text-decoration:underline' href='//pan.baidu.com/disk/home#dir/path="+encodeURIComponent(C||"/")+"'>\u70b9\u51fb\u67e5\u770b</a>\u4fdd\u5b58\u7684\u6587\u4ef6",sticky:true,position:disk.ui.Panel.TOP,closeType:true});clearInterval(Q);}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,position:disk.ui.Panel.TOP,closeType:true});clearInterval(Q);}}}}}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:disk.util.shareErrorMessage[_.errno]||"\u6587\u4ef6\u4fdd\u5b58\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,position:disk.ui.Panel.TOP,closeType:true});clearInterval(Q);}});},2500);Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u7cfb\u7edf\u6b63\u5728\u4e3a\u4f60\u4fdd\u5b58\uff0c\u8bf7\u7a0d\u5019&hellip;",position:disk.ui.Panel.TOP,sticky:true});}else{if(P.errno==111){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5f53\u524d\u6709\u4e00\u4e2a\u4fdd\u5b58\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\uff0c\u8bf7\u7a0d\u5019\u4fdd\u5b58",sticky:false,position:disk.ui.Panel.TOP,closeType:false});}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u4fdd\u5b58\u6210\u529f\uff0c<a style='color:blue;text-decoration:underline' href='//pan.baidu.com/disk/home#dir/path="+encodeURIComponent(C||"/")+"'>\u70b9\u51fb\u67e5\u770b</a>\u4fdd\u5b58\u7684\u6587\u4ef6",sticky:true,position:disk.ui.Panel.TOP,closeType:true});}}$.post(disk.api.RestAPI.MIS_COUNTER,{uk:R,filelist:$.stringify(I),sid:A,t:new Date().getTime(),_:Math.random(),ctime:FileUtils.share_ctime,"public":FileUtils.share_public_type});G._mMoveSaveDialog.refreshTree();}else{if(P.errno==111){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5f53\u524d\u6709\u4e00\u4e2a\u4fdd\u5b58\u4efb\u52a1\u6b63\u5728\u8fdb\u884c\uff0c\u8bf7\u7a0d\u5019\u4fdd\u5b58",sticky:false,position:disk.ui.Panel.TOP,closeType:false});}else{if(P.errno==12){var F=P.info,J=0,M=F.length,D,E;for(;J<M;J++){if(F[J].errno==0){continue;}var T=F[J],S=F[J].path,E=S.slice(S.lastIndexOf("/")+1);if(F[J].errno==-33){D="\u4e00\u6b21\u652f\u6301\u64cd\u4f5c"+(P.limit||2000)+"\u4e2a\uff0c\u51cf\u70b9\u8bd5\u8bd5\u5427";}else{D=disk.util.shareErrorMessage[F[J].errno];}D=D||"\u8bf7\u7a0d\u5019\u91cd\u8bd5";switch(F[J].errno){case-30:D+=' <a style="color:blue;text-decoration:underline" href="//pan.baidu.com/disk/home#dir/path='+S+'">\u70b9\u51fb\u67e5\u770b</a>';break;default:break;}break;}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,position:disk.ui.Panel.TOP,msg:"\u4fdd\u5b58\u5931\u8d25\uff0c"+D,sticky:true,closeType:true});}else{if(P.errno==5){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u4e0d\u7528\u8f6c\u7ed9\u81ea\u5df1\u5566",sticky:true,closeType:true});}else{if(P.errno==-33){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u652f\u6301\u64cd\u4f5c"+(P.limit||2000)+"\u4e2a\uff0c\u51cf\u70b9\u8bd5\u8bd5\u5427",sticky:true,closeType:true});}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4fdd\u5b58\u5931\u8d25\uff0c"+(disk.util.shareErrorMessage[P.errno]||"\u8bf7\u7a0d\u5019\u91cd\u8bd5"),sticky:true,closeType:true});}}}}}}}if(typeof L=="function"){L(P);}}});};G._mMoveSaveDialog.setVisible(true);FileUtils.sendUserReport("share_transfer");if(FileUtils._mUserInfo){FileUtils._mDiskLog.send({type:"login_transfer_activate"});}_.setVisible(false);}};for(var I=0,O=K.length;I<O;I++){var D=K[I],C=FileUtils.parseDirPath(D.path);M.push(C);}J(M);},toFriendlyFileSize:function(_){if(_<1024){return Math.round(_)+"B";}else{if(_<1024*1024&&_>=1024){return Math.round(_/1024)+"KB";}else{if(_<1024*1024*1024&&_>=1024*1024){return(_/1024/1024).toFixed(1)*10/10+"M";}else{return(_/1024/1024/1024).toFixed(2)*100/100+"G";}}}},switchToGrid:function(){if(this._mInfiniteListView){this._mInfiniteListView.awakeScrollbar(false);}if(this._mInfiniteListView!=null&&!this._mInfiniteListView.locked()){this._mInfiniteListView.lock(true,true);}$("#infiniteListView").css("display","none");$("#infiniteGridView").css("display","block");this.load(this.resolveCurrentDirKey(),true);$("#barCmdViewList").removeClass("select");},getViewMode:function(){return this._mViewMode;},switchViewMode:function(A,_){this._mLastViewMode=this._mViewMode;this._mViewMode=A;switch(A){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:FileUtils._mGridStep=Math.floor($("#header-shaw").outerWidth()/150)||2;$("#barCmdViewSmall").addClass("select");FileUtils.switchToGrid();break;case FileUtils.VIEW_LIST:default:if(FileUtils._mInfiniteGridView){this._mInfiniteGridView.awakeScrollbar(false);if(!this._mInfiniteGridView.locked()){this._mInfiniteGridView.lock(true,true);}}$("#infiniteGridView").css("display","none");$("#infiniteListView").css("display","block");if(FileUtils._mInfiniteListView){FileUtils._mInfiniteListView.lock(false,true);FileUtils._mInfiniteListView.awakeScrollbar(true);}this.load(this.resolveCurrentDirKey(),true);$("#barCmdViewList").addClass("select");$("#barCmdViewSmall").removeClass("select");break;}if(typeof this._mViewModeSwitchWatcher=="function"){this._mViewModeSwitchWatcher.call(this,A==FileUtils.VIEW_GRID_ICON||A==FileUtils.VIEW_GRID_THUMB);}},_listenTransferTriggers:function(_){var A=this;$(_).click(function(C){if(A.isListViewLocked()){return;}var _=this.parentNode.parentNode.parentNode.getAttribute("_position");if(typeof _!="undefined"){_=parseInt(_);var B=FileUtils.getElementData(_);FileUtils.transferFiles([B]);}C.preventDefault();C.stopPropagation();return false;});},_listenMoreTriggers:function(_){var A=this;$(_).click(function(A){$(this.parentNode).addClass("dd-hover");this.parentNode.parentNode.parentNode.style.zIndex="3";var _=MoreOptionsDropDown.obtain().attach(this);A.preventDefault();A.stopPropagation();return false;});$(_.parentNode).hover(function(){},function(){this.parentNode.parentNode.style.zIndex="1";$(this).removeClass("dd-hover");});},_listenMouseRightMenuTriggers:function(_){var A=this;_.oncontextmenu=function(F){var F=F||window.event||arguments[0],E=$(".input-cbx",this),D=this.getAttribute("_position");if(D!=null){D=parseInt(D);}if(A.isListViewLocked()||F.shiftKey){return;}if(!F.ctrlKey){switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(!A._mInfiniteGridView.isItemChecked(D)){$(".icon-item").removeClass("on");A._mInfiniteGridView.setItemsChecked(false);A._mInfiniteGridView.setItemChecked(D,true);$(this).addClass("on");E.addClass("input-cbx-on");}break;case FileUtils.VIEW_LIST:default:if(!A._mInfiniteListView.isItemChecked(D)){$(".file-item").removeClass("on");A._mInfiniteListView.setItemsChecked(false);$(".input-cbx").removeClass("input-cbx-on");A._mInfiniteListView.setItemChecked(D,true);$(this).addClass("on");E.addClass("input-cbx-on");}break;}}if(F.ctrlKey){if(D!=null){$(this).addClass("on");E.addClass("input-cbx-on");if(A._mInfiniteListView!=null){A._mInfiniteListView.setItemChecked(D,true);}if(A._mInfiniteGridView!=null){A._mInfiniteGridView.setItemChecked(D,true);}}}FileUtils.repaintListView();Page.obtain().resolveToolbarMenu();var B=0,C=0;if(F.pageX||F.pageY){B=F.pageY-1,C=F.pageX-1;}else{C=F.clientX+document.body.scrollLeft-document.body.clientLeft;B=F.clientY+document.body.scrollTop-document.body.clientTop;}if(FileUtils.getElementData(D).status==0){FileUtils._shareDropdownDrawerTrigger(this);}var _=$(this).get(0);if(!Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){A._resolveRightContextMenu(_,B,C);if(F.preventDefault){F.preventDefault();}if(F.stopPropagation){F.stopPropagation();}}else{return true;}return false;};},_resolveRightContextMenu:function(C,B,E){var F=MoreOptionsDropDown.obtain().attach(C,B,E),D=F._mUI.pane,A=false;$(D).find("li").removeClass("menu-separator b-bdr-7");$(D).find("li").each(function(B,_){if(B%2==0&&B>0){A=true;}if(A===true&&this.style.display!=="none"){$(this).addClass("menu-separator b-bdr-7");A=false;}});var _=this.getListViewCheckedItems();$(D).show();$(D).find("li a").css({"padding-left":"17px","text-align":"left","line-height":"22px"});$("body").bind("mousedown",this._hideRightMouseMenu);},_hideRightMouseMenu:function(){$("#right-context-menu").hide();$("body").unbind("mousedown",this._hideRightMouseMenu);},_listenRenameTriggers:function(_){var A=this;$(_).click(function(E){if(A.isListViewLocked()){return false;}var _=this.parentNode.parentNode.parentNode,B=_.getAttribute("_position");if(typeof B!="undefined"){B=parseInt(B);var C=FileUtils.getElementData(B);if(C){var D=FileUtils.parseDirPath(C.path);if(FileUtils.ifSpecialFolder(D)){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u9884\u7f6e\u6587\u4ef6\u5939\u4e0d\u53ef\u91cd\u547d\u540d",sticky:false});}else{FileUtils.prepareFolderBuilder(FileUtils.UPDATE,C,_,true);}}}if(E.preventDefault){E.preventDefault();E.stopPropagation();}else{E.cancelBubble=true;E.returnValue=false;}return false;});},_listenShareLinkTriggers:function(_){var A=this;$(_).click(function(C){if(A.isListViewLocked()){return;}var _=this.parentNode.parentNode.parentNode.getAttribute("_position");if(typeof _!="undefined"){_=parseInt(_);var B=FileUtils.getElementData(_);if(B){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u83b7\u53d6\u5730\u5740\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});$.post(disk.api.RestAPI.SINGLE_PUBLIC_URI,{path:FileUtils.parseDirPath(B.path)},function(B){var _=null;try{_=$.parseJSON(B);}catch(D){if(disk.DEBUG){console.log("[LOG]====>parse json error on get public uri",D.message);}}if(_==null||_.errno!=0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}else{disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);var C=_.url;if(A._mSingleURLDialog==null){A._mSingleURLDialog=new disk.ui.SingleURLDialog();}A._mSingleURLDialog.setURL(C);A._mSingleURLDialog.setVisible(true);}});}}if(C.preventDefault){C.preventDefault();C.stopPropagation();}else{C.cancelBubble=true;C.returnValue=false;}});},performCopyShareLink:function(_){var C=this;if(C.isListViewLocked()){return;}var A=_.getAttribute("_position");if(typeof A!="undefined"){A=parseInt(A);var B=FileUtils.getElementData(A);if(B){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u8bf7\u7a0d\u5019&hellip;",sticky:true});$.post(disk.api.RestAPI.SINGLE_PUBLIC_URI,{path:FileUtils.parseDirPath(B.path)},function(A){var _=null;try{_=$.parseJSON(A);}catch(D){if(disk.DEBUG){console.log("[LOG]====>parse json error on get public uri",D.message);}}if(_==null||_.errno!=0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}else{disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);var B=_.url;if(C._mSingleURLDialog==null){C._mSingleURLDialog=new disk.ui.SingleURLDialog();}C._mSingleURLDialog.setURL(B);C._mSingleURLDialog.setVisible(true);}});}}return false;},_listenCancelShareTriggers:function(A,_){var B=this;$(A).click(function(D){if(B.isListViewLocked()){return;}var A=this.parentNode.parentNode.parentNode.getAttribute("_position");if(typeof A!="undefined"){A=parseInt(A);var C=FileUtils.getElementData(A);if(C){FileUtils.cancelShare([C],_);}}if(D.preventDefault){D.preventDefault();D.stopPropagation();}else{D.cancelBubble=true;D.returnValue=false;}});},_listenCheckboxDoubleClickTriggers:function(_){$(_).dblclick(function(_){if(_.preventDefault){_.preventDefault();}if(_.stopPropagation){_.stopPropagation();}return false;});},_listenCheckboxTriggers:function(_){var A=this;_.onclick=function(I){var I=I||window.event||agruments[0],E=this.getAttribute("_position"),E=parseInt(E),F;if(FileUtils.isListViewLocked()){return false;}var _=(FileUtils._mViewMode==FileUtils.VIEW_LIST)?FileUtils._mInfiniteListView:FileUtils._mInfiniteGridView;if(!I.shiftKey){A._lastclick=this.getAttribute("_position");F=!_.isItemChecked(E);if($(".files-header").hasClass("on")){$(".files-header").removeClass("on");}if(E!=null){_.setItemChecked(E,F);}A._lastShiftClick=null;}else{var G=this.getAttribute("_position"),D=Math.min(G,A._lastclick),H=Math.max(G,A._lastclick);if(A._lastShiftClick){var C=Math.min(A._lastclick,A._lastShiftClick),B=Math.max(A._lastclick,A._lastShiftClick);while(C<=B){_.setItemChecked(C,false);C++;}}else{}while(D<=H){_.setItemChecked(D,true);D++;}A._lastShiftClick=this.getAttribute("_position");}FileUtils.repaintListView();A.changeProperty();Page.obtain().resolveToolbarMenu();if(I.preventDefault){I.preventDefault();I.stopPropagation();}else{I.cancelBubble=true;I.returnValue=false;}};},_listenDragFileTriggers:function(_){var A=this;if(Page.inViewMode(Page.VIEW_HOME)){$(_).mousedown(function(C){if(A.isListViewLocked()||$(this).hasClass("on")===false||A._mSelectionArbitrate.hasClass("on")||C.which!==1){return;}var _=(FileUtils._mViewMode==FileUtils.VIEW_LIST)?FileUtils._mInfiniteListView:FileUtils._mInfiniteGridView,B=_.getElementsData()[this.getAttribute("_position")];A.triggerDragFile(true);C.preventDefault();}).mouseup(function(F){if(A._mDraging!==true){return;}var _=(FileUtils._mViewMode==FileUtils.VIEW_LIST)?FileUtils._mInfiniteListView:FileUtils._mInfiniteGridView,D=_.getElementsData()[this.getAttribute("_position")];if(D.isdir===0||$(this).hasClass("on")===true){A.triggerDragFile(false);return;}Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u79fb\u52a8\u6587\u4ef6\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});var E=FileUtils.parseDirPath(D.path),B=FileUtils.getListViewCheckedItems(),C=E==disk.util.DirectoryLocation.DIR_ROOT?"/":E;FileUtils.sendMoveCopyFileMessage(disk.ui.MoveCopyDialog.MOVE,B,C,function(H){var G=$.parseJSON(H);if(G.errno==0){if(disk.DEBUG){console.log("move files success, prepare to update local cache");}for(var D=0,C=B.length;D<C;D++){A._mLocalCache.preseveAndDescendentlyRemove(A.resolveCurrentDirKey(),FileUtils.parseDirPath(B[D].path));}if(A._mViewMode==FileUtils.VIEW_LIST){A._mInfiniteListView.updateBackedData(A._mLocalCache.obtain(A.resolveCurrentDirKey()));}else{var _=A.setGroupData(A._mLocalCache.obtain(A.resolveCurrentDirKey()),A._mGridStep);if(A._mInfiniteGridView!=null){A._mInfiniteGridView.updateBackedData(_);}}FileUtils.getLocalCache().removeCategorys();FileUtils.resolveParentDirEmptyState(E);FileUtils.getLocalCache().remove(FileUtils.resolveDirKey(E));Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u79fb\u52a8\u6587\u4ef6\u6210\u529f\u3002",sticky:false});return;}else{if(G.errno==12){Page.obtain().dealCopyMoveBatchCallback(G,disk.ui.MoveCopyDialog.MOVE);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());return;}else{var F=disk.util.ErrorMessage[G.errno]||"\u672a\u77e5\u9519\u8bef\uff0cerrno:"+G.errno;Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:F,sticky:false});}}Page.obtain().resolveToolbarMenu();FileUtils.changeProperty();});});}},_shareDropdownDrawerTrigger:function(D,A,E){if(!Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)&&!Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){return;}var F=this,_=".share-warn",C=this.getListViewCheckedItems(),B=E?E:0;$(_).hide(E);FileUtils._mDropdownDrawerFlag=FileUtils._mDropdownDrawerFlag==-1?-1:0;if(A){$(_).attr("emulate-lost-selection","1");return;}if(C.length==1){$(_,D).show(E);F._initClipboard(D);}},_checkIsBuyFile:function(_){_=_||"";return false;},_initClipboard:function(B){var I=this,_=FileUtils.getListViewCheckedItems()[0],G=_.shareId,A=_.passwd,D=Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)?FileUtils.sysUK_Master:FileUtils.sysUK,E=Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)?encodeURI(disk.getParam("third")):FileUtils.third,C;if(_.shorturl){C="http://"+location.host+"/s/"+_.shorturl;}else{C="http://"+location.host+"/share/link?shareid="+G+"&uk="+D;}C=E==0?C:C+"&third="+E;C=A!=="0"?"\u94fe\u63a5:"+C+" \u63d0\u53d6\u5bc6\u7801:"+A:C;var H=function(){var _=new ZeroClipboard.Client();try{if(_!=null){I._shareflash=_;I._shareflash.setText(C);$(".share_copy_btn",B).removeClass("disabled");_.setHandCursor(true);_.addEventListener("complete",function(_){$(".share_copy_btn",B).removeClass("bbtn-active bbtn-hover");Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u590d\u5236\u5230\u526a\u5207\u677f\u4e86\uff0c\u7c98\u8d34\u7ed9\u60a8\u7684\u670b\u53cb\u5427",sticky:false});I.setVisible(false);});_.addEventListener("mouseOver",function(_){$(".share_copy_btn",B).addClass("bbtn-hover");});_.addEventListener("mouseOut",function(_){$(".share_copy_btn",B).removeClass("bbtn-active bbtn-hover");});_.addEventListener("mouseDown",function(_){$(".share_copy_btn",B).addClass("bbtn-active");});_.addEventListener("mouseUp",function(_){$(".share_copy_btn",B).removeClass("bbtn-active");});_.glue("share_copy_id","share_copyouter_id");$(".share_copy_btn",B).next().click(function(_){if(_.preventDefault){_.preventDefault();_.stopPropagation();}else{_.cancelBubble=true;_.returnValue=false;}});}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u52a0\u8f7d\u590d\u5236\u7ec4\u4ef6\u5931\u8d25\uff0c\u8bf7\u624b\u52a8\u590d\u5236\u8f93\u5165\u6846\u4e2d\u7684\u94fe\u63a5",sticky:true,closeType:true});}}catch(A){}},F=function(){I=this;$("#share_copy_id").removeAttr("id");$(".share_copy_btn",B).addClass("disabled");$(".share_copy_btn",B).attr("id","share_copy_id");$(".share_copy_btn",B).removeClass("disabled");$(".share_copy_btn",B).click(function(_){window.clipboardData.setData("Text",$(this).attr("_link"));Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u590d\u5236\u5230\u526a\u5207\u677f\u4e86\uff0c\u7c98\u8d34\u7ed9\u60a8\u7684\u670b\u53cb\u5427\u3002",sticky:false});if(_.preventDefault){_.preventDefault();_.stopPropagation();}else{_.cancelBubble=true;_.returnValue=false;}});};$(".share_copy_btn",B).attr("_link",C);if(typeof window.clipboardData!="undefined"){if(!$(".share_copy_btn",B).attr("_install")){F();$(".share_copy_btn",B).attr("_install",1);}FileUtils._mDropdownDrawerFlag=1;}else{$("#share_copy_id").length&&$("#share_copy_id").parent()[0].removeChild($("#share_copy_id").next()[0]);$("#share_copy_id").removeAttr("id");$("#share_copyouter_id").removeAttr("id");$(".share_copy_btn",B).addClass("disabled");$(".share-warn-tit div:first",B).attr("id","share_copyouter_id");$(".share_copy_btn",B).attr("id","share_copy_id");if(this._mDropdownDrawerFlag==-1){$.getScript("/res/static/js/plug/ZeroClipboard.js",function(_){ZeroClipboard.setMoviePath("/res/static/images/ZeroClipboard10.swf");H();});}else{H();}FileUtils._mDropdownDrawerFlag=1;return;}},_listenClickTriggers:function(_){var A=this;$(_).click(function(S){var T=$(".input-cbx",this),E=parseInt(this.getAttribute("_position")),F=S.target||S;A._mSelectionArbitrate.removeClass("on");var I=$(".share-warn").attr("emulate-lost-selection")=="1";$(".share-warn").removeAttr("emulate-lost-selection");if(A.isListViewLocked()){return;}var _=(FileUtils._mViewMode===FileUtils.VIEW_LIST)?A._mInfiniteListView:A._mInfiniteGridView;if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){var L=$(this).hasClass("on")&&_.getCheckedItems().length===1;_.setItemsChecked(false);$(".file-item").removeClass("on");if(L){A._shareDropdownDrawerTrigger(this);$(this).removeClass("on");return;}_.setItemChecked(E,true);$(this).addClass("on");}else{if(!S.ctrlKey&&!S.shiftKey){L=$(this).hasClass("on")&&_.getCheckedItems().length===1&&!I;A._lastclick=this.getAttribute("_position");_.setItemsChecked(false);switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:$(".icon-item").removeClass("on");break;case FileUtils.VIEW_LIST:default:$(".file-item").removeClass("on");break;}if(L){if(F.className.match(/icon/)){A._shareDropdownDrawerTrigger(this);Page.obtain().resolveToolbarMenu();}else{A._shareDropdownDrawerTrigger(this);Page.obtain().resolveToolbarMenu();return;}}_.setItemChecked(E,true);$(this).addClass("on");A._lastShiftClick=null;if(F.className.match(/icon/)){if(F.className.indexOf("disabled")!=-1){return;}if(F.className=="icon-more-sfile"){$(F).next().show();Page.obtain().resolveToolbarMenu();}Page.obtain().resolveToolbarMenu();var R=A.getElementData(E),O=FileUtils.isTopParticularDir(FileUtils.parseDirPath(R.path||R.typicalPath)),C=F.parentNode.getElementsByTagName("div");if(C){for(var M=0,B=C.length;M<B;M++){var K=C[M].className;if(K.indexOf("icon-rename")==0||K.indexOf("icon-move")==0||K.indexOf("icon-delete")==0){if(O){$(C[M]).addClass("disabled");}else{$(C[M]).removeClass("disabled");}}}}var G=F.getAttribute("_i");if(G==null&&F.className!="icon-more-sfile"){throw new Error("Menu Not Registered");}G=parseInt(G);var Q=Page.obtain().dispatchActionPerformed(G,this,S);if(!Q){if(disk.DEBUG){console.log("Suppress a download event, hand it over");}return false;}return true;}}else{if(!S.shiftKey){A._lastclick=this.getAttribute("_position");_.setItemChecked(E,!_.isItemChecked(E));$(this).toggleClass("on");A._lastShiftClick=null;}else{var H=this.getAttribute("_position"),P=Math.min(H,A._lastclick),J=Math.max(H,A._lastclick);if(A._lastShiftClick){var D=Math.min(A._lastclick,A._lastShiftClick),N=Math.max(A._lastclick,A._lastShiftClick);while(D<=N){_.setItemChecked(D,false);D++;}}else{}while(P<=J){_.setItemChecked(P,true);P++;}A._lastShiftClick=this.getAttribute("_position");FileUtils.repaintListView();}}}if(FileUtils.getElementData(E).status==0&&FileUtils.getElementData(E).tag!=7){FileUtils._shareDropdownDrawerTrigger(this);}Page.obtain().resolveToolbarMenu();});},getElementDataByView:function(_,B){var C=null;if(_==null){return C;}var A=_.getBackedData();switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:C=A[Math.floor(B/FileUtils._mGridStep)][B%FileUtils._mGridStep];break;case FileUtils.VIEW_LIST:default:C=A[B];break;}return C;},getElementData:function(A){var B=null;switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(FileUtils._mInfiniteGridView!=null){var _=FileUtils._mInfiniteGridView.getBackedData();B=_[Math.floor(A/FileUtils._mGridStep)][A%FileUtils._mGridStep];}break;case FileUtils.VIEW_LIST:default:if(FileUtils._mInfiniteListView!=null){_=FileUtils._mInfiniteListView.getBackedData();B=_[A];}break;}return B;},_listenFolderOpenTriggers:function(_,B){var A=this;$(_).click(function(B){var _=this;FileUtils.anchorFoldOpen(B,A,_);if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){return true;}B.preventDefault();});if(typeof B!="undefined"){$(B).click(function(B){var _=$(".b-no-ln",this);if(_){FileUtils.anchorFoldOpen(B,A,_[0]);}if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){return true;}B.preventDefault();return false;});}},_listenListViewItemDoubleClick:function(_){var A=this;if(typeof _!="undefined"){$(_).dblclick(function(B){FileUtils.anchorFoldOpen(B,A,_);if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){return true;}B.preventDefault();return false;});}},anchorFoldOpen:function(D,I,F){var H=D||window.event||arguments[0];if($(F).hasClass("opening")){if(disk.DEBUG){console.log("dbclick return");}return false;}$(F).addClass("opening");setTimeout(function(){$(F).removeClass("opening");},1000);if(H.ctrlKey||H.shiftKey){H.preventDefault();return false;}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){return true;}}if(I._mQuerying){return;}if(I.isListViewLocked()){return false;}var C=F.getAttribute("_position");if(C!=null){C=parseInt(C);var E=I.getElementData(C);if(E){if(E.isdir){I.switchLayoutMode(FileUtils.MODE_NORMAL);I._mPendingRequestShareProperty=(E.property=="-1")?null:E.property;I.deactivateListView(true);if(F.className.indexOf("path")){var A=E.path;}else{A=E.path.slice(0,E.path.lastIndexOf("/"));}FileUtils.historyNavigate(A==disk.util.DirectoryLocation.DIR_ROOT?{}:{path:A});if(typeof H.stopPropagation!="undefined"){H.stopPropagation();}else{H.cancelBubble=true;}}else{if(F.className.indexOf("path")){if(this._mMboxPlayer!=null&&E.category==2&&H.button==0){this._mMboxPlayer.shake();}if(this._mMboxPlayer!=null&&E.category==2&&this._mMboxPlayer._mSwitchAni){I.initAddSong(F);}if(this._mMboxPlayer!=null&&E.category==2&&H.button==1){I.initAddBackSong(F);}var B=unify.st.Bootstrap.getPageWindow(),_=-1,G=null;E.category=parseInt(E.category,10);switch(E.category){case Category.MUS:_=unify.app.HomePageWindow.FEATURE_MUSIC_PLAYER_2;G=unify.app.HomePageWindow.FEATURE_MUSIC_PLAYER_PATH;break;default:Category[E.category](E,H,C);break;}if(G!=null){B.asyncCall(_,G,function(){Category[E.category](E,H,C);});}if(E.category!=Category.OTH&&E.category!=Category.MOV&&E.category!=Category.APP){if(typeof H.stopPropagation!="undefined"){H.stopPropagation();}else{H.cancelBubble=true;}}}else{A=E.path.slice(0,E.path.lastIndexOf("/"));FileUtils.historyNavigate(A==disk.util.DirectoryLocation.DIR_ROOT?{}:{path:A});}}}}return false;},clearCurrentDirCache:function(){if(this._mDirMgr.atRoot()){this._mLocalCache.removeAll();}else{this._mLocalCache.descendentlyRemove(this.resolveCurrentDirKey());}},lockActiveRenderingView:function(A){var _=(this._mViewMode==FileUtils.VIEW_LIST)?this._mInfiniteListView:this._mInfiniteGridView;if(_==null){return;}if(A===true){if(!_.locked()){_.lock(true);}}else{_.lock(false);}},prepareFolderBuilder:function(D,E,M,G){var N=disk.ui.FolderBuilder.getDefault();if(N.isVisible()){N.focus();N.select();return;}var H=this,L=null,O=null,J=null,P=null;if(D==FileUtils.UPDATE){N.setIgnoreTrailingExt(E.isdir==1);L=M;switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(!G&&!this._mInfiniteGridView.isFirstCheckedChildVisible()){this._mInfiniteGridView.scrollToPositionEx(this._mInfiniteGridView.getFirstCheckedIndex());L=this._mInfiniteGridView.getFirstCheckedChild();}break;case FileUtils.VIEW_LIST:default:if(!G&&!this._mInfiniteListView.isFirstCheckedChildVisible()){var R=this._mInfiniteListView.getFirstCheckedIndex(),C=this._mInfiniteListView.getCount();R=Math.max(1,R);if(C>1){R=Math.min(C-1,R);}this._mInfiniteListView.scrollToPosition(R);L=this._mInfiniteListView.getFirstCheckedChild();}break;}switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:this.setGridViewFileNameVisiable(false,L);J=L;P=$("a:last",J);O=P.text();break;case FileUtils.VIEW_LIST:default:J=L.getElementsByTagName("div")[0];P=$(".file-handler",J);O=P.attr("title");P.css("display","none");$(".inline-commands",J).css("display","none");break;}}else{switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(H._mInfiniteGridView!=null){this._mInfiniteGridView.onSystemNotify(disk.ui.RecycleListView.NOTIFY_LIST_EMPTY,false);this._mInfiniteGridView.scrollToPosition(1);var K=this._mLocalCache.obtain(this.resolveCurrentDirKey()),A=K==null?[]:K,I=Math.round(new Date().getTime()/1000);A.unshift({isdir:1,ctime:I,modify_time:I,path:"",size:0,dir_empty:1,empty:1});var _=this.setGroupData(A,this._mGridStep);this._onLoadGridView(_);var F=this._mInfiniteGridView.getRenderingChildAt(0).childNodes[0],Q=F.getElementsByTagName("div")[1];this.setGridViewFileNameVisiable(false,F);J=F;}break;case FileUtils.VIEW_LIST:default:if(H._mInfiniteListView!=null){this._mInfiniteListView.onSystemNotify(disk.ui.RecycleListView.NOTIFY_LIST_EMPTY,false);this._mInfiniteListView.scrollToPosition(1);L=document.createElement("dd");L.className="clearfix file-item";L.innerHTML='<div class="file-col col"><span style="display:none" class="inline-commands b-btn clearfix"></span><span class="inline-file-col d"><a href="javascript:;" class="b-in-blk sprite-ic input-cbx"><dfn><s class="sprite"></s></dfn></a><span class="b-in-blk sprite-list-ic b-ic-book"></span></span></div><div class="size-col col"><span>-</span></div><div class="time-col col"><span>-</span></div>';var B=this._mInfiniteListView.getRenderingChildAt(0);if(B==null){FileUtils._mFileListDOM.appendChild(L);}else{FileUtils._mFileListDOM.insertBefore(L,B);}J=L.getElementsByTagName("div")[0];}break;}}$(L).addClass("auto");var S=J.getElementsByTagName("span")[2];N.onAttach=function(A,_){if(A){$(".input-cbx",_).addClass("list-cbx-fix");$(S).addClass("list-icon-fix");}else{$(".input-cbx",_).removeClass("list-cbx-fix");$(S).removeClass("list-icon-fix");}};N.attach($("a:last",J).parent().get(0),function(I,F){if(H._mQuerying){return;}var N=this;if(I==disk.ui.FolderBuilder.POSITIVE){if(D==FileUtils.UPDATE){if(F==O){N.setVisible(false);N.detach();switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:H.setGridViewFileNameVisiable(true,L);H.lockActiveRenderingView(false);break;case FileUtils.VIEW_LIST:default:P.css("display","");P.text(O);$(L).removeClass("auto");$(".inline-commands",J).css("display","");H.lockActiveRenderingView(false);break;}return;}Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u91cd\u547d\u540d\u6587\u4ef6"+(L.getAttribute("dir")==1?"\u5939":"")+"&hellip;",sticky:true});var G=E.path,A=(FileUtils._mViewMode==FileUtils.VIEW_LIST)?FileUtils._mInfiniteListView:FileUtils._mInfiniteGridView;H._mQuerying=true;H.sendUpdateFileMessage(E.isdir==1,G,F,function(D){H._mQuerying=false;try{var C=$.parseJSON(D);if(C.errno==0){switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:H.setGridViewFileNameVisiable(true,L);break;case FileUtils.VIEW_LIST:default:P.css("display","");break;}P.text(F);H.lockActiveRenderingView(false);var B=FileUtils.resolveNewName(L.getAttribute("dir")==1,G,F,true);$(".inline-commands",J).css("display","");$(L).removeClass("auto");N.setVisible(false);N.detach();var _=disk.Context.getService(disk.Context.SERVICE_TOAST);_.setVisible(false);if(FileUtils.getModule()=="category"||FileUtils.inSearchMode()){_.pending(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u91cd\u547d\u540d\u6210\u529f",sticky:false});});if(FileUtils.getModule()=="category"){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.clearAllDocData();FileUtils.triggerType(H._mType);}else{H.pendingHighlights([FileUtils.parseDirPath(B)]);FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.clearAllDocData();FileUtils.issueProxyLoading(true,false);var R=FileUtils.resolveCurrentDirKey();FileUtils.loadDir(FileUtils.resolveCurrentDirKey());}Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e&hellip;",sticky:true});}else{var M=disk.util.FileCache.KEY_MODE_NORMAL,Q=FileUtils.resolveCurrentDirKey(),K=FileUtils.getLocalCache().renameByMode(M,Q,E,B,F);if(K){FileUtils.clearAllDocData();var I=FileUtils.getListView();I.setItemsChecked(false);D=FileUtils.getLocalCache().obtainByMode(M,Q);if(H._mViewMode!=FileUtils.VIEW_LIST){D=H.setGroupData(D,H._mGridStep);}I.updateBackedData(D);Page.obtain().resolveToolbarMenu();}Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u91cd\u547d\u540d\u6210\u529f",sticky:false});}}else{if(C.errno==-8||C.errno==-9||C.info[0].errno==-8||C.info[0].errno==-9){var S="\u540d\u79f0\u5df2\u5728\u4f7f\u7528\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u540d\u79f0";if(C.errno==12&&C.info[0]&&C.info[0].errno==-9){S="\u91cd\u547d\u540d\u5931\u8d25\uff0c\u6587\u4ef6\u5df2\u88ab\u5220\u9664\u6216\u79fb\u8d70";}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:S,sticky:false});}else{N.setVisible(false);N.detach();$(L).removeClass("auto");Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6(\u5939)\u91cd\u547d\u540d\u5931\u8d25, \u7f51\u7edc\u9519\u8bef",sticky:false});P.css("display","");P.text(O);$(".inline-commands",J).css("display","");H.lockActiveRenderingView(false);}}}catch(T){N.setVisible(false);N.detach();Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6(\u5939)\u91cd\u547d\u540d\u5931\u8d25, \u7f51\u7edc\u9519\u8bef",sticky:false});P.css("display","");P.text(O);$(".inline-commands",J).css("display","");A.lock(false);}});}else{var M=H._mDirMgr.getDir()+"/"+F;Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u521b\u5efa\u6587\u4ef6\u5939&hellip;",sticky:true});H._mQuerying=true;H.sendCreateNewFileMessage(M,"",1,null,function(E){H._mQuerying=false;try{var D=$.parseJSON(E),_=D.mtime,I=D.path,F=I;if(D.errno==0){if(FileUtils._mViewMode==FileUtils.VIEW_GRID_ICON||FileUtils._mViewMode==FileUtils.VIEW_GRID_THUMB){var B=H._mLocalCache.obtain(H.resolveCurrentDirKey()),A=B==null?[]:B;A.shift();}var G=FileUtils.resolveParentDirSharedProperty(),_=Math.round(new Date().getTime()/1000);H._mLocalCache.insert(H.resolveCurrentDirKey(),{isdir:1,local_ctime:D.ctime,server_ctime:D.ctime,server_mtime:D.mtime,local_mtime:D.mtime,path:F,status:D.status,fs_id:D.fs_id,size:0,dir_empty:1,empty:1});H._mFileFilter.addRule(FileUtils.parseDirFromPath(I));H.resolveParentDirEmptyState(H.resolveCurrentDirKey());H.pendingHighlights([FileUtils.parseDirPath(I)]);N.setVisible(false);N.detach();switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:if(H._mInfiniteGridView!=null){var C=H._mInfiniteGridView.getRenderingChildAt(0).childNodes[0];H._mInfiniteGridView.setItemsChecked(false);H.setGridViewFileNameVisiable(true,C);H.lockActiveRenderingView(false);FileUtils.load(FileUtils.resolveCurrentDirKey());}break;case FileUtils.VIEW_LIST:default:if(H._mInfiniteListView!=null){L.parentNode.removeChild(L);H.lockActiveRenderingView(false);FileUtils.load(FileUtils.resolveCurrentDirKey());}break;}Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u521b\u5efa\u6587\u4ef6\u5939\u6210\u529f",sticky:false});}else{if(D.errno==-8){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u540d\u79f0\u5df2\u5728\u4f7f\u7528\uff0c\u8bf7\u4f7f\u7528\u5176\u4ed6\u540d\u79f0",sticky:false});}else{N.setVisible(false);N.detach();if(FileUtils._mViewMode==FileUtils.VIEW_LIST){L.parentNode.removeChild(L);}H.lockActiveRenderingView(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:D.errno==102?"\u7b2c\u4e09\u65b9\u5e94\u7528\u76ee\u5f55\u4e0b\u4e0d\u5141\u8bb8\u521b\u5efa\u76ee\u5f55":"\u6587\u4ef6\u5939\u521b\u5efa\u5931\u8d25, \u7f51\u7edc\u9519\u8bef",sticky:false});}}}catch(J){N.setVisible(false);N.detach();if(FileUtils._mViewMode==FileUtils.VIEW_LIST){L.parentNode.removeChild(L);}H.lockActiveRenderingView(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6\u5939\u521b\u5efa\u5931\u8d25, \u7f51\u7edc\u9519\u8bef",sticky:false});}});}}else{if(I==disk.ui.FolderBuilder.ILLEGAL){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6(\u5939)\u540d\u683c\u5f0f\u4e0d\u6b63\u786e",sticky:false});}else{switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:H.lockActiveRenderingView(false);N.setVisible(false);N.detach();if(D!=FileUtils.UPDATE){var C=H._mLocalCache.obtain(H.resolveCurrentDirKey()),B=C==null?[]:C;B.shift();var _=H.setGroupData(B,H._mGridStep);H._onLoadGridView(_);if(_.length!=0){var K=H._mInfiniteGridView.getRenderingChildAt(0).childNodes[0];H._mInfiniteGridView.setItemsChecked(false);H.setGridViewFileNameVisiable(true,K);}}else{H.setGridViewFileNameVisiable(true,L);}if(H._mInfiniteGridView.getCount()==0){H._mInfiniteGridView.onSystemNotify(disk.ui.RecycleListView.NOTIFY_LIST_EMPTY,true);}break;case FileUtils.VIEW_LIST:default:H.lockActiveRenderingView(false);N.setVisible(false);N.detach();if(D!=FileUtils.UPDATE){L.parentNode.removeChild(L);}else{$(".inline-commands",J).css("display","");P.css("display","");$(L).removeClass("auto");}if(H._mInfiniteListView.getCount()==0){H._mInfiniteListView.onSystemNotify(disk.ui.RecycleListView.NOTIFY_LIST_EMPTY,true);}break;}}}}).setVisible(true);N.setUseShortStyle(false);if(FileUtils._mViewMode==FileUtils.VIEW_GRID_ICON){(N._mTextField).attr("size",1);}else{if(this._mViewMode==FileUtils.VIEW_GRID_THUMB){(N._mTextField).attr("size",1);N._mTextField.css("width","100px");}else{N._mTextField.removeAttr("style");N.setUseShortStyle(false);}}if(O!=null){N.setText(O);}N.focus();N.select();H.lockActiveRenderingView(true);},setGridViewFileNameVisiable:function(B,C){if(FileUtils._mViewMode==FileUtils.VIEW_GRID_ICON||FileUtils._mViewMode==FileUtils.VIEW_GRID_THUMB){var A=C.getElementsByTagName("a")[0],_=C.getElementsByTagName("a")[1];if(B){$(A).css("display","");$(_).css("display","");}else{$(A).css("display","none");$(_).css("display","none");}}},resolveParentDirSharedProperty:function(_){return-1;},resolveParentDirEmptyState:function(E){if(E==disk.util.DirectoryLocation.DIR_ROOT){return;}var D=FileUtils.resolveDirKey(E.substring(0,E.lastIndexOf("/"))),B=this._mLocalCache.obtain(D);if(!B){return;}for(var C=0,A=B.length;C<A;C++){var _=B[C];if(E==FileUtils.parseDirPath(_.path)){_.empty=0;_.dir_empty=0;if(disk.DEBUG){console.log("found a parent dir and set it to not empty state");}break;}}},resolveNewName:function(B,E,C,A){var _=E.substring(0,E.lastIndexOf("/"))+"/",D=B?C:C;if(A){D=_+D;}return D;},sendCreateNewFileMessage:function(B,A,D,C,_){$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.CREATE,FileUtils.bdstoken),{path:B,isdir:D,size:A,block_list:C?'["'+C+'"]':"[]",method:"post"},_);},sendUpdateFileMessage:function(A,C,B,_){C=this.parseDirPath(C);$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.FILE_MANAGER+"&opera=rename",FileUtils.bdstoken),{filelist:$.stringify([{path:C,newname:this.resolveNewName(A,C,B)}])},_);},sendSearchMessage:function(B,A,_){$.get(disk.api.RestAPI.SEARCH+"&dir=&key="+encodeURIComponent(A)+"&recursion&timeStamp="+Math.random(),_);},sendMoveCopyFileMessage:function(J,E,I,D){var F=[],H=null,C=[],A,G;for(var B=0,_=E.length;B<_;B++){H=E[B].path;A=this.parseDirPath(H);G=this.parseDirFromPath(H);F.push({path:A,dest:I,newname:G});C.push(I=="/"?I+G:I+"/"+G);}this.pendingHighlights(C);$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.FILE_MANAGER+"&opera="+(J?"move":"copy"),FileUtils.bdstoken),{filelist:$.stringify(F)},D);},resolveFileIcon:function(B,A,_){var E="",F,C,D=A+1;(D&1)&&(E+="share-");(D&2)&&(E+="public-");filetype=B?"d":"f";E+=filetype;!B&&_&&(E+=" f"+(Category.iconMap[_.toLowerCase()]||Category.OTH));return E;},resolveFileSmallIcon:function(D,J,C,_,A,F){var H="",I=0,E=0,G=0;if(_){if(J&&J.constructor==Array&&((G=J.length)>1||G==0)){_.css("backgroundPosition",G==0?"-38px -48px":"-38px -24px");return;}if(D){if(A==FileUtils.PART_KID_FOLDER){switch(FileUtils.PARTICULAR_DIR_MAP[F]){case FileUtils.PARTICULAR_DIR_MAP["/apps"]:_.css("backgroundPosition","-38px 0px");break;case FileUtils.PARTICULAR_DIR_MAP["/\u6765\u81eaPC\u7684\u5907\u4efd\u6587\u4ef6"]:_.css("backgroundPosition","-116px 0px");break;case FileUtils.PARTICULAR_DIR_MAP["/\u767e\u5ea6\u4e91\u6536\u85cf"]:_.css("backgroundPosition","-197px 0px");break;case FileUtils.PARTICULAR_DIR_MAP["/\u6211\u7684\u5206\u4eab"]:_.css("backgroundPosition","-238px 0px");break;case FileUtils.PARTICULAR_DIR_MAP["/\u6211\u7684\u4f5c\u54c1"]:_.css("backgroundPosition","-278px 0px");break;default:_.css("backgroundPosition","-38px 0px");break;}return;}E=0;}else{E=-80;}if(!D&&C){var B=Category.iconMap[C.toLowerCase()]||Category.OTH,I=Category.iconMap_X[B];switch(B){case 70:E=-102;break;}}_.css("backgroundPosition",I+"px "+E+"px");}},resolveFileBigIcon:function(A,_){var B="tl-";B+=A?"folder":"file";!A&&_&&(B+=" f"+(Category.iconMap[_.toLowerCase()]||Category.OTH));return B;},resolveFileGridIcon:function(D,C,B,_,A,F,G,E){if(D){if(A==FileUtils.PART_KID_FOLDER){switch(FileUtils.PARTICULAR_DIR_MAP[G]){case FileUtils.PARTICULAR_DIR_MAP["/apps"]:$(_).parent().css("backgroundPosition","-159px 0px");break;case FileUtils.PARTICULAR_DIR_MAP["/\u6765\u81eaPC\u7684\u5907\u4efd\u6587\u4ef6"]:$(_).parent().css("backgroundPosition","-317px 0");break;case FileUtils.PARTICULAR_DIR_MAP["/\u767e\u5ea6\u4e91\u6536\u85cf"]:$(_).parent().css("backgroundPosition","-798px 0");break;case FileUtils.PARTICULAR_DIR_MAP["/\u6211\u7684\u5206\u4eab"]:$(_).parent().css("backgroundPosition","-959px 0");break;case FileUtils.PARTICULAR_DIR_MAP["/\u6211\u7684\u4f5c\u54c1"]:$(_).parent().css("backgroundPosition","-1122px 0");break;default:$(_).parent().css("backgroundPosition","0 0");break;}}else{$(_).parent().css("backgroundPosition","0 0");}return"tl-folder";}var I="tl-",J=y=0,H=E.thumbs&&E.thumbs.url1||(F+"&method=view&type=jpg&height=82&quality=100");bcolor="#d1d1d1";positionStep=0;p=C+1;switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_THUMB:positionStep=153;break;case FileUtils.VIEW_GRID_ICON:default:positionStep=153;break;}I+=D?"folder":"file";!D&&B&&(I+=" f"+(Category.iconMap[B.toLowerCase()]||Category.OTH));if(_){if(D){J=-1;y=-5;(p==1)&&(y=-2*positionStep-5);(p==2)&&(y=-positionStep-5);(p==3)&&(y=-positionStep-5);}else{J=0;y=0;(p==1)&&(y=-104);(p==2)&&(y=-208);(p==3)&&(y=-208);}if(FileUtils._mViewMode==FileUtils.VIEW_GRID_THUMB){y+=5;}if(!D&&B){switch(Category.iconMap[B.toLowerCase()]||Category.OTH){case Category.Excel:J=-2*positionStep;bcolor="#bce5bb";break;case Category.Word:J=-3*positionStep;bcolor="#c9ecf8";break;case Category.Ppt:J=-4*positionStep;bcolor="#f1d8a3";break;case Category.Visio:J=-5*positionStep;bcolor="#d7e0ee";break;case Category.Pdf:J=-6*positionStep;bcolor="#efdddd";break;case Category.Doc_oth:case Category.Txt:J=-7*positionStep;bcolor="#e5e5e5";break;case Category.Exe:J=-9*positionStep;bcolor="#cee5ea";break;case Category.Apk:J=-8*positionStep;bcolor="#bce5bb";break;case Category.Ipa:J=-10*positionStep;bcolor="#d1d1d1";break;case Category.MOV:J=-11*positionStep;bcolor="#b9dcff";break;case Category.MUS:J=-12*positionStep;bcolor="#f5c077";break;case Category.Torrent:J=-13*positionStep;bcolor="#f5c077";break;case Category.Zip:J=-1*positionStep;bcolor="#dad0fa";break;case Category.Rar:J=-14*positionStep;bcolor="#dad0fa";break;case Category.Psd:J=-15*positionStep;bcolor="#007acb";break;case Category.Key:J=-16*positionStep;bcolor="#007acb";break;case Category.Dmg:J=-17*positionStep;bcolor="#007acb";break;case Category.Ai:J=-18*positionStep;bcolor="#007acb";break;case Category.Cad:y=-96;break;case Category.Mmap:J=-1*positionStep;y=-95;break;case Category.Xmind:J=-2*positionStep;y=-96;break;case Category.Mm:J=-3*positionStep;y=-96;break;}}$(_).css("backgroundPosition",J+"px "+y+"px");$(_).next(".file-name").css("borderColor","#c6c6c6");}return I;},scheduleHidingHighlight:function(){if(this._mHighlightTimer==null){this._mHighlightTimer=new disk.util.TimerService(3000,function(){$(FileUtils._mFileListDOM).removeClass("highlight-on");$(FileUtils._mFileGridDOM).removeClass("highlight-on");});}if(this._mHighlightTimer.isAlive()){this._mHighlightTimer.interrupt();}this._mHighlightTimer.start();},isListViewLocked:function(){if(this._mViewMode==FileUtils.VIEW_LIST){return(this._mInfiniteListView!=null)?this._mInfiniteListView.locked():false;}else{return this._mInfiniteGridView!=null?this._mInfiniteGridView.locked():false;}},_translatePendingFilesIndexes:function(A){var F=[],G=this._mPendingHighlights,C=-1;if(G.length==0||A.length==0){return;}var E;for(var B=0,_=A.length;B<_;B++){E=this.parseDirPath(A[B].path);for(var D=0,H=G.length;D<H;D++){if(E==G[D]){F[B]=true;if(C==-1){C=B;}}}}this._mPendingHighlightIndexes=(F.length>0)?F:null;this._mPendingHighlightFirst=C;if(disk.DEBUG){console.log("[LOG]translate selection ",this._mPendingHighlightIndexes);}},setInnerText:(typeof window.attachEvent!="undefined")?function(A,_){A.innerText=_;}:function(A,_){A.textContent=_;},setGroupData:function(A,F){var D=A==null?0:A.length;if(D==0){return[];}var C=new Array(),_=0;while(D>F){C[_]=[];for(var B=0;B<F;B++){C[_].push(A[_*F+B]);}_++;D-=F;}if(D>0){C[_]=[];}var E=0;while(D>0){C[_].push(A[_*F+E]);D--;E++;}return C;},getFileListDOM:function(){return this._mFileListDOM;},_onLoadGridView:function(_,A){this.setDisplaySortColsHeader(false);if(this._mInfiniteGridView==null){var B=this;this._mInfiniteGridView=new disk.ui.RecycleListView({listContainer:document.getElementById("infiniteGridView"),tracker:document.getElementById("scrollbarTrackerGrid"),thumb:document.getElementById("scrollbarThumbGrid"),upArrow:document.getElementById("scrollbarArrowUpGrid"),downArrow:document.getElementById("scrollbarArrowDownGrid"),scrollbar:document.getElementById("scrollbarGrid")},{flags:disk.ui.RecycleListView.USING_MOUSE_WHEEL_SENSOR|disk.ui.RecycleListView.USING_SCROLLBAR|disk.ui.RecycleListView.USING_KEYBOARD_DISPATCHER});if(this._mInfiniteListView&&this._mInfiniteListView.isAllItemChecked()){this._mInfiniteGridView.setItemsChecked(true);}this._mInfiniteGridView.gridStep=this._mGridStep;this._mInfiniteGridView.setDebugAlias("GridView");this._mInfiniteGridView.getElementsData=function(){var D=[];for(var A=0,_=this._mElementsData.length;A<_;A++){for(var B=0,C=this._mElementsData[A].length;B<C;B++){D.push(this._mElementsData[A][B]);}}return D;};this._mInfiniteGridView.setItemChecked=function(B,C){this._mCheckedChildren[B]=C;var D=(this._mPrivateFlags&disk.ui.RecycleListView.CHECKED_ALL)==disk.ui.RecycleListView.CHECKED_ALL;if(!C&&D){this._mPrivateFlags&=~disk.ui.RecycleListView.CHECKED_ALL;for(var A=0,_=this.getElementsData().length;A<_;A++){if(A!=B){this._mCheckedChildren[A]=true;}}}};this._mInfiniteGridView.getCheckedItems=function(){var E=[];if(!this._mElementsData){return E;}if(this.isAllItemChecked()){for(var A=0,_=this._mElementsData.length;A<_;A++){for(var D=0,F=this._mElementsData[A].length;D<F;D++){E.push(this._mElementsData[A][D]);}}return E;}var B=this._mElementsData.length;for(A=0,_=this._mCheckedChildren.length;A<_;A++){if(this._mCheckedChildren[A]===true){var C=Math.floor(A/FileUtils._mGridStep);if(C>=B){break;}E.push(this._mElementsData[C][A%FileUtils._mGridStep]);}}return E;};this._mInfiniteGridView.getFirstCheckedChild=function(){for(var A=0,_=this._mCheckedChildren.length;A<_;A++){if(this._mCheckedChildren[A]===true){if(Math.floor(A/FileUtils._mGridStep)>=this._mFirstPosition&&Math.abs(Math.floor(A/FileUtils._mGridStep)-this._mFirstPosition)<this._mChildren.length){return this._mChildren[Math.floor(A/FileUtils._mGridStep)-this._mFirstPosition].childNodes[A%FileUtils._mGridStep];}else{return null;}}}return null;};this._mInfiniteGridView.getView=function(U,G,C){var _=G;if(_==null){_=this.buildView(U,G,C);}var S=FileUtils._mGridStep,E=_.getElementsByTagName("div"),H=this._mElementsData[C];for(var K=0;K<H.length;++K){E[4*K].style.display="block";E[4*K].className="clearfix icon-item";switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_THUMB:$(E[4*K]).addClass("icon-item-big");break;case FileUtils.VIEW_GRID_ICON:default:$(E[4*K]).removeClass("icon-item-big");break;}E[4*K].setAttribute("_position",C*S+K);iconDiv=E[2+4*K];$(iconDiv).removeAttr("style");var D=this._mElementsData[C][K],R=D.path,P=FileUtils.getNormalizedPath(FileUtils.parseDirPath(R),true);D.isdir=D.isdir-0;var A=null;if(FileUtils.isInParticularDir(FileUtils.parseDirPath(R))){A=FileUtils.PART_KID_FOLDER;if(D.category=="3"){A=FileUtils.PART_KID_IMAGE;}}var F=FileUtils.resolveFileGridIcon(D.isdir,D.property,R.slice(R.lastIndexOf(".")),iconDiv,A,D.docpreview,R,D),J=null;if(F.indexOf("tl-file f3")!=-1){if(D.thumbs!=null){switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_THUMB:J=D.thumbs.url2;break;case FileUtils.VIEW_GRID_ICON:default:J=D.thumbs.url1.replace("c140_u90","c94_u94");break;}}if(J==null||J==""){$(iconDiv).css({background:"url(/res/static/images/default_new.png) 50% 50% no-repeat",border:"#bebebe 1px solid",width:"94px",height:"94px"});$(iconDiv).next(".file-name").css({borderColor:"#bebebe"});}else{$(iconDiv).css({background:"url("+J+") 50% 50% no-repeat",width:"94px",height:"94px"});$(iconDiv).next(".file-name").css({borderColor:"#bebebe"});}}var Q=$(iconDiv);Q.find(".grid-view-video-thumb").remove();Q.find(".grid-view-video-arrow").remove();var T=Q.next(".file-name").removeClass("video").removeClass("grid-view-video-name-icon");if(D.category==Category.MOV&&(Page.inViewMode(Page.VIEW_HOME)||Page.inViewMode(Page.VIEW_PROPERTY_OTHER))){if(Q.find(".grid-view-video-thumb").length==0){Q.css({position:"relative"});var I=disk.ui.Utilities.getThumbnail(D,{width:105,height:84});$('<span class="grid-view-video-thumb"></span>').css({background:'50% 50% no-repeat url("'+I+'")'}).appendTo(Q);if(Page.inViewMode(Page.VIEW_HOME)||Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){$('<span class="grid-view-video-arrow sprite"></span>').appendTo(Q);}}T.addClass("grid-view-video-name-icon");}if(D.isdir){$(iconDiv).parent().addClass("tl-folder");iconDiv.className="thumb-large";}else{$(iconDiv).parent().removeClass("tl-folder");iconDiv.className="thumb-grid "+F;}iconDiv.style.cursor="pointer";if(D.isdir){}else{}fileDiv=E[3+4*K];var N=fileDiv.getElementsByTagName("a"),M=N[0],L=N[1];if(D.isdir||D.category=="4"||D.category=="2"||D.category=="3"||D.category==Category.MOV||FileUtils.acceptOpenFileTypes(R.slice(R.lastIndexOf(".")))){L.style.cursor="pointer";}else{L.style.cursor="default";L.style.textDecoration="none";}M.setAttribute("_position",C*S+K);L.setAttribute("_position",C*S+K);M.parentNode.parentNode.title=P;if(this.isItemChecked(C*S+K)){M.className="b-in-blk input-cbx";$(E[4*K]).addClass("on");}else{M.className="b-in-blk input-cbx";$(E[4*K]).removeClass("on");}B.setInnerText(L,P);if(!E[4*K].getAttribute("_installed")){B._listenCheckboxTriggers(M);B._listenClickTriggers(E[4*K]);FileUtils._listenMouseMovement(E[4*K]);B._listenMouseRightMenuTriggers(E[4*K]);if(!Page.inViewMode(Page.VIEW_RECYCLE_BIN)){B._listenFolderOpenTriggers(L,E[4*K]);B._listenDragFileTriggers(E[4*K]);}E[4*K].setAttribute("_installed","1");}if(H.length!=S){for(var O=H.length;O<S;++O){E[4*O].style.display="none";}}if(B._mPendingHighlightIndexes!=null&&B._mPendingHighlightIndexes[C*S+K]===true){$(E[4*K]).addClass("highlight");}else{$(E[4*K]).removeClass("highlight");}}return _;};this._mInfiniteGridView.buildView=function(F,G,C){var D=document.createElement("dd");D.className="clearfix";var E=FileUtils._mGridStep,A=[];for(var _=0;_<E;++_){var B=['<div><div class="thumb-holder"><div class="thumb-large"><em class="ic-shr-plc"></em><s class="file-3-party"></s></div>'];B.push('<div class="file-name"><a hidefocus="true" unselectable="on" href="javascript:;" class="b-in-blk input-cbx"><dfn><s class="sprite"></s></dfn></a><a class="b-no-ln file-handler" href="javascript:;"></a></div></div></div>');A.push(B.join(""));}D.innerHTML=A.join("");return D;};this._mInfiniteGridView.isFirstCheckedChildVisible=function(){for(var A=0,_=this._mCheckedChildren.length;A<_;A++){if(this.isItemChecked(A)){return(A/FileUtils._mGridStep)>=this._mFirstPosition&&(A/FileUtils._mGridStep)<(this._mFirstPosition+this._mChildren.length);}}return false;};this._mInfiniteGridView.scrollToPositionEx=function(_){var A=Math.floor(_/B._mGridStep)+1;if(A>=this._mElementsData.length){A=this._mElementsData.length-1;}A=Math.max(1,A);return this.scrollToPosition(A);};this._mInfiniteGridView.getCountEx=function(){var B=0;if(this._mElementsData==null){return B;}for(var A=0,_=this._mElementsData.length;A<_;A++){B+=this._mElementsData[A].length;}return B;};this._mInfiniteGridView.onSystemNotify=this._onSystemNotify;this._mInfiniteGridView.activateKeyguard(true);this._mInfiniteGridView.onComputeScrollbarState=function(D,A,_){disk.ui.RecycleListView.prototype.onComputeScrollbarState.call(this,D,A,_);if(A>0&&this.getCount()>0&&!B._mQuerying){var C=parseFloat((A+_)/this.getCount(),10);if(C>0.7){var E=null;if(FileUtils.inSearchMode()){}else{if(B._mModule=="category"){E=B._mCategoryProxyLoader;}else{E=B._mProxyLoader;}}if(E&&!E.isIdle()){E.load();}if(E){E.endShowMsg(true);}}}};this._mInfiniteGridView.getScrollbar(true).awake(true);if(A===true){this.importCheckedStateBetweenViews();}this._mInfiniteGridView.setBackedData(_);}else{if(this._mInfiniteGridView.locked()){this._mInfiniteGridView.lock(false,true);}this._mInfiniteGridView.awakeScrollbar(true);if(A===true){this.importCheckedStateBetweenViews();this._mInfiniteGridView.setBooleanFlag(disk.ui.RecycleListView.PRESERVE_CHECKED_STATE,true);this._mInfiniteGridView.dispatchDataChanged();this._mInfiniteGridView.setBackedData(_);this._mInfiniteGridView.setBooleanFlag(disk.ui.RecycleListView.PRESERVE_CHECKED_STATE,false);}else{this._mInfiniteGridView.changeBackedData(_,true);}}},setDisplaySortColsHeader:function(_){if($("#fileActionHeader").css("display")!=="none"||_==this._mSortColsDisplayed){return;}$(".files-header").hide();if(_){$("#sortColsHeader").show();}else{$("#fileThumbHeader").show();}this._mSortColsDisplayed=_;Utilities.resolveLayout();},importCheckedStateBetweenViews:function(_){if((this._mViewMode==FileUtils.VIEW_GRID_ICON&&this._mLastViewMode==FileUtils.VIEW_GRID_THUMB)||(this._mViewMode==FileUtils.VIEW_GRID_THUMB&&this._mLastViewMode==FileUtils.VIEW_GRID_ICON)){if(disk.DEBUG){console.log("Fall into same view mode, no need to import checked state");}return;}var B=this._mInfiniteListView,A=this._mInfiniteGridView;if(B==null||A==null){return;}if(_===true){B.importCheckedState(A);}else{A.importCheckedState(B);}},_onLoadListView:function(_,A){var B=this;this.setDisplaySortColsHeader(true);if(this._mInfiniteListView==null){this._mInfiniteListView=new disk.ui.RecycleListView({listContainer:document.getElementById("infiniteListView"),tracker:document.getElementById("scrollbarTracker"),thumb:document.getElementById("scrollbarThumb"),upArrow:document.getElementById("scrollbarArrowUp"),downArrow:document.getElementById("scrollbarArrowDown"),scrollbar:document.getElementById("scrollbar")},{flags:disk.ui.RecycleListView.USING_MOUSE_WHEEL_SENSOR|disk.ui.RecycleListView.USING_SCROLLBAR|disk.ui.RecycleListView.USING_KEYBOARD_DISPATCHER|disk.ui.RecycleListView.USING_TOUCH_SENSOR});if(this._mInfiniteGridView&&this._mInfiniteGridView.isAllItemChecked()){this._mInfiniteListView.setItemsChecked(true);}this._mInfiniteListView.getView=(function(){var _=function(M,E,_,J,K,A){_=E;if(_==null){_=this.buildView(M,E,A);}_.setAttribute("_position",A);_.className="clearfix file-item";var F=_.getElementsByTagName("span"),C=1,N=F[C];if(N.className.indexOf("inline-file-col")==-1){C++;N=F[C];}var L=F[C+1];L.style.cursor="pointer";var I=N.parentNode.parentNode.getElementsByTagName("a"),H=I[1];J=="\u5206\u4eab\u7684\u6587\u4ef6\u5df2\u88ab\u5220\u9664"?$(H).css("color","#aaa"):$(H).css("color","#000");$(H).attr("title",J);FileUtils.setInnerText(H,J);pathHandler=I[2];var G=I[0];H.setAttribute("_position",A);pathHandler.setAttribute("_position",A);G.setAttribute("_position",A);L.setAttribute("_position",A);G.parentNode.parentNode.title=J;var D=F[0].getElementsByTagName("a");if(!_.getAttribute("_cmd_installed")){FileUtils._listenMouseMovement(_);B._listenMouseRightMenuTriggers(_);_.setAttribute("_cmd_installed",1);}if(this.isAllItemChecked()||this.isItemChecked(A)){G.className="b-in-blk input-cbx";$(_).addClass("on");}else{G.className="b-in-blk input-cbx";$(_).removeClass("on");}if(B._mPendingHighlightIndexes!=null&&B._mPendingHighlightIndexes[A]===true){$(_).addClass("highlight");}else{$(_).removeClass("highlight");}return{view:_,txtHandler:H,pathHandler:pathHandler,iconSpan:L,checkbox:G,spans:F,txtSpan:N,spanStart:C};};if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){return function(N,J,C){var O=disk.ui.ShareDialog,U=this._mElementsData[C],M=U.typicalPath||U.path,f=Utilities.toDateString(U.server_mtime||U.ctime),g=FileUtils.getNormalizedPath(FileUtils.parseDirPath(M),true),i=U.vCnt,G=U.dCnt,V=U.tCnt,L=U.passwd,P=U.channelInfo,H=U.status,h=Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)?FileUtils.sysUK_Master:FileUtils.sysUK,Y=Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)?encodeURI(disk.getParam("third")):FileUtils.third,d;if(U.shorturl){d="http://"+location.host+"/s/"+U.shorturl;}else{d="http://"+location.host+"/share/link?shareid="+U.shareId+"&uk="+h;}d=Y==0?d:d+"&third="+Y;U.public=U.public||0;if(U.fsIds.length>1){g+="\u7b49";}var Z="";if(U.public==FileUtils.SHARE_PUBLIC_LINK){if(U.channel==FileUtils.SHARE_CHANNEL_PUBLIC_SNS){Z="\u516c\u5f00\u5206\u4eab";}else{Z="\u516c\u5f00\u94fe\u63a5";}}else{if(U.channel==FileUtils.SHARE_CHANNEL_MAIL){Z="\u90ae\u4ef6";}else{if(U.channel==FileUtils.SHARE_CHANNEL_SNS){Z="\u77ed\u4fe1";}else{Z="\u79c1\u5bc6\u94fe\u63a5";}}}var Q='<a class="sl-a" target="_blank" href=\''+d+"'>"+d+"</a>",e=_.call(this,N,J,R,g,M,C),R=e.view,a=e.txtHandler,j=e.iconSpan,b=e.checkbox,I=e.spans,k=e.txtSpan,W=e.spanStart;a.style.cursor="pointer";if(!a.getAttribute("_installed")){B._listenFolderOpenTriggers(a);B._listenFolderOpenTriggers(pathHandler);B._listenFolderOpenTriggers(j);B._listenListViewItemDoubleClick(R);B._listenClickTriggers(R,H);B._listenCheckboxTriggers(b);B._listenCheckboxDoubleClickTriggers(b);a.setAttribute("_installed","1");}var A="";I[3].innerHTML=f;I[4].innerHTML=i+"\u6b21";I[5].innerHTML=V+"\u6b21";I[6].innerHTML=G+"\u6b21";if((H==0)&(parseInt(U.tag)!==7)){I[9].innerHTML=Q;I[13].innerHTML="";(U.channel==FileUtils.SHARE_CHANNEL_PUBLIC_LINK||U.channel==FileUtils.SHARE_CHANNEL_PUBLIC_SNS||U.channel==FileUtils.SHARE_CHANNEL_PRIVATE_LINK)?I[13].innerHTML="\u5206\u4eab\u7c7b\u578b:"+Z:I[14].innerHTML=Z;$(a).attr({href:d,target:"_blank"});var c=I[12].innerHTML=L;c=="0"?$(I[12]).parent().hide():$(I[12]).parent().show();var X=I[15].innerHTML=P.length,T=$(I[15]).parent().parent();X==0?T.hide():T.show();for(var K=0;K<X;K++){A+="<span>"+P[K]+"</span>";}I[16].innerHTML=A;$(a).prev().hide();$(".action-dd",R).show();$(a).removeClass("mis-examining");}else{$(a).attr({href:d,target:"_blank"});$(".action-dd",R).hide();$(a).addClass("mis-examining");var D=H==2?{clas:"mis-examining",html:"(\u5ba1\u6838\u4e2d)"}:{clas:"mis-examined",html:"(\u5206\u4eab\u5931\u8d25)"};if(parseInt(U.tag)===7){D=H={clas:"mis-examined",html:"(\u5df2\u5c4f\u853d)"};$(a).css("color","#aaa");var E="\u60a8\u5206\u4eab\u6587\u4ef6\u4e2d\u6709\u7591\u4f3c\u8fdd\u89c4\u8d44\u6e90\u5df2\u5c4f\u853d\u3002\u51c0\u5316\u7f51\u7edc\u73af\u5883\uff0c\u4e25\u7981\u5206\u4eab\u8272\u60c5\u3001\u53cd\u52a8\u3001\u4f4e\u4fd7\u3001\u4fb5\u6743\u7b49\u6709\u5bb3\u4fe1\u606f\uff0c\u611f\u8c22\u60a8\u7684\u652f\u6301!";$(a).attr("title",E);$(a).parent().parent().attr("title",E);}$(a).prev().show().attr("class",D.clas).html(D.html);}FileUtils.setInnerText(a,g);U.property=-1;if(U.typicalCategory==-1){U.isdir=1;}else{U.category=U.typicalCategory;}if(U.fsIds.length>1){U.property=2;}var S=null;if(FileUtils.isInParticularDir(FileUtils.parseDirPath(M))){S=FileUtils.PART_KID_FOLDER;if(U.category=="3"){S=FileUtils.PART_KID_IMAGE;}}var F=FileUtils.resolveFileSmallIcon(U.isdir,U.fsIds,M.slice(M.lastIndexOf(".")),$(".b-ic-book",k),S,M);k.className="inline-file-col";if(typeof(U.public)!="undefined"&&U.public!=1){$(k).find("em").addClass("share-type-private").attr("title","\u79c1\u5bc6\u5206\u4eab");}else{$(k).find("em").removeClass("share-type-private").attr("title","\u516c\u5f00\u5206\u4eab");}if(B._mPendingHighlightIndexes!=null&&B._mPendingHighlightIndexes[C]===true){$(R).addClass("highlight");}else{$(R).removeClass("highlight");}return R;};}else{return function(J,F,D){var N=this._mElementsData[D],I=N.path,Q=I.lastIndexOf("/"),R=I.slice(0,I.lastIndexOf("/"));N.isdir=(N.isdir-0);var H=(N.isdir?"-":FileUtils.toFriendlyFileSize(N.size)),V=Utilities.toDateString(N.server_mtime||N.ctime),W=FileUtils.getNormalizedPath(FileUtils.parseDirPath(I),true),A=W,C=document.body.className,U=_.call(this,J,F,K,W,I,D),K=U.view,S=U.txtHandler,P=U.pathHandler,X=U.iconSpan,T=U.checkbox,G=U.spans,Y=U.txtSpan,O=U.spanStart;$(P).attr("title",R?R:"/\u5168\u90e8\u6587\u4ef6");FileUtils.setInnerText(P,R?R.slice(R.lastIndexOf("/")+1):"\u5168\u90e8\u6587\u4ef6");var L=Page.inViewMode(Page.VIEW_RECYCLE_BIN);if(!L&&(N.isdir||N.category=="4"||N.category=="2"||N.category=="3"||FileUtils.acceptOpenFileTypes(I.slice(I.lastIndexOf("."))))){S.className="file-handler b-no-ln dir-handler";S.style.cursor="pointer";}else{if((Page.inViewMode(Page.VIEW_HOME)||Page.inViewMode(Page.VIEW_PROPERTY_OTHER))&&N.category==Category.MOV){S.className="file-handler b-no-ln dir-handler";S.style.cursor="pointer";}else{S.className="file-handler b-ig-ln";S.style.cursor="default";}}if(!S.getAttribute("_installed")){if(!L){B._listenFolderOpenTriggers(S);B._listenFolderOpenTriggers(P);B._listenFolderOpenTriggers(X);B._listenDragFileTriggers(K);B._listenListViewItemDoubleClick(K);}B._listenClickTriggers(K);B._listenCheckboxTriggers(T);B._listenCheckboxDoubleClickTriggers(T);S.setAttribute("_installed","1");}O+=2;G[O].innerHTML=H;$(G[O]).css("line-height","37px");O++;G[O].innerHTML=V;$(G[O]).css("line-height","37px");var M=null;if(FileUtils.isInParticularDir(FileUtils.parseDirPath(I))){M=FileUtils.PART_KID_FOLDER;if(N.category=="3"){M=FileUtils.PART_KID_IMAGE;}}var E=FileUtils.resolveFileSmallIcon(N.isdir,N.fsIds,I.slice(I.lastIndexOf(".")),$(".b-ic-book",Y),M,I);Y.className="inline-file-col";if(C.indexOf("flag-6")!=-1){if(typeof N.dateDiff=="undefined"){N.dateDiff=Utilities.dateDiff(N.server_mtime*1000,FileUtils.systemTimestamp);}G[G.length-1].innerHTML=N.dateDiff+"\u5929";$(G[G.length-1]).css("line-height","37px");}return K;};}})();this._mInfiniteListView.buildView=function(E,F,B){var C=document.createElement("dd");C.className="clearfix file-item";var A=['<div class="file-col col">'],_=document.body.className,D=false;if(Page.inViewMode(Page.VIEW_HOME)){A.push('<span class="inline-commands b-btn clearfix"><div class="more-btn"><ul><li class="sell-sfile" title="\u51fa\u552e"><em class="icon-item-sellfile" _i="16"></em></li><li class="user-public" title="\u5206\u4eab"><em class="icon-share" _i="2"></em></li><li class="down-sfile" title="\u4e0b\u8f7d"><em class="icon-download" _i="8"></em></li><li class="more-sfile" title="\u66f4\u591a"><em class="icon-more-sfile"></em><div class="more-sfile-menu" title="\u66f4\u591a"><div class="more-sfile-inner"><div class="icon-move-sfile" _i="5" _data="move" title="\u79fb\u52a8\u5230">\u79fb\u52a8\u5230</div><div class="icon-copy-sfile" _i="4"  _data="copy" title="\u590d\u5236\u5230">\u590d\u5236\u5230</div><div class="icon-rename-sfile" _i="0" title="\u91cd\u547d\u540d">\u91cd\u547d\u540d</div><div class="icon-delete-sfile" _i="1" title="\u5220\u9664">\u5220\u9664</div></div></div></li></ul></div></span>');}else{if(_.indexOf("flag-2")!=-1&&document.getElementById("barAllCmdTransfer")){A.push('<span class="inline-commands b-btn clearfix"><div class="more-btn"><ul><li class="tomyrom-sfile" title="\u4fdd\u5b58\u81f3\u6211\u7684\u767e\u5ea6\u4e91"><em class="icon-tomyram" _i="1"></em></li><li class="down-sfile" title="\u4e0b\u8f7d"><em class="icon-download" _i="0"></em></li></ul></div></span>');}else{if(_.indexOf("flag-2")!=-1&&document.getElementById("cancelButton")){A.push('<span class="inline-commands b-btn clearfix"><div class="more-btn"><ul><li class="down-sfile" title="\u4e0b\u8f7d"><em class="icon-download" _i="0"></em></li></ul></div></span>');}else{if(_.indexOf("flag-4")!=-1){A.push('<span class="inline-commands b-btn clearfix"><div class="more-btn"><ul><li class="share-cancle" title="\u53d6\u6d88\u5206\u4eab"><em class="icon-share-cancle" _i="0"></em></li></ul></div></span>');}else{if(_.indexOf("flag-5")!=-1){A.push('<span class="inline-commands b-btn clearfix"></span>');}else{if(_.indexOf("flag-6")!=-1){A.push('<span class="inline-commands b-btn clearfix"><div class="more-btn"><ul><li class="reduction-sfile" title="\u8fd8\u539f"><em class="icon-reduction" _i="0"></em></li><li class="clear-sfile" title="\u5f7b\u5e95\u5220\u9664"><em class="icon-clear-file" _i="1"></em></li></ul></div></span>');D=true;}else{A.push('<span class="inline-commands b-btn clearfix"></span>');}}}}}}if(_.indexOf("flag-4")!=-1||_.indexOf("flag-10")!=-1){A.push('<span class="inline-file-col"><a hidefocus="true" unselectable="on" href="javascript:;" class="b-in-blk input-cbx"><dfn><s class="sprite"></s></dfn></a><em class="b-in-blk share-type-ic" title="\u5206\u4eab\u7c7b\u578b"></em><span class="b-in-blk sprite-list-ic b-ic-book"></span><s></s><a hidefocus="true" unselectable="on" class="file-handler b-no-ln dir-handler" href="javascript:;"></a></span>');A.push('</div><div class="time-col col"><span></span></div><div class="size-col col"><span></span></div>');D=true;}else{A.push('<span class="inline-file-col"><a hidefocus="true" unselectable="on" href="javascript:;" class="b-in-blk input-cbx"><dfn><s class="sprite"></s></dfn></a><span class="b-in-blk sprite-list-ic b-ic-book"><s></s></span><a hidefocus="true" unselectable="on" class="file-handler b-no-ln dir-handler" href="javascript:;"></a></span>');A.push('</div><div class="size-col col"><span></span></div><div class="time-col col"><span></span></div><div class="pathing-col col"><a hidefocus="true" unselectable="on" class="path-handler b-no-ln dir-handler" href="javascript:;"></a></div>');}if(D){if(_.indexOf("flag-4")!=-1||_.indexOf("flag-10")!=-1){A.push('<div class="remaining-col col"><span>-</span></div><div class="remaining-col col"><span class="d-cnt">-</span><span class="b-in-blk sprite-ic action-dd"></span></div><div class="share-warn"><div class="share-warn-tit"><div class="share-copy-outer"><span class="sl-tit">\u94fe\u63a5\uff1a</span><span class="sl-url">-</span><span class="sl-pwd"><span class="sl-pwd-tit">\u63d0\u53d6\u5bc6\u7801\uff1a</span><span class="sl-yzm">-</span></span><span class="share-style"></span><a href="javascript:;" hidefocus="true" class="bbtn share_copy_btn" _i="0"><em class="icon-copy"></em><b>\u590d\u5236</b></a></div></div><div class="share-warn-cnt"><div class="sl-fr">\u79c1\u5bc6\u5206\u4eab\uff1a<span class="share-style2"></span>(<span>0</span>\u4e2a)</div><div class="sl-fr-rul"><span></span></div></div></div>');}else{A.push('<div class="remaining-col col"><span>-</span></div>');}}C.innerHTML=A.join("");return C;};this._mInfiniteListView.getIdForPosition=function(_){return this._mElementsData[_].fs_id;};this._mInfiniteListView.lookupPositionForId=function(C){var A=this._mElementsData;for(var B=0,_=A.length;B<_;B++){if(A[B].fs_id==C){return B;}}return-1;};this._mInfiniteListView.isFirstCheckedChildVisible=function(){for(var A=0,_=this._mCheckedChildren.length;A<_;A++){if(this.isItemChecked(A)){return A>=this._mFirstPosition&&A<this._mFirstPosition+this._mChildren.length;}}return false;};if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){this._mInfiniteListView.onScroll=function(A,_){var B=this;if(FileUtils._mDropdownDrawerFlag==1){FileUtils._shareDropdownDrawerTrigger(null,true,200);setTimeout(function(){B.onScroll(A,_);},400);return;}disk.ui.RecycleListView.prototype.onScroll.call(this,A,_);};}this._mInfiniteListView.onComputeScrollbarState=function(D,A,_){disk.ui.RecycleListView.prototype.onComputeScrollbarState.call(this,D,A,_);if(A>0&&this.getCount()>0&&!B._mQuerying){var C=parseFloat((A+_)/this.getCount(),10);if(C>0.7){var E=null;if(FileUtils.inSearchMode()){}else{if(B._mModule=="category"){E=B._mCategoryProxyLoader;}else{E=B._mProxyLoader;}}if(E&&!E.isIdle()){E.load();}if(E){E.endShowMsg(true);}}}if(typeof FileUtils._whenListScrolledCallBack=="function"){FileUtils._whenListScrolledCallBack();}};this._mInfiniteListView.onSystemNotify=this._onSystemNotify;this._mInfiniteListView.activateKeyguard(true);this._mInfiniteListView.getScrollbar(true).awake(true);if(A===true){this.importCheckedStateBetweenViews(true);}this._mInfiniteListView.setBackedData(_);}else{this._mInfiniteListView.lock(false,true);this._mInfiniteListView.awakeScrollbar(true);if(A===true){this.importCheckedStateBetweenViews(true);this._mInfiniteListView.setBooleanFlag(disk.ui.RecycleListView.PRESERVE_CHECKED_STATE,true);}this._mInfiniteListView.changeBackedData(_);if(A===true){this._mInfiniteListView.setBooleanFlag(disk.ui.RecycleListView.PRESERVE_CHECKED_STATE,false);}}},_onSystemNotify:function(C,F,B){switch(C){case disk.ui.RecycleListView.NOTIFY_SYSTEM_LOCK:if(F){$("#panInner").addClass("lock");}else{$("#panInner").removeClass("lock");}Page.obtain().resolveToolbarMenu(F);break;case disk.ui.RecycleListView.NOTIFY_LIST_EMPTY:if(F&&$("#fileList .no-result-title").length>0){return;}$("#inifiniteListViewEmptyNote").html(B===true?"\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019&hellip;":"\u6ca1\u6709\u6570\u636e");$("#inifiniteListViewEmptyNote").css("display",F?"block":"none");if(F){$(".files-header").hide();if(FileUtils._mViewMode==FileUtils.VIEW_GRID_ICON){$("#fileThumbHeader").show();}else{if(FileUtils.inSearchMode()){$("#sortColsHeader").show();$(".all-files-headers,#infiniteListView").addClass("searchMode");}else{$("#sortColsHeader").show();$(".all-files-headers,#infiniteListView").removeClass("searchMode");}}}break;case disk.ui.RecycleListView.NOTIFY_LIST_REPAINT:if(disk.DEBUG){console.log("List Repainting");}var E=(FileUtils.getViewMode()==FileUtils.VIEW_LIST)?this.getCount():this.getCountEx(),D=null,_=null,A=null;if(FileUtils.inSearchMode()){}else{if(FileUtils.getModule()=="category"){D=FileUtils.getCategoryProxyLoader();}else{D=FileUtils.getProxyLoader();if(D!=null){A=D.getTag();}}}if(A!=null&&A!=FileUtils.resolveCurrentDirKey()){D=null;}if(D!=null&&D.hasMorePage()){_=E==0?"\u6b63\u5728\u52a0\u8f7d\u6587\u4ef6hellip;":"\u5df2\u52a0\u8f7d"+E+"\u4e2a";$("#dirData .loadedDate").html("\u5df2\u52a0\u8f7d"+E+"\u4e2a");}else{if(D!=null&&!D.hasMorePage()){_=E==0?"\u7a7a\u6587\u4ef6\u5939":"\u5217\u8868\u52a0\u8f7d\u5b8c\u6bd5\uff0c\u5171"+E+"\u4e2a";$("#dirData .loadedDate").html("\u5df2\u5168\u90e8\u52a0\u8f7d\uff0c\u5171"+E+"\u4e2a");}else{_=E==0?"\u6b63\u5728\u52a0\u8f7d\u6587\u4ef6hellip;":"\u5217\u8868\u52a0\u8f7d\u5b8c\u6bd5\uff0c\u5171"+E+"\u4e2a";$("#dirData .loadedDate").html("\u5df2\u5168\u90e8\u52a0\u8f7d\uff0c\u5171"+E+"\u4e2a");}}if($(".files-header").hasClass("on")){$("#file_action_word").text("\u5df2\u9009\u4e2d"+E+(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)?"\u4e2a\u5916\u94fe":"\u4e2a\u6587\u4ef6/\u6587\u4ef6\u5939"));}break;}},initIntr:function(A,_,B){return;if(B<3){if(disk.DEBUG){console.log("Error on InitIntr: all < 3 !");}return;}if(A==0){this.buildIntr(B,1);return;}},buildIntr:function(A,_){},load:function(F,B){this.deactivateListView(false);var E=this,A=this._mLocalCache.obtain(F),C=this._mPendingHighlights!=null;if(C){this._translatePendingFilesIndexes(A);}if(!FileUtils._mFileListDOM){FileUtils._mFileListDOM=document.getElementById("infiniteListView");this._mSelectionArbitrate=$(".files-header");$(".selectionArbitrate",this._mSelectionArbitrate).click(function(B){if(E.isListViewLocked()){return;}$(".files-header").toggleClass("on");var _=$(".files-header").hasClass("on"),A=E._mInfiniteListView;if(A){A.setItemsChecked(_);}if(E._mInfiniteGridView){E._mInfiniteGridView.setItemsChecked(_);}FileUtils.repaintListView();E.changeProperty();Page.obtain().resolveToolbarMenu();return false;});}if(!FileUtils._mFileGridDOM){FileUtils._mFileGridDOM=document.getElementById("infiniteGridView");}if(this._mViewMode==FileUtils.VIEW_LIST){if(disk.DEBUG){console.log("Switch to list mode, last view mode is ",this._mLastViewMode);}this._onLoadListView(A,B);}else{if(disk.DEBUG){console.log("Switch to grid mode, last view mode is ",this._mLastViewMode);}var _=this.setGroupData(A,this._mGridStep);this._onLoadGridView(_,B);}if(C){if(disk.DEBUG){console.log("[LOG]#####has to test highlight, too bad,===> ",this._mPendingHighlightFirst);}$(FileUtils._mFileListDOM).addClass("highlight-on");$(FileUtils._mFileGridDOM).addClass("highlight-on");this.scheduleHidingHighlight();if(this._mViewMode==FileUtils.VIEW_LIST){if(this._mPendingHighlightFirst!=-1&&!this._mInfiniteListView.hitInVisibleRegion(this._mPendingHighlightFirst)){if(disk.DEBUG){console.log("[LOG]first highlighted item is not in visible region, we has to scroll");}var D=Math.min(Math.max(1,this._mPendingHighlightFirst+1),this._mInfiniteListView.getCount()-1);this._mInfiniteListView.scrollToPosition(D);}}else{if(this._mPendingHighlightFirst!=-1){this._mInfiniteGridView.scrollToPositionEx(this._mPendingHighlightFirst+1);}}}this._mPendingHighlights=null;this._mPendingHighlightIndexes=null;this._mPendingHighlightFirst=-1;this._afterListLoad(A);Page.obtain().resolveToolbarMenu();unify.st.Bootstrap.getPageWindow().sendListViewReady();},changeProperty:function(_){},childProperty:function(C){var _=0,B=C.list.length,A=$("#property-share-p");A.html("");while(_<B){A.append('<span class="property-share-p">'+C.list[_]+"</span>");_++;if(_>4){A.append('<span class="property-share-p">\u2026\u2026</span>');break;}}},historyNavigate:function(_){return disk.util.HistoryManager.getDefault().navigate(FileUtils.MODULE_DIR,_);},_listenMouseMovement:function(_){_.onmouseover=function(){if((FileUtils._mInfiniteListView!=null&&!FileUtils._mInfiniteListView.locked())||(FileUtils._mInfiniteGridView!=null&&!FileUtils._mInfiniteGridView.locked())){var C=$(this);if($(window).height()-C.offset().top<145){C.addClass("hover hover-low");}else{C.addClass("hover");}var B=$(".inline-commands",this);B.css("visibility","visible");var _=FileUtils.getElementData(C.attr("_position")),A=FileUtils._checkIsBuyFile(_&&_.path||"");if(A||(_&&_.isdir==1)){B.find(".sell-sfile").hide();}else{B.find(".sell-sfile").hide();}}};_.onmouseout=function(_){$(this).removeClass("hover hover-low");$(".inline-commands",this).css("visibility","hidden");$(".more-sfile-menu",this).hover(function(){$(this).show();},function(){$(this).hide();});};},_whenListScrolledCallBack:null,_afterListDoWizard:function(B,_,A){disk.Context.requestFeature(disk.Context.FEATURE_STORAGE,{succ:function(){var H=localStorage.getItem("flag_show_functions_"+_);if(disk.DEBUG){console.warn("showWizard: ",H," display: ",$("#infiniteListView").css("display"),B);}if(H==1||$("#infiniteListView").css("display")=="none"||(B&&B.length==0)){$("#wizard-functions-intro").remove();return;}var J,M,D=-1,K=$("#infiniteListView .file-item").size();if(disk.DEBUG){console.warn("size: ",K);}for(var E=0;E<K;E++){J=B[E];if((!J.isdir)&&J.server_filename){M=J.server_filename.match(/(.[^\.]+$)/)[1];if(M&&_.indexOf(M.toLowerCase()+"_")>=0){D=E;break;}}}if(disk.DEBUG){console.warn("resultIndex: ",D);}if(D==-1){$("#wizard-functions-intro").remove();return;}var C=$("#infiniteListView .file-item[_position='"+D+"']"),G,F,L;if(C&&C.length>0){L=C.offset();G=L.left;F=L.top;}else{return;}localStorage.setItem("flag_show_functions_"+_,"1");setTimeout(function(){FileUtils._whenListScrolledCallBack=function(){$("#wizard-functions-intro").remove();FileUtils._whenListScrolledCallBack=null;};},2000);var I=$("#wizard-functions-intro");if(I.length>0){}else{I=$('<div id="wizard-functions-intro"><div class="intro-inner">'+A+'<a class="intro-close" hidefocus="true" href="javascript:;"></a></div><div class="intro-bg"></div></div>');$(document.body).append(I);}I.css({left:G,top:F-145});I.find(".intro-close").one("click",function(){I.remove();});}});},_afterListLoad:function(A){if($("#fileList .no-result-title").length>0){return;}var _=false;if(A&&A.length===0){if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){$("#inifiniteListViewEmptyNote").html('<div class="no-result-div"><p class="no-result-pic"><em class="recy"></em></p><p class="no-result-title">\u56de\u6536\u7ad9\u4e3a\u4f60\u4fdd\u755910\u5929\u5185\u5220\u9664\u7684\u6587\u4ef6\u3002</p></div>');}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){$("#inifiniteListViewEmptyNote").html('<div class="no-result-div"><p class="no-result-pic"><em class="shr"></em></p><p class="no-result-title">\u597d\u4e1c\u897f\u8981\u6652\u51fa\u6765\uff0c\u5feb\u628a\u4f60\u7684\u6587\u4ef6\u5206\u4eab\u7ed9\u8eab\u8fb9\u7684\u670b\u53cb\u4eec\u5427\u3002</p></div>');}else{if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){$("#inifiniteListViewEmptyNote").html('<div class="no-result-div"><p class="no-result-pic"><em class="shr-home-slave"></em></p><p class="no-result-title">Ta\u8fd8\u6ca1\u6709\u5206\u4eab\u5462\uff0c\u8fc7\u6bb5\u65f6\u95f4\u518d\u6765\u770b\u770b\u5427~</p></div>');}else{if(Page.inViewMode(Page.VIEW_HOME)){if(FileUtils.getModule()==="category"&&FileUtils.getType()===2){if(FileUtils.getFlagTimeLineByCookie()){this.makeTimeLineEmptyHtml();}else{this.makeNewEmptyHTML();}if($("#timeLineGuide").length>0){$("#timeLineGuide").remove();}}else{if(this._mDirMgr._mStack[0]=="\u6765\u81eaPC\u7684\u5907\u4efd\u6587\u4ef6"){var B="//pan.baidu.com/download#pan";$("#inifiniteListViewEmptyNote").html('<div class="no-result-file"><p class="no-result-PC"><em class="nofile"></em><a target="_blank" class="lbtn icon-pl35 windowsIcon" href="'+B+'"><em class="icon-window"></em><b>\u4e0b\u8f7dWindows\u7248</b></a></p><p class="no-result-title"> </p></div>');}else{if(FileUtils.getModule()==="category"&&FileUtils.getType()==7){this.makeNewEmptyHTMLByBT();}else{this.makeNewEmptyHTML();}}}}else{}}}}_=true;}if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)&&A==null){_=true;$("#inifiniteListViewEmptyNote").html('<div class="no-result-div"><p class="no-result-pic"><em class="recy"></em></p><p class="no-result-title">\u56de\u6536\u7ad9\u4e3a\u4f60\u4fdd\u755910\u5929\u5185\u5220\u9664\u7684\u6587\u4ef6\u3002</p></div>');}if(typeof disk.ui.MouseWheelSensor!="undefined"){disk.ui.MouseWheelSensor.FLAG_PREVENT_DEFAULT=!_;}if(disk.DEBUG){console.warn("resolveCurrentDirKey: ",FileUtils.resolveCurrentDirKey(),", FLAG_COMING_BY_SEARCH:",FileUtils.FLAG_COMING_BY_SEARCH);}if(Page.inViewMode(Page.VIEW_HOME)&&(FileUtils.resolveCurrentDirKey()!=0)){if(FileUtils.FLAG_COMING_BY_SEARCH==1){FileUtils.FLAG_COMING_BY_SEARCH=0;}else{this._afterListDoWizard(A,".zip_.rar_","\u5355\u51fb\u5373\u53ef\u67e5\u770b\u538b\u7f29\u5305\uff0c</br>\u514d\u53bb\u4e0b\u8f7d\u70e6\u607c\uff01");}}},_mHotBtRecList:null,makeNewEmptyHTMLByBT:function(){FileUtils.loginState="1";var _=$("#inifiniteListViewEmptyNote"),B=function(){var A=['<div class="no-result-file-download">','<div class="no-result-title"><div>','<div class="empty-bt clearfix"><div class="empty-bt-pic"></div><div class="empty-bt-txt">\u4f60\u8fd8\u6ca1\u6709\u79cd\u5b50\u6587\u4ef6\u5462,\u53bb\u770b\u770b\u522b\u4eba\u5206\u4eab\u7684\u70ed\u95e8\u79cd\u5b50\u5427</div></div>','<div class="empty-bt-content-list"></div>',"</div>"];_.html(A.join(""));},A=function(){var A=FileUtils._mRecommendBtPanel;A.startInit(_.find(".empty-bt-content-list"));FileUtils._mDiskLog.send({type:"hotrec_bt_empty_display"});};B();return;if(FileUtils._mRecommendBtPanel==null){if(typeof disk.ui.ReCommendBT=="undefined"){ark.use({url:["/buss/recommend_bt_panel","/recommend_bt.css"],noDependency:true},function(){if(typeof disk.ui.ReCommendBT!="undefined"){FileUtils._mRecommendBtPanel=disk.ui.ReCommendBT.obtain();A();}});}else{FileUtils._mRecommendBtPanel=disk.ui.ReCommendBT.obtain();A();}}else{A();}},makeTimeLineEmptyHtml:function(){var A=$("#inifiniteListViewEmptyNote"),_=['<div style="margin-left:0" class="no-result-file-download">','<div class="no-result-title"><div class="no-result-timeline"></div></div>',"</div>"];A.html(_.join(""));},makeNewEmptyHTML:function(){var B=false;if(FileUtils._mDataAwardIntrCache==0){B=true;}var _='<div class="no-result-file-download">'+'<div class="'+(B?"no-result-file-noupload-caption":"no-result-file-caption")+'"></div>'+(B?'<a target="_blank" class="no-result-file-noupload-award" href="/disk/award" hidefocus="true">\u53bb\u6269\u5bb9 &gt;</a>':"")+'<div class="no-result-title no-result-file-bottom">'+'<a hidefocus="true" class="no-result-download-phone" href="//pan.baidu.com/download#android" target="_blank">\u624b\u673a\u7248\u4e0b\u8f7d</a>'+'<a hidefocus="true" class="no-result-download-twocode" href="javascript:;">\u4e8c\u7ef4\u7801\u4e0b\u8f7d</a>'+'<a hidefocus="true" class="no-result-download-ipad" href="http://pan.baidu.com/download#ipad" target="_blank">iPad\u7248\u4e0b\u8f7d</a>'+'<a hidefocus="true" class="no-result-download-pc" href="http://pan.baidu.com/download" target="_blank">PC\u7248\u4e0b\u8f7d</a>'+'<div class="no-result-file-twocode"><a hidefocus="true" href="javascript:;">\u5173\u95ed</a></div>'+"</div>"+"</div>",D=$("#inifiniteListViewEmptyNote"),C,A;D.html(_);C=D.find(".no-result-file-twocode");A=C.find("a");D.find(".no-result-download-twocode").mouseover(function(){C.show();}).mouseout(function(){C.hide();});C.mouseover(function(){C.show();}).mouseout(function(){C.hide();});A.click(function(){C.hide();});if(FileUtils._mDataAwardIntrCache==null){$.ajax({type:"POST",timeout:3000,url:disk.api.RestAPI.TASK_QUERY+"?detail=1&t="+(new Date().getTime()),dataType:"json",success:function(A){if(A&&A.errno==0){if(A.task_detail&&A.task_detail[6]==0){FileUtils._mDataAwardIntrCache=0;var _=$("#inifiniteListViewEmptyNote").find(".no-result-file-caption");if(_.length){_.addClass("no-result-file-noupload-caption");$('<a target="_blank" class="no-result-file-noupload-award" href="/disk/award" hidefocus="true">\u53bb\u6269\u5bb9 &gt;</a>').insertAfter(_);}}}}});}},bindDownloadClient:function(){$(".side-options a").mousedown(function(){var _="",A="sidebar";if($(this).hasClass("side-lwindows")){_="win";}else{if($(this).hasClass("side-landroid")){_="android";}else{if($(this).hasClass("side-liphone")){_="iphone";}else{if($(this).hasClass("side-lipad")){_="ipad";}else{if($(this).hasClass("side-lwp7")){_="wp7";}else{return;}}}}}setTimeout(function(){FileUtils._mDiskLog.send({type:"downloadclient",ttype:_,pos:A});},500);return true;});},bindCategoryClickLog:function(_){FileUtils._mDiskLog.send({type:"bindCategoryClickLog",category:_});return true;},clearAllDocData:function(){if(typeof disk.ui.DocReader=="undefined"){ark.use({url:["/buss/dialog/docreader_dialog.js","/dialog/doc-dialog.css"],noDependency:true},function(){if(typeof disk.ui.DocReader!="undefined"){disk.ui.DocReader.clearAllDocData();}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6\u5220\u9664\u51fa\u9519\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5",sticky:false});}});}},operateCachePath:function(C,B){if((typeof localStorage==="undefined")||(!window.FileUtils)||(!window.FileUtils.sysUID)||(typeof localStorage.getItem==="undefined")){return false;}var _="cachepath_"+FileUtils.sysUID.replace(/@/g,""),A="";if(C){if(disk.DEBUG){console.log(">>> cache path: set key=",_," value=",B);}localStorage.setItem(_,B);return true;}else{A=localStorage.getItem(_);}if(A!==null){if(disk.DEBUG){console.log(">>> cache path: get key=",_," value=",A);}return A;}else{return false;}},base64Encode:function(G){var C="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",B,A,_,F,D,E;_=G.length;A=0;B="";while(A<_){F=G.charCodeAt(A++)&255;if(A==_){B+=C.charAt(F>>2);B+=C.charAt((F&3)<<4);B+="==";break;}D=G.charCodeAt(A++);if(A==_){B+=C.charAt(F>>2);B+=C.charAt(((F&3)<<4)|((D&240)>>4));B+=C.charAt((D&15)<<2);B+="=";break;}E=G.charCodeAt(A++);B+=C.charAt(F>>2);B+=C.charAt(((F&3)<<4)|((D&240)>>4));B+=C.charAt(((D&15)<<2)|((E&192)>>6));B+=C.charAt(E&63);}return B;},getDlink:function(A,C,B){var _=function(_){var A=disk.Context.getService(disk.Context.SERVICE_TOAST),B="";if(_){B=disk.util.ErrorMessage[_];}B=B||"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5";A.setMessage(disk.ui.Toast.MODE_CAUTION,B);A.setClose(true);A.setVisible(true,true);A.setGravity(disk.ui.Panel.TOP);disk.Context.getService(disk.Context.SERVICE_DIALOG).setVisible(false);};if(typeof FileUtils.sign2!=="function"){_();return;}var E=FileUtils.base64Encode(FileUtils.sign2(FileUtils.sign3,FileUtils.sign1)),D={sign:E,timestamp:FileUtils.timestamp,fidlist:A,type:C};$.post(disk.api.RestAPI.DOWN_GET_DLINK,D,function(C){var A=null;try{A=$.parseJSON(C);}catch(D){}if(A){if(A.errno==0){if(A.dlink&&A.dlink.length>0){if(typeof B==="function"){B(A);}}else{_();}}else{_(A.errno);}}else{_();}}).error(function(){_();});},showPresentMember:function(){$.get(disk.api.RestAPI.VIP_USER+"?method=query",function(C){var B=null;try{B=$.parseJSON(C);}catch(D){}if(B){if(B.product_infos&&B.product_infos.length>0){var _=B.product_infos;for(var A=_.length;A--;){if(_[A].product_name==="vip1_3m"){if(FileUtils.presentMember==null){ark.use({url:["/buss/dialog/presentMembership_dialog.js","/dialog/presentMembership_dialog.css"],noDependency:true},function(){Utilities.useCloseToast();if(typeof disk.ui.PresentMembership!="undefined"){FileUtils.presentMember=new disk.ui.PresentMembership();FileUtils.presentMember.setVisible(true);localStorage.setItem("presentMember",true);}});break;}}}}}});}},Page=function(){this._mUploadDialog=null;this._mMoveCopyDialog=null;this._mPublicDialog=null;this._mShareDialog=null;this._mSingleURLDialog=null;this._mToolbarMenuItems=[];this._mBarCmdTrigger=null;};Page.singleton=null;Page.obtain=function(){return Page.singleton?Page.singleton:(Page.singleton=new Page());};Page.SHARE=1;Page.PUBLIC=2;Page.MAX_FILE_DELECTION_ALLOWED=100;Page.MENU_RENAME=0;Page.MENU_DOWNLOAD=0;Page.MENU_TRANSFER=1;Page.MENU_ALLFILEDOWNLOAD=2;Page.MENU_ALLFILETRANSFER=3;Page.MENU_CANCEL_SHARE=0;Page.MENU_CANCEL_PUBLIC=0;Page.MENU_DELETE=1;Page.MENU_SHARE=2;Page.MENU_PUBLIC=3;Page.MENU_COPY=4;Page.MENU_MOVE=5;Page.MENU_UPLOAD=6;Page.MENU_NEW_FOLDER=7;Page.MENU_ANOTHER_DOWNLOAD=8;Page.MENU_PLAY_ALL=9;Page.MENU_NEW_OFFLINE=10;Page.MENU_OFFLINE_LIST=11;Page.MENU_NEW_BT_OFFLINE=12;Page.MENU_EDIT_PIC=13;Page.MENU_PRINT=14;Page.MENU_REVISION_LIST=15;Page.MENU_SELL_FILE=16;Page.MENU_BAR_SELL_FILE=17;Page.MENU_SELL_FILE_BIG=18;Page.MENU_DEVICE=19;Page.MENU_DEVICE_OPEN=20;Page.MENU_DEVICE=19;Page.MENU_RESTORE=0;Page.MENU_PERSIST_REMOVE=1;Page.MENU_CLEAR_ALL=2;Page.VIEW_HOME=0;Page.VIEW_SHARE_PROPERTY_OWN=4;Page.VIEW_PROPERTY_OTHER=2;Page.VIEW_PROPERTY_NOTFOUND=8;Page.VIEW_HOME_PAGE_SLAVE=10;Page.VIEW_RECYCLE_BIN=6;Page.inViewMode=function(_){var A=document.body.className;if(typeof _=="undefined"){return A.substring(5);}switch(_){case Page.VIEW_HOME_PAGE_SLAVE:return A.indexOf("flag-10")!=-1;break;case Page.VIEW_HOME:return A.indexOf("flag-10")==-1&&A.indexOf("flag-1")!=-1;break;case Page.VIEW_SHARE_PROPERTY_OWN:return A.indexOf("flag-4")!=-1;break;case Page.VIEW_PROPERTY_OTHER:return A.indexOf("flag-2")!=-1;break;case Page.VIEW_RECYCLE_BIN:return A.indexOf("flag-6")!=-1;break;}};Page.createAwardBubble=function(B,_){return;if(B){if(_!=0){return;}else{_this=this;if($("#bubbleAwardPanel").length==0){var A=$("<div>",{"class":"bubble-panel",id:"bubbleAwardPanel"}).html('<div class="bubble-arrow reverse"></div><div class="bubble-panel-main" id="bubbleMainContent">\u9080\u8bf7\u670b\u53cb\uff0c\u83b7\u5f97\u5927\u989d\u7a7a\u95f4\u5956\u52b1\u3002<a class="b-in-blk bubble-close" href="javascript:;"></a></div>').hide();A.appendTo("#awardBubbleP");$(".bubble-close").click(function(_){_this.createAwardBubble(false);});$("#bubbleAwardPanel").fadeIn("slow");}}}else{$("#bubbleAwardPanel").hide("fast",function(){$("#bubbleAwardPanel").detach();});}};Page.setCookie=function(G,_,D,E,C){var A=new Date(),B="",F="";A.setDate(A.getDate()+D);if(C){B=";domain="+C;}if(E){F=";path="+E;}document.cookie=G+"="+escape(_)+((D==null)?"":";expires="+A.toGMTString())+F+B;};Page.getCookie=function(_){if(document.cookie.length>0){c_start=document.cookie.indexOf(_+"=");if(c_start!=-1){c_start=c_start+_.length+1;c_end=document.cookie.indexOf(";",c_start);if(c_end==-1){c_end=document.cookie.length;}return unescape(document.cookie.substring(c_start,c_end));}}return"";};Page.obtainDownloadURL=function(D){var C=disk.util,B="";if(C&&C.PCSUtils&&C.PCSUtils._sResult){B="&cflg="+encodeURIComponent(C.PCSUtils._sResult+":"+C.PCSUtils._sRevision);}if(disk.DEBUG){console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>>>pcs suffix ",B);}var A=D.dlink;if(A&&A.indexOf("http://")===0&&window.location.protocol==="https:"){A=A.replace("http://",window.location.protocol+"//");}return($.browser.msie)?A+"&response-cache-control=private"+B:A+B;if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){return D.dlink;}else{var F=D.path,E=FileUtils.parseDirFromPath(F);if(!D.isdir){var _=E.lastIndexOf(".");if(_!=-1){E=E.substring(0,_);}}return disk.api.RestAPI.SINGLE_DOWNLOAD+"&path="+encodeURIComponent(FileUtils.parseDirPath(F));}};Page.showNotification=function(D,B,C){var _=document.getElementById("netdiskTips"),E=document.getElementById("subwindowContainer"),A=document.getElementById("panInner");if(!E||!A){if(disk.DEBUG){console.warn("could not locate an spot for notification tips");}return null;}else{if(D){if(!_){_=document.createElement("div");_.className="netdiskTips";}else{if(_.getAttribute("_installed")&&C!==true){if(disk.DEBUG){console.warn("an existing notification showed, duplicate request rejected");}return;}}_.setAttribute("_installed",1);_.innerHTML='<div class="close-tips" title="\u5173\u95ed\u63d0\u793a"></div><div class="tips ellipsis clearfix"><em class="sprite-ic tips-prx"></em>'+B+"</div>";_.style.position="relative";_.style.zIndex="10";_.style.display="block";E.insertBefore(_,A);}else{if(_){_.style.display="none";}}Utilities.resolveLayout();return _;}};Page.changeUnionLogin=function(){var B="frm",G=disk.getParam(B);if(G){if(G=="hao123"){var F=$("#header .logo"),A=F.clone(false);A.css({backgroundPosition:"0 -160px",width:100,outline:"none"}).attr({title:"hao123\u4e0a\u7f51\u5bfc\u822a",href:"http://hao123.com/",target:"_blank",hidefocus:"true"}).addClass("logo-hao123");F.css({backgroundPosition:"-101px -160px",width:96,marginLeft:0,outline:"none"}).attr({title:"\u767e\u5ea6\u4e91",href:"http://yun.baidu.com/",target:"_blank",hidefocus:"true"}).addClass("logo-yun");F.before(A);var E="?"+B+"="+G,D=function(_){var A=_,B=A.attr("href"),C=B.split("#");if(B&&B!="javascript:;"){if(C.length>1){A.attr("href",C[0]+E+"#"+C[1]);}else{A.attr("href",B+E);}}};$("#aside-menu").find("a").each(function(){D($(this));});var H=$(".logo-hao123","#header").innerWidth()+$(".logo-yun","#header").innerWidth();if(H+$(".navs","#header").innerWidth()+$(".info>ul","#header").innerWidth()+30>$("#header").width()){$(".logo-hao123","#header").hide().next().css("marginLeft",10);}}else{if(G=="hao123-iframe"){$(".module-header").parent("div").hide();E="?"+B+"="+G,D=function(_){var A=_,B=A.attr("href"),C=B.split("#");if(B&&B!="javascript:;"){if(C.length>1){A.attr("href",C[0]+E+"#"+C[1]);}else{A.attr("href",B+E);}}};$("#aside-menu").find("a").each(function(){D($(this));});var C=$(".sharenum a");for(var _=0;_<C.length;_++){C.eq(_).attr("href",C.eq(_).attr("href")+"&frm=hao123-iframe");}Utilities.resolveLayout();}}}};Page.prototype={resolveToolbarUI:function(_,A){var B=$(".process",_);if("number"==typeof A||A instanceof Number){if(B.css("display")=="none"){return null;}A?B.css({width:A+1+"px",paddingRight:"1px"}):B.css({width:"0px",paddingRight:"0px"});}else{if("string"==typeof A||A instanceof String){$(".text",_).text(A);}else{if("boolean"==typeof A||A instanceof Boolean){A?B.removeClass("none"):B.addClass("none");}else{if(typeof A=="undefined"){return B.css("display")=="none"?undefined:B.width()/(B.parent().parent().width()-2)*100;}}}}},dispatchFileSelectionChange:function(D,F,C,_,G,A){return false;var B=false,E=null;if(!_&&!D&&!A[0].isdir){B=true;}if(Page.inViewMode(Page.VIEW_HOME)){E=this._mToolbarMenuItems[Page.MENU_ANOTHER_DOWNLOAD];}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){E=this._mToolbarMenuItems[Page.MENU_DOWNLOAD];}}if(E!=null&&typeof E!="undefined"){E.href=B?Page.obtainDownloadURL(A[0]):"#";}},resolveToolbarMenu:function(W){if($("#fileList .no-result-title").length>0){$(".all-files-headers").hide();Utilities.resolveLayout();return;}else{if($(".all-files-headers:hidden").length){$(".all-files-headers").show();Utilities.resolveLayout();}}var b=FileUtils.getModule()=="category",X=FileUtils.isListViewLocked(),G=X,c=FileUtils.getListViewCheckedItems(),f=c.length>1,Y=c.length==0;if(f){$(FileUtils.getFileListDOM()).addClass("multi-sel");}else{$(FileUtils.getFileListDOM()).removeClass("multi-sel");}this.dispatchFileSelectionChange(f,b,G,Y,X,c);if(Page.inViewMode(Page.VIEW_HOME)||Page.VIEW_RECYCLE_BIN){if(Y){$(".files-header").hide();if(FileUtils._mViewMode==FileUtils.VIEW_GRID_ICON){$("#fileThumbHeader").show();}else{if(FileUtils.inSearchMode()){$("#sortColsHeader").show();$(".all-files-headers,#infiniteListView").addClass("searchMode");}else{$("#sortColsHeader").show();$(".all-files-headers,#infiniteListView").removeClass("searchMode");}}}else{if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){}else{var a=Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)?"\u4e2a\u5916\u94fe":"\u4e2a\u6587\u4ef6/\u6587\u4ef6\u5939";$(".files-header").hide();$("#fileActionHeader").show();$("#file_action_word").text("\u5df2\u9009\u4e2d"+c.length+a);}}}if(Page.inViewMode(Page.VIEW_HOME)){var _=null,O=false,J=false,I=false,V=false,B=1,H=false,Q=false,P=false,d=false,Z=false,R=$("#editPicHint"),T=$("#barCmdEdit"),M;FileUtils.SELECT_PIC_NUM=0;if(!Y){for(var N=0,A=c.length;N<A;N++){_=c[N];if(!I){I=FileUtils.ifSpecialFolder(FileUtils.parseDirPath(_.path));}if(!V){V=FileUtils.isInParticularDir(FileUtils.parseDirPath(_.path));}if(!Q){Q=FileUtils.isTopParticularDir(FileUtils.parseDirPath(_.path));}if(!d){d=_.isdir!=1?false:true;}if(!Z){Z=FileUtils._checkIsBuyFile(_.path);}if(B){B=FileUtils.isAllPic(_.category);}}}H=FileUtils.isRevisionCheck(c);if(B){T.removeClass("none");if(B==1){T.find(".icon-edit-pic").removeClass("puzzle").addClass("prettify");T.find("b").text("\u7f8e\u5316");}else{T.find(".icon-edit-pic").removeClass("prettify").addClass("puzzle");T.find("b").text("\u62fc\u56fe");}disk.Context.requestFeature(disk.Context.FEATURE_STORAGE,{succ:function(){M=localStorage.getItem("edit_pic_hint");if(!M){R.removeClass("none");var _,C=$("#file_action_buttons"),A=C[0].offsetLeft,B=C.width();_=B/2+A+50;R.css("left",_+"px");localStorage.setItem("edit_pic_hint","1");}else{R.addClass("none");}}});}else{R.addClass("none");setTimeout(function(){T.addClass("none");},10);}var D=!d&&!Z;this.setToolbarMenuItemDisplay(Page.MENU_BAR_SELL_FILE,false);var L=!D&&FileUtils.getListViewCheckedItems().length>0;$("#barCmdSellFile")[(L?"add":"remove")+"Class"]("disabled");this.setToolbarMenuItemEnabled(Page.MENU_BAR_SELL_FILE,D);var F=!G&&!f&&!Y&&!I&&!O&&!J&&!Q;this.setToolbarMenuItemEnabled(Page.MENU_RENAME,F);var S=!G&&!Y&&!I&&!Q;this.setToolbarMenuItemEnabled(Page.MENU_DELETE,S);if(FileUtils.inSearchMode()){}else{$("#barCmdShareAll").removeClass("none");$("#barCmdDelete").removeClass("none");}var K=!G&&!Y;this.setToolbarMenuItemEnabled(Page.MENU_SHARE,K);var U=!G&&!Y;this.setToolbarMenuItemEnabled(Page.MENU_PUBLIC,U);var e=B?true:false;this.setToolbarMenuItemDisplay(Page.MENU_PRINT,e);this.setToolbarMenuItemDisplay(Page.MENU_REVISION_LIST,H?true:false);if(!this._mBarCmdTrigger){this._mBarCmdTrigger=[document.getElementById("barDropdownTriggerShare"),document.getElementById("barDropdownTriggerMore")];}if(!K&&!U){$(this._mBarCmdTrigger[0]).addClass("disabled");$(this._mBarCmdTrigger[0]).parent().addClass("b-img-over-disabled");}else{$(this._mBarCmdTrigger[0]).removeClass("disabled");$(this._mBarCmdTrigger[0]).parent().removeClass("b-img-over-disabled");}var C=!G&&!Y&&!I;this.setToolbarMenuItemEnabled(Page.MENU_COPY,C);var E=!G&&!Y&&!I&&!O&&!J&&!Q;this.setToolbarMenuItemEnabled(Page.MENU_MOVE,E);if(!F&&!C&&!E){$(this._mBarCmdTrigger[1]).addClass("disabled");}else{$(this._mBarCmdTrigger[1]).removeClass("disabled");}this.setToolbarMenuItemEnabled(Page.MENU_ANOTHER_DOWNLOAD,!X&&!Y);this.setToolbarMenuItemEnabled(Page.MENU_PLAY_ALL,!G&&!Y);this.setToolbarMenuItemEnabled(Page.MENU_NEW_FOLDER,!G&&W!==true&&b!==true);}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){this.setToolbarMenuItemEnabled(Page.MENU_DOWNLOAD,!G&&!Y);this.setToolbarMenuItemEnabled(Page.MENU_TRANSFER,!G&&!Y);}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){this.setToolbarMenuItemEnabled(Page.MENU_CANCEL_SHARE,!G&&!Y);}else{if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){this.setToolbarMenuItemEnabled(Page.MENU_RESTORE,!G&&!Y);this.setToolbarMenuItemEnabled(Page.MENU_PERSIST_REMOVE,!G&&!Y);}}}}},setToolbarMenuItemEnabled:function(_,A){if(A){$(this._mToolbarMenuItems[_]).removeClass("disabled");}else{$(this._mToolbarMenuItems[_]).addClass("disabled");}},isToolbarMenuItemEnabled:function(_){var A=this._mToolbarMenuItems[_];return(typeof A!="undefined")&&!$(A).hasClass("disabled");},setToolbarMenuItemDisplay:function(A,B){var _;if(A===Page.MENU_COPY||A===Page.MENU_MOVE||A===Page.MENU_RENAME){_=$(this._mToolbarMenuItems[A]).parent();}else{_=$(this._mToolbarMenuItems[A]);}if(B){_.show();}else{_.hide();}},_resolveFileProperty:function(A,_){},_getDomainUrl:function(){var _,A=window.location.host;if(A.indexOf("/")!=-1){urlArray=A.split("/");_=urlArray[0];}else{_=A;}_=window.location.protocol+"//"+_;return _;},performSelectionDownload:function(){var B=FileUtils.getListViewCheckedItems(),F=disk.Context.getService(disk.Context.SERVICE_DOWNLOAD_PROXY);if(B.length===0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u60a8\u8fd8\u6ca1\u6709\u9009\u62e9\u4e0b\u8f7d\u7684\u6587\u4ef6",sticky:true,closeType:true});return true;}F.addUIVisibilityEventWatcher(function(_){});if(B.length==1&&!B[0].isdir){var C=B[0];FileUtils.downloadCounter([C],true);F.download(C,1);return false;}else{var E=[],G=false;if(false&&FileUtils.isListViewFullyChecked()&&Page.inViewMode(Page.VIEW_HOME)){var D=FileUtils.getDirMgr().getDir();if(D.trim().length>0&&D.indexOf("\u5206\u7c7b")===-1){G=true;E.push({path:D});}}if(!G){F.setPackName(FileUtils.parseDirFromPath(B[0].path),!B[0].isdir);for(var A=0,_=B.length;A<_;A++){if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){E.push({isdir:B[A].isdir,path:FileUtils.parseDirPath(B[A].path),size:B[A].size,fs_id:B[A].fs_id});}else{E.push({isdir:B[A].isdir,path:FileUtils.parseDirPath(B[A].path),size:B[A].size,fs_id:B[A].fs_id});}}}F.assignPureList(B);if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){F.download(E,true);}else{F.download(E);}FileUtils.downloadCounter(B,false);return false;}},performSelectPrint:function(_){var A=function(){var C=disk.Context.getService(disk.Context.SERVICE_DIALOG);C.setVisible(true);var D=$(".alert-dialog .alert-dialog-commands .okay"),A=$(".alert-dialog .alert-dialog-commands .cancel"),B=D.html(),_=A.html();D.html("<b>\u6211\u77e5\u9053\u4e86</b>");A.hide();C.setMessage("\u63d0\u793a","<b>\u5c0a\u656c\u7684\u7528\u6237\uff0c\u6211\u4eec\u6682\u4e0d\u652f\u6301\u7b2c\u4e09\u65b9\u5e10\u53f7\uff08\u5982QQ\u3001\u65b0\u6d6a\u3001\u4eba\u4eba\uff09</b><br><b>\u7684\u7167\u7247\u51b2\u5370\u670d\u52a1\uff0c\u8bf7\u4f60\u8c05\u89e3</b><br/><b>\u6211\u4eec\u4f1a\u5c3d\u5feb\u63d0\u4f9b\u7b2c\u4e09\u65b9\u5e10\u53f7\u7684\u51b2\u5370\u670d\u52a1\uff0c\u8bf7\u4f60\u7ee7\u7eed\u8ba2\u9605\u767e\u5ea6\u4e91</b>",function(){this.setVisible(false);D.html(B);A.show();},function(){this.setVisible(false);D.html(B);A.show();});},B=function(){if(FileUtils._mCloudPrint==null){$.getScript("/res/static/js/buss/dialog/cloud_print_dialog.js?t="+(new Date().getTime()),function(A){if(A){FileUtils._mCloudPrint=new disk.ui.CloudPrint();FileUtils._mCloudPrint.reBuild(_);}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u518d\u8bd5&hellip;",sticky:false});}});}else{FileUtils._mCloudPrint.reBuild(_);}};B();},_reqAddYunDeviceDialog:function(_){var A=arguments.callee;FileUtils._mDiskLog.send({type:"add_yun_device_dialog"});if(!A.dialog){ark.use({url:["/util/jh.js","/buss/dialog/add_yun_device_dialog.js","/dialog/add-yun-device-dialog.css"],noDependency:false},function(){if(A&&!A.dialog){A.dialog=new disk.ui.addYunDeviceDialog;}_(A.dialog);});}else{_(A.dialog);}},_reqYunDeviceDialog:function(_){var A=arguments.callee;if(!A.dialog){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u8bbe\u5907\u63a8\u9001\u5217\u8868\u7ec4\u4ef6&hellip;",sticky:false});ark.use({url:["/util/jh.js","/buss/dialog/yun_device_dialog.js","/dialog/yun-device-dialog.css","/page.css","/buss/page.js"],noDependency:true},function(){A.dialog=new disk.ui.yunDeviceDialog();_(A.dialog);Utilities.useCloseToast();});}else{_(A.dialog);}},performOpenDevice:function(_){this._reqYunDeviceDialog(function(_){_.show();});},performAddDevice:function(_){this._reqAddYunDeviceDialog(function(_){_.show();});},performRevisionList:function(_){if(FileUtils._mRevisionList==null){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u5386\u53f2\u7248\u672c\u7ec4\u4ef6&hellip;",sticky:false});ark.use({url:["/buss/dialog/revision_list_dialog.js","/dialog/revision-dialog.css"],noDependency:false},function(){Utilities.useCloseToast();if(typeof FileUtils._mRevisionList!="undefined"){FileUtils._mRevisionList=new disk.ui.RevisionList();}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5386\u53f2\u7248\u672c\u7ec4\u4ef6\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u518d\u8bd5&hellip;",sticky:false});}FileUtils._mRevisionList.reBuild(_);});}else{FileUtils._mRevisionList.reBuild(_);}},performAllDownload:function(){var _=FileUtils.getListViewCheckedItems();if(_&&_.length>0){return this.performSelectionDownload();}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5148\u9009\u62e9\u4e00\u4e0b\u4f60\u8981\u4e0b\u8f7d\u7684\u6587\u4ef6\u54e6",sticky:false});}},performAllTransfer:function(){var _=FileUtils.getListViewCheckedItems();if(_&&_.length>0&&_.length<=1000){FileUtils.transferFiles(_);}else{if(_.length>1000){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc71000\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_transfer_more_than_100"});}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5148\u9009\u62e9\u4e00\u4e0b\u4f60\u8981\u4fdd\u5b58\u7684\u6587\u4ef6\u54e6",sticky:false});}}},performSelectionTransfer:function(){var _=FileUtils.getListViewCheckedItems();if(_.length>1000){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc71000\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_transfer_more_than_100"});}else{FileUtils.transferFiles(_);}},performSelectionShowFolder:function(){if(FileUtils.getModule()==="category"&&FileUtils.getType()===2){FileUtils.removeTimelineView();}var _=FileUtils.getListViewCheckedItems();if(_.length==1){var B=FileUtils.parseFullDirFromPath(_[0].path),A=FileUtils._mInfiniteListView;if(A){A.setItemsChecked(false);}A=FileUtils._mInfiniteGridView;if(A){A.setItemsChecked(false);}FileUtils.historyNavigate(B==disk.util.DirectoryLocation.DIR_ROOT?{}:{path:B});}},performSelectionDelete:function(){var _=FileUtils.getListViewCheckedItems();if(_.length>100){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc7100\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_remove_more_than_100"});}else{FileUtils.deleteFiles(_);}},performSelectionEditPic:function(A){var F=disk.ui.Utilities.getFlashVersion();if(F==null||parseFloat(F,10)<10.2){var G=$(".alert-dialog .alert-dialog-commands .okay"),L=$(".alert-dialog .alert-dialog-commands .cancel"),M=G.html(),_=L.html(),K=disk.Context.getService(disk.Context.SERVICE_DIALOG);K.setVisible(true);G.html("<b>\u5b89\u88c5</b>");K.setMessage("\u53cb\u597d\u63d0\u793a","\u8981\u4f7f\u7528\u56fe\u7247\u5728\u7ebf\u7f16\u8f91\u529f\u80fd\uff0c\u60a8\u9700\u8981\u5b89\u88c5Flash\u64ad\u653e\u566810.2.0 \u6216\u66f4\u9ad8\u7684\u7248\u672c\u3002",function(){window.open("http://get.adobe.com/cn/flashplayer");this.setVisible(false);G.html(M);},function(){this.setVisible(false);G.html(M);});}else{var D=FileUtils.getListViewCheckedItems(),B=[],N="",H=12;for(var I=0,J=D.length;I<J;I++){var E=D[I];if(E.category==3){if(J==1){N=encodeURIComponent(E.path);var C=disk.setParam("size","c10000_u10000",E.thumbs["url1"]);B.push(encodeURIComponent(C));if(typeof _hmt=="object"){if(A=="right"){_hmt.push(["_trackEvent","\u56fe\u7247\u5728\u7ebf\u7f16\u8f91","\u5217\u8868\u70b9\u51fb\u7f8e\u5316\u5165\u53e3\u7684\u6b21\u6570"]);}else{_hmt.push(["_trackEvent","\u56fe\u7247\u5728\u7ebf\u7f16\u8f91","\u64cd\u4f5c\u680f\u70b9\u51fb\u7f8e\u5316\u5165\u53e3\u7684\u6b21\u6570"]);}}}else{if(B.length<=H){C=disk.setParam("size","c1000_u800",E.thumbs["url1"]);B.push(encodeURIComponent(C));if(typeof _hmt=="object"){if(A=="right"){_hmt.push(["_trackEvent","\u56fe\u7247\u5728\u7ebf\u7f16\u8f91","\u5217\u8868\u70b9\u51fb\u62fc\u56fe\u5165\u53e3\u7684\u6b21\u6570"]);}else{_hmt.push(["_trackEvent","\u56fe\u7247\u5728\u7ebf\u7f16\u8f91","\u64cd\u4f5c\u680f\u70b9\u51fb\u62fc\u56fe\u5165\u53e3\u7684\u6b21\u6570"]);}}}}}}disk.Context.requestFeature(disk.Context.FEATURE_STORAGE,{succ:function(){localStorage.setItem("picArray",B.join(","));localStorage.setItem("picPath",N);window.open("/disk/editpic");}});}},performSelectionCancelShare:function(){var _=FileUtils.getListViewCheckedItems();if(_.length>100){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc7100\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_cancel_share_more_than_100"});}else{FileUtils.cancelShare(_,"share");}},performSelectionMoveCopy:function(D,C){var E=this;if(typeof C=="undefined"){C=FileUtils.getListViewCheckedItems();}if(C.length>100){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc7100\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_move_and_copy_more_than_100"});}else{if(D==disk.ui.MoveCopyDialog.COPY){var B=0;for(var A=0,_=C.length;A<_;A++){B+=C[A].size?B:0;if(!Utilities.hasEnoughSpacing(B)){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u590d\u5236\u5931\u8d25\uff0c\u5269\u4f59\u7a7a\u95f4\u4e0d\u8db3",sticky:false});return;}}}if(!E._mMoveCopyDialog){E._mMoveCopyDialog=new disk.ui.MoveCopyDialog();}E._mMoveCopyDialog.onRefuse=function(_){FileUtils.switchToDir(FileUtils.getDirMgr().getDir());};E._mMoveCopyDialog.onClose=function(){};E._mMoveCopyDialog.onConsent=function(D,F){if(disk.DEBUG){console.log("before move selected files and dirs to ","[",F,"]","and action type ",D);}var B=this.getCacheItems();if(B.length>0){if(F==FileUtils.getDirMgr().getDir()){if(disk.DEBUG){console.log(">>>>we are hitting the same dir, reject this request");}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u60a8\u8981"+(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u7684\u6587\u4ef6\u5df2\u7ecf\u5b58\u5728\u4e8e\u76ee\u6807\u8def\u5f84",sticky:false});FileUtils.switchToDir(F);return;}for(var A=0,C,_=B.length;A<_;A++){C=FileUtils.parseDirPath(B[A].path);if(disk.util.DirectoryLocation.isDecendentsOf(F,C)){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e0d\u80fd\u5c06\u6587\u4ef6"+(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5230\u81ea\u8eab\u6216\u5176\u5b50\u76ee\u5f55\u4e0b",sticky:false});FileUtils.switchToDir(FileUtils.getDirMgr().getDir());return;}}Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728"+(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u6587\u4ef6\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});FileUtils.sendMoveCopyFileMessage(D==disk.ui.MoveCopyDialog.MOVE,B,F==disk.util.DirectoryLocation.DIR_ROOT?"/":F,function(K){try{var A=disk.Context.getService(disk.Context.SERVICE_TOAST),B=(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u6587\u4ef6\u5931\u8d25",J=null;A.setVisible(false);var L=$.parseJSON(K);if(L.errno==0){B=(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u6587\u4ef6\u6210\u529f";}else{if(L.errno==12){J=E.dealCopyMoveBatchCallback1(L,D);if(J){}else{B="\u90e8\u5206\u6587\u4ef6"+(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u6210\u529f";}}}if(disk.DEBUG){console.log("move or copy files success, prepare to update local cache");}if(FileUtils.getModule()=="category"||FileUtils.inSearchMode()){FileUtils.getLocalCache().removeAll();FileUtils.getLocalCache().removeCategorys();FileUtils.clearAllDocData();A.pending(function(){Utilities.useToast(J?J:{toastMode:disk.ui.Toast.MODE_SUCCESS,msg:B,sticky:false});});if(FileUtils.getModule()=="category"){FileUtils.triggerType(FileUtils.getType());}else{if(FileUtils.inSearchMode()){FileUtils.clearAllDocData();FileUtils.issueProxyLoading(true,false);var G=FileUtils.resolveCurrentDirKey();FileUtils.loadDir(G==FileUtils.ROOT_ID?"":G);}else{FileUtils.clearAllDocData();FileUtils.issueProxyLoading(true,false);FileUtils.loadDir(FileUtils.resolveCurrentDirKey());}}Utilities.scheduleQueryQuota();Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});}else{var C=disk.util.FileCache.KEY_MODE_NORMAL,N=FileUtils.resolveCurrentDirKey(),H=[];if(D==disk.ui.MoveCopyDialog.MOVE){infos=L.info;for(var _=infos.length,I=_-1;I>=0;I--){if(infos[I].errno===0){H.push(infos[I]);}}}else{}var F=FileUtils.getLocalCache().movecopyByMode(C,N,D,H);if(F){FileUtils.clearAllDocData();var M=FileUtils.getListView();M.setItemsChecked(false);K=FileUtils.getLocalCache().obtainByMode(C,N);if(FileUtils.getViewMode()!=FileUtils.VIEW_LIST){K=FileUtils.setGroupData(K,FileUtils._mGridStep);}M.updateBackedData(K);Page.obtain().resolveToolbarMenu();Utilities.scheduleQueryQuota();}Utilities.useToast(J?J:{toastMode:disk.ui.Toast.MODE_SUCCESS,msg:B,sticky:false});}}catch(O){if(disk.DEBUG){console.log("error on move or copy files ",O.message);}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:(D==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u6587\u4ef6\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}this._mPendingHighlights=null;});}};if(disk.DEBUG){console.log("before action type>>>",D);}E._mMoveCopyDialog.setVisible(true);E._mMoveCopyDialog.setActionType(D);E._mMoveCopyDialog.setCacheItems(C);}},dealCopyMoveBatchCallback:function(E,H){var G=false,D=false,I=false,C=false,F=null,B=FileUtils.getListViewCheckedItems();for(var A=0,_=E.info.length;A<_;A++){F=E.info[A];if(F.errno==-10){G=true;}else{if(F.errno==-8){D=true;}else{if(F.errno==0){I=true;}else{if(F.errno==-9){C=true;}}}}}if(!G&&!D&&!C){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});return false;}if(E.info.length==B.length&&!I){if(G){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u5269\u4f59\u7a7a\u95f4\u4e0d\u8db3",sticky:true,closeType:true});}else{if(D){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u6587\u4ef6\u5df2\u5b58\u5728\u4e8e\u76ee\u6807\u6587\u4ef6\u5939\u4e2d",sticky:false});}else{if(C){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u6587\u4ef6\u4e0d\u5b58\u5728",sticky:true,closeType:true});}}}return false;}else{if(G){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6"+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25, \u4f7f\u7528\u7a7a\u95f4\u5df2\u6ee1",sticky:false});}else{if(D){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6"+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25, \u90e8\u5206\u6587\u4ef6\u5df2\u5b58\u5728",sticky:false});FileUtils.clearCurrentDirCache();}else{if(C){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6"+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25, \u90e8\u5206\u6587\u4ef6\u4e0d\u5b58\u5728",sticky:false});FileUtils.clearCurrentDirCache();}}}return false;}return true;},dealCopyMoveBatchCallback1:function(E,H){var G=false,D=false,I=false,C=false,F=null,B=FileUtils.getListViewCheckedItems();for(var A=0,_=E.info.length;A<_;A++){F=E.info[A];if(F.errno==-10){G=true;}else{if(F.errno==-8){D=true;}else{if(F.errno==0){I=true;}else{if(F.errno==-9){C=true;}}}}}if(!G&&!D&&!C){return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true};}if(E.info.length==B.length&&!I){if(G){return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u5269\u4f59\u7a7a\u95f4\u4e0d\u8db3",sticky:true,closeType:true};}else{if(D){FileUtils._mDiskLog.send({type:"destination_has_same_files"});return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u6587\u4ef6\u5df2\u5b58\u5728\u4e8e\u76ee\u6807\u6587\u4ef6\u5939\u4e2d",sticky:false};}else{if(C){return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25\uff0c\u6587\u4ef6\u4e0d\u5b58\u5728",sticky:true,closeType:true};}else{return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25",sticky:true,closeType:true};}}}}else{if(G){return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6"+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25, \u4f7f\u7528\u7a7a\u95f4\u5df2\u6ee1",sticky:false};}else{if(D){return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u90e8\u5206\u6587\u4ef6\u5df2\u5b58\u5728\uff0c"+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25 ",sticky:false};}else{if(C){return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u90e8\u5206\u6587\u4ef6\u4e0d\u5b58\u5728, "+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25",sticky:false};}else{return{toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6587\u4ef6"+(H==disk.ui.MoveCopyDialog.MOVE?"\u79fb\u52a8":"\u590d\u5236")+"\u5931\u8d25",sticky:false};}}}}return null;},performSelectionShareAll:function(E){var D=0;$.getJSON(disk.api.RestAPI.LINK_COUNT+"&type=1&t="+(new Date().getTime()),function(A){var B=parseInt(A.count);if(B>=100000){var _=disk.Context.getService(disk.Context.SERVICE_DIALOG);_.setVisible(true);$(".cancel",_._mUI.pane).hide();_.setMessage("\u5206\u4eab\u9519\u8bef","\u4f60\u5df2\u7ecf\u5206\u4eab\u4e86100000\u6761\uff0c\u4e0d\u80fd\u518d\u6b21\u5206\u4eab\uff01",function(){$(".cancel",_._mUI.pane).show();this.setVisible(false);},function(){$(".cancel",_._mUI.pane).show();});}});if(D==0){if(E.length>100){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc7100\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_share_more_than_100"});}else{var G=this,J=[],K=null,A=false,I=false;for(var H=0,_=E.length;H<_;H++){K=E[H];J.push(K.server_filename);}var F=function(){if(A&&I){G._mShareDialog.setFileList(E);}},C=("flag_fillusername_shareall_"+FileUtils.sysUID).replace(/@|\*/g,"");if(!window.localStorage.getItem(C)){window.localStorage.setItem(C,1);ark.use({url:["/ui/fill_username_dialog"],noDependency:true},function(){G._mfillUserNameDialog=disk.Context.getService(disk.Context.SERVICE_FILLNAME_DIALOG);G._mfillUserNameDialog.checkHasUserName();G._mfillUserNameDialog.onHasUserName=function(){A=true;F();};G._mfillUserNameDialog.onNotHasUserName=function(){this.setVisible(true);};G._mfillUserNameDialog.onFillUserNameSuccess=function(){disk.ui.header.setNickname(this.username);this.setVisible(false);A=true;F();};G._mfillUserNameDialog.onHide=function(){A=true;F();};});}else{A=true;F();}var B=function(){I=true;if(G._mShareDialog==null){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u5206\u4eab\u529f\u80fd,\u8bf7\u7a0d\u5019\u2026\u2026",sticky:false});ark.use({url:["/res/static/js/buss/sharefriend/contentController.js","/res/static/js/buss/sharefriend/share_dialog.js","/res/static/css/sharefriend/shareDialog.css"],noDependency:false,enforceUrl:true},function(){Utilities.useCloseToast();if(typeof disk.ui.ShareDialog!="undefined"){G._mShareDialog=new disk.ui.ShareDialog();F();}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5206\u4eab\u529f\u80fd\u52a0\u8f7d\u5931\u8d25,\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}});}else{F();}};$.get(disk.api.RestAPI.normalize(disk.api.RestAPI.INBOX_OBJECT_CHECKANTISPAM,FileUtils.bdstoken),{path_array:$.stringify(J)},function(C){if(C==""||C.errno==0||typeof C.errno==="undefined"){B();}else{var A="\u53d1\u9001\u7684\u6587\u4ef6\u540d\u4e2d\u6709\u654f\u611f\u8bcd\uff0c\u4f18\u5316\u4e00\u4e0b\u5427";if(C.errno==-52){var _=C.antispam[0];_=_.length<=6?_:_.substring(0,6)+"...";A="\u201c"+(_||"\u53d1\u9001")+"\u201d\u7684\u6587\u4ef6\u540d\u4e2d\u6709\u654f\u611f\u8bcd\uff0c\u4f18\u5316\u4e00\u4e0b\u5427";}else{if(C.errno==-6){A="\u8bf7\u91cd\u65b0\u767b\u5f55";}else{if(C.errno==-72){A="\u53d1\u9001\u7684\u6587\u4ef6\u4e0d\u5b58\u5728\uff0c\u68c0\u67e5\u4e00\u4e0b\u5427";}}}Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:A,sticky:false});}}).error(function(){B();});}}},performUpload:function(_){var B=this,A=disk.util.HistoryManager.interpretCurrentWindow(true);if(Object.prototype.toString.call(A)=="[object Array]"&&A[1]!="undefined"&&A[1].type=="2"){FileUtils._mDiskLog.send({type:"click_upload_button_on_timeline"});}if(this._mUploadDialog==null){return;}if(_){return B._mUploadDialog;}if(B._mUploadDialog.getFileUploader()instanceof disk.ui.OpenSourceFlashFileUploader){B._mUploadDialog.setVisible(true);}$("#barCmdUpload").parent().removeClass("b-img-over");B._mUploadDialog.getFileUploader().dispatchChoosingFiles();},performGlobalSearch:function(A,_){FileUtils.removeTimelineView();FileUtils.createCategoryUI(FileUtils.getModule(),FileUtils.MODULE_DIR);var B=FileUtils._mDirMgr.getDir();if(A==""){if(_===true){if(disk.DEBUG){console.log("Receive General Message");}FileUtils.getDirMgr().cd(disk.util.DirectoryLocation.DIR_ROOT,false);}else{FileUtils.historyNavigate({});}return;}Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u83b7\u53d6\u641c\u7d22\u7ed3\u679c&hellip;",sticky:true});FileUtils.sendSearchMessage(B,A,function(_){FileUtils.switchLayoutMode(FileUtils.MODE_SEARCH);var C=null;try{C=$.parseJSON(_);}catch(D){}if(C.errno==2){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});}else{if(C==null||C.errno!=0||!C.list){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:true,closeType:true});}else{disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);FileUtils._mDirMgr._mAfterSearch=false;FileUtils._mDirMgr.cd("",false,true);var B='\u641c\u7d22:"'+A+'"';FileUtils.getLocalCache().add(B,C.list);FileUtils._mDirMgr.cd(B,true);FileUtils._mDirMgr._mAfterSearch=true;if(C.list.length==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u6ca1\u6709\u627e\u5230\u5339\u914d\u7684\u7ed3\u679c",sticky:false});}if(FileUtils._mLastSearchKey!=null&&B!=FileUtils._mLastSearchKey){FileUtils.getLocalCache().muteRemove(FileUtils._mLastSearchKey);}FileUtils._mLastSearchKey=B;}}});},performCategory:function(_){if(!_){$("#tab-home").addClass("on");$("#aside-menu a.b-no-ln").removeClass("on");disk.util.HistoryManager.getDefault().navigate(FileUtils.MODULE_DIR,null);}else{if(FileUtils._mInfiniteGridView&&FileUtils._mInfiniteGridView.isAllItemChecked()){FileUtils._mInfiniteGridView.setItemsChecked(false);}if(FileUtils._mInfiniteListView&&FileUtils._mInfiniteListView.isAllItemChecked()){FileUtils._mInfiniteListView.setItemsChecked(false);}if(_==2){FileUtils.switchViewMode(FileUtils.VIEW_GRID_ICON,_);}else{if(_==3){FileUtils.switchViewMode(FileUtils.VIEW_GRID_ICON,_);}else{if((FileUtils.getViewMode()!=FileUtils.USER_VIEW_MODE)){FileUtils.switchViewMode(FileUtils.USER_VIEW_MODE);}}}FileUtils.bindCategoryClickLog(_);FileUtils.triggerType(_-0);}},performType:function(_){disk.util.HistoryManager.getDefault().navigate(FileUtils.MODULE_CATEGORY,{type:FileUtils.TYPES[_][0]});},performSelectionRestore:function(){if(disk.DEBUG){console.log("Selection Restore");}var A=FileUtils.getListViewCheckedItems(),B=FileUtils;if(A.length==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u8fd8\u539f\u6587\u4ef6\u6ca1\u6709\u9009\u62e9",sticky:true,closeType:true});return false;}else{if(A.length>100){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc7100\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_restore_more_than_100"});return false;}}var _=disk.Context.getService(disk.Context.SERVICE_DIALOG);_.setVisible(true);_.setMessage("\u786e\u8ba4\u8fd8\u539f","\u786e\u8ba4\u8fd8\u539f\u9009\u4e2d\u7684\u6587\u4ef6\uff1f",function(){var C={};this.setVisible(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u8fd8\u539f\u6570\u636e&hellip;",sticky:true});C.fidlist=[];for(var B=0,_=A.length;B<_;B++){C.fidlist.push(A[B].fs_id);}C.fidlist="["+C.fidlist+"]";$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.RESTORE_RECYCLE+"&t="+(new Date().getTime()),FileUtils.bdstoken),C,function(H){var D=null,_=disk.ui.Toast.MODE_SUCCESS;if(H.errno==0){D="\u8fd8\u539f\u6587\u4ef6\u6210\u529f";}else{if(H.errno==12){var I=H.faillist,B=0,C=I.length,F,G;for(;B<C;B++){if(I[B].errno==0){continue;}switch(I[B].errno){case-8:F="\u76ee\u5f55\u5b58\u5728\u540c\u540d\u6587\u4ef6<br/>";break;case-9:F="\u6587\u4ef6\u88ab\u6240\u6709\u8005\u5220\u9664\uff0c\u5237\u65b0\u540e\u518d\u8bd5";break;case 5:F="\u76ee\u5f55\u5b58\u5728\u540c\u540d\u6587\u4ef6";break;case-10:F="\u767e\u5ea6\u4e91\u7a7a\u95f4\u5df2\u6ee1";break;default:F="\u670d\u52a1\u5668\u9519\u8bef";break;}break;}D="\u8fd8\u539f\u6587\u4ef6\u5931\u8d25\uff0c"+F;_=disk.ui.Toast.MODE_CAUTION;}else{var E=disk.util.ErrorMessage[H.errno]||"\u672a\u77e5\u9519\u8bef\uff0cerrno:"+H.errno;if(H.errno==-9){E="\u6587\u4ef6\u6216\u76ee\u5f55\u4e0d\u5b58\u5728";}D=E;_=disk.ui.Toast.MODE_CAUTION;}}var A=disk.Context.getService(disk.Context.SERVICE_TOAST);A.setVisible(false);A.pending(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:D,sticky:false});});FileUtils.getLocalCache().removeAll();FileUtils.issueProxyLoading(true);FileUtils.loadDir(FileUtils.ROOT_ID);Utilities.scheduleQueryQuota();Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});},"json").error(function(){var _=disk.Context.getService(disk.Context.SERVICE_TOAST);_.setVisible(false);_.pending(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});});FileUtils.getLocalCache().removeAll();FileUtils.issueProxyLoading(true);FileUtils.loadDir(FileUtils.ROOT_ID);Utilities.scheduleQueryQuota();Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});});});},performSelectionRemoval:function(A){if(disk.DEBUG){console.log("Selection Removal "+A);}if(typeof A!=="undefined"){var _=disk.Context.getService(disk.Context.SERVICE_DIALOG);_.setVisible(true);_.setMessage("\u6e05\u7a7a\u56de\u6536\u7ad9","\u786e\u8ba4\u6e05\u7a7a\u56de\u6536\u7ad9\uff1f",function(){this.setVisible(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u5220\u9664\u6570\u636e&hellip;",sticky:true});$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.CLEAR_RECYCLE+"&t="+(new Date().getTime()),FileUtils.bdstoken),function(A){if(A.errno==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u56de\u6536\u7ad9\u5df2\u6e05\u7a7a",sticky:false});FileUtils.clearCurrentDirCache();FileUtils.load(FileUtils.resolveCurrentDirKey());Utilities.scheduleQueryQuota();}else{var _=disk.util.ErrorMessage[A.errno]||"\u672a\u77e5\u9519\u8bef\uff0cerrno:"+A.errno;Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:_,sticky:false});}},"json").error(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u518d\u8bd5",sticky:false});});});return;}var C=FileUtils,B=FileUtils.getListViewCheckedItems();if(B.length==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5220\u9664\u6587\u4ef6\u6ca1\u6709\u9009\u62e9",sticky:true,closeType:true});return false;}else{if(B.length>100){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u4e00\u6b21\u64cd\u4f5c\u6587\u4ef6\u4e0d\u53ef\u8d85\u8fc7100\u4e2a",sticky:false});FileUtils._mDiskLog.send({type:"click_remove_more_than_100"});return false;}}_=disk.Context.getService(disk.Context.SERVICE_DIALOG);_.setVisible(true);_.setMessage("\u5f7b\u5e95\u5220\u9664","\u6587\u4ef6\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\uff0c\u60a8\u786e\u8ba4\u8981\u5f7b\u5e95\u5220\u9664\u6240\u9009\u6587\u4ef6\u5417\uff1f",function(){this.setVisible(false);Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u5220\u9664\u6570\u636e&hellip;",sticky:true});var C={};C.fidlist=[];for(var A=0,_=B.length;A<_;A++){C.fidlist.push(B[A].fs_id);}C.fidlist="["+C.fidlist+"]";$.post(disk.api.RestAPI.normalize(disk.api.RestAPI.DELETE_RECYCLE,FileUtils.bdstoken),C,function(C){var B=null,_=disk.ui.Toast.MODE_SUCCESS;if(C.errno==0){B="\u5f7b\u5e95\u5220\u9664\u6587\u4ef6\u6210\u529f";}else{B=disk.util.ErrorMessage[C.errno]||"\u672a\u77e5\u9519\u8bef\uff0cerrno:"+C.errno;_=disk.ui.Toast.MODE_CAUTION;}var A=disk.Context.getService(disk.Context.SERVICE_TOAST);A.setVisible(false);A.pending(function(){Utilities.useToast({toastMode:_,msg:B,sticky:false});});FileUtils.getLocalCache().removeAll();FileUtils.issueProxyLoading(true);FileUtils.loadDir(FileUtils.ROOT_ID);Utilities.scheduleQueryQuota();Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});},"json").error(function(){var _=disk.Context.getService(disk.Context.SERVICE_TOAST);_.setVisible(false);_.pending(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u7f51\u7edc\u9519\u8bef\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});});FileUtils.getLocalCache().removeAll();FileUtils.issueProxyLoading(true);FileUtils.loadDir(FileUtils.ROOT_ID);Utilities.scheduleQueryQuota();Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,msg:"\u6b63\u5728\u52a0\u8f7d\u6570\u636e\uff0c\u8bf7\u7a0d\u5019&hellip;",sticky:true});});});},dispatchActionPerformed:function(B,E,C){if(Page.inViewMode(Page.VIEW_HOME)){switch(B){case Page.MENU_RENAME:switch(FileUtils._mViewMode){case FileUtils.VIEW_GRID_ICON:case FileUtils.VIEW_GRID_THUMB:var A=FileUtils._mInfiniteGridView.getCheckedItems();if(A.length>0){FileUtils.prepareFolderBuilder(FileUtils.UPDATE,A[0],FileUtils._mInfiniteGridView.getFirstCheckedChild(),false);}break;case FileUtils.VIEW_LIST:default:A=FileUtils._mInfiniteListView.getCheckedItems();if(A.length>0){FileUtils.prepareFolderBuilder(FileUtils.UPDATE,A[0],FileUtils._mInfiniteListView.getFirstCheckedChild(),false);}break;}break;case Page.MENU_DELETE:this.performSelectionDelete();break;case Page.MENU_SHARE:var H=this,D=FileUtils.getListViewCheckedItems();H.performSelectionShareAll(D);break;case Page.MENU_DEVICE:case Page.MENU_PUBLIC:var D=FileUtils.getListViewCheckedItems(),H=this,G=C;if(G.preventDefault){G.preventDefault();}if(G.stopPropagation){G.stopPropagation();}return true;case Page.MENU_COPY:case Page.MENU_MOVE:var _=E.getAttribute("_data")||C.target.getAttribute("_data"),F,H=this;if(Page.obtain()._mMoveCopyDialog==null){ark.use({url:["/buss/dialog/move_copy_dialog.js","/dialog/copy-move-dialog.css"],noDependency:true},function(){Utilities.useCloseToast();if(typeof disk.ui.MoveCopyDialog!="undefined"){Page.obtain()._mMoveCopyDialog=new disk.ui.MoveCopyDialog();F=(_.indexOf("copy")||_.indexOf("copy"))!=-1?disk.ui.MoveCopyDialog.COPY:disk.ui.MoveCopyDialog.MOVE;H.performSelectionMoveCopy(F);}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u590d\u5236\u79fb\u52a8\u7ec4\u4ef6\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5",sticky:false});}});}else{F=(_.indexOf("copy")||_.indexOf("copy"))!=-1?disk.ui.MoveCopyDialog.COPY:disk.ui.MoveCopyDialog.MOVE;H.performSelectionMoveCopy(F);}break;case Page.MENU_UPLOAD:this.performUpload();break;case Page.MENU_NEW_FOLDER:FileUtils.prepareFolderBuilder(FileUtils.CREATE);break;case Page.MENU_SELL_FILE_BIG:Page.obtain().installSellDialog();break;case Page.MENU_DEVICE:break;case Page.MENU_SELL_FILE:Page.obtain().installSellDialog();break;case Page.MENU_BAR_SELL_FILE:Page.obtain().installSellDialog();break;case Page.MENU_ANOTHER_DOWNLOAD:return this.performSelectionDownload();case Page.MENU_NEW_OFFLINE:if(FileUtils._mNewOffline==null){FileUtils._mNewOffline=disk.ui.NewOfflineDialog.obtain();}FileUtils._mNewOffline.setVisible(true);break;case Page.MENU_OFFLINE_LIST:if(FileUtils._mOfflineList==null){FileUtils._mOfflineList=disk.ui.OfflineListDialog.obtain();}FileUtils._mOfflineList.setVisible(true);try{FileUtils._mDiskLog.send({type:"offlinelist2_loadedlist"});}catch(G){}break;case Page.MENU_NEW_BT_OFFLINE:break;case Page.MENU_PRINT:this.performSelectPrint();break;case Page.MENU_REVISION_LIST:this.performRevisionList();break;case Page.MENU_EDIT_PIC:this.performSelectionEditPic("box");break;}}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){switch(B){case Page.MENU_DOWNLOAD:return this.performSelectionDownload();case Page.MENU_TRANSFER:this.performSelectionTransfer();break;case Page.MENU_ALLFILEDOWNLOAD:this.performAllDownload();break;case Page.MENU_ALLFILETRANSFER:this.performAllTransfer();break;}}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){this.performSelectionCancelShare();}else{if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){switch(B){case Page.MENU_RESTORE:this.performSelectionRestore();return true;case Page.MENU_PERSIST_REMOVE:this.performSelectionRemoval();return true;case Page.MENU_CLEAR_ALL:this.performSelectionRemoval(true);return true;}}}}}return false;},installUploadFeature:function(){var _=this;if($("#barCmdUpload").length>0){if(disk.api.RestAPI.ACTIVEX_USE_UPGRADE_STRATEGY){$.ajax({url:disk.api.RestAPI.ACTIVEX_UPGRADE+"&t="+(new Date().getTime()),type:"GET",timeout:3000,success:function(B,C){var A=null;try{A=$.parseJSON(B);if(A.errorno==0&&typeof A.content!="undefined"){A=A.content[0];}if(typeof A.release!="undefined"&&typeof A.force!="undefined"){disk.ui.NativePluginFileUploader.forceUpgrade=parseInt(A.force);disk.ui.NativePluginFileUploader.upgradeVersion=A.release;disk.ui.UploadDialog.UPGRADE_TEXT='<i class="up-dd-tip"></i><dfn class="txt1 tips-prx ellipsis">'+A.ext+'</dfn><a target="_blank" class="two-pix-btn" href="//bs.baidu.com/netdisk/UploadPlugin_%s.exe">\u66f4\u65b0\u5b89\u88c5</a>';}}catch(D){}finally{_._install0();}},error:function(){_._install0();}});}else{this._install0();}}},_install0:function(){this._mUploadDialog=new disk.ui.UploadDialog({pane:$("#uploadDialog")[0],trigger:document.getElementById("barCmdUpload").parentNode,dndDropZone:$("#netdiskTips").parent().parent().get(0),dndSurroundingZone:document.documentElement,dndMarkContainer:document.body});this._mUploadDialog.install();},resolvePublicSharingIcon:function(A){var A=FileUtils.getLocalCache()._mCache[0],_=A[0].server_filename.match(/(.[^\.]+$)/);FileUtils.resolveFileSmallIcon(A[0].isdir,A,_?_[1]:"",$(".link-title .sprite-list-ic"),FileUtils.isInParticularDir(FileUtils.parseDirPath(A[0].path))?FileUtils.PART_KID_FOLDER:0);},reportCDNOfPCS:function(A){var _=new Image();_.src="http://dq.baidu.com/nocipher?pid=pcstest&ver=0&type=0&t="+(new Date().getTime())+"&success="+A;},watchCDNOfPCS:function(){return;var _=new Image(),A=this;_.onload=function(){A.reportCDNOfPCS(0);};_.onerror=function(){A.reportCDNOfPCS(1);};_.src="http://cdn.baidupcs.com/monitor.jpg?xcode=1a81b0bbd448fc368d78cc336e28561a&t="+(new Date().getTime());},newUserFromShareLink:function(){if(disk.getParam("from")=="share_activate_guide"||disk.getParam("from")=="share_notfound"){setTimeout(function(){Utilities.useToast({toastMode:disk.ui.Toast.MODE_SUCCESS,msg:"\u606d\u559c\u4f60\uff0c\u4f60\u662f\u767e\u5ea6\u4e91\u7f51\u76d8\u7684\u7528\u6237\u5566\uff0c5G\u6c38\u4e45\u514d\u8d39\u7a7a\u95f4\u5c5e\u4e8e\u4f60\u4e86\u3002",stiky:true,closeType:true});},2000);}},compilePingBack:function(){var B=document.referrer,_="fm_self",C=/(http|https)\:\/\/(tieba|hao123)\.baidu\.com/gi,A=/(http|https)\:\/\/www\.hao123\.com/gi;if(typeof B=="string"&&B.length>0){if(C.test(B)){_="fm_"+RegExp.$2;}else{if(A.test(B)){_="fm_hao123";}else{if(B.indexOf("http://www.baidu.com/s?wd=")!=-1){_="fm_baidups";}else{if(Page.getCookie("BDSFRCVID").length>0){_="fm_alading";}else{_="fm_not_proved";}}}}}if(disk.DEBUG){console.log("compiling ping back, resolve to ",_);}return _;},killFrame:function(){var _="frm",A=disk.getParam(_);if(top!==self&&A!="hao123-iframe"){}},playMusicAll:function(){var H=this,G="",A=FileUtils._mLocalCache.obtain('\u5206\u7c7b:"\u97f3\u4e50"');if(A.length==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5f53\u524d\u5217\u8868\u4e3a\u7a7a\uff0c\u8bf7\u6dfb\u52a0\u97f3\u4e50\u6587\u4ef6",sticky:false});return false;}var D=null;if(FileUtils._mViewMode==0){D=FileUtils._mInfiniteListView;}else{D=FileUtils._mInfiniteGridView;}function E(C){for(var B=0,_=C.length;B<_;B++){if(B===(_-1)){G+='"'+A[B].fs_id+'"';}else{G+='"'+A[B].fs_id+'",';}}G="["+G+"]";FileUtils.getDlink(G,"dlink",function(B){var D=B.dlink;if(D.length>=1){for(var A=0,_=D.length;A<_;A++){C[A].link=Page.obtainDownloadURL(D[A])+"&use=1";}}else{if(D.length===0){C.link=Page.obtainDownloadURL(D)+"&use=1";}}if(FileUtils._mMboxPlayer==null){FileUtils._mMboxPlayer=new disk.ui.MusicBox(C);}else{if(!FileUtils._mMboxPlayer._mDisplay){FileUtils._mMboxPlayer._reInit();FileUtils._mMboxPlayer.clearList();FileUtils._mMboxPlayer.setVisible(true);FileUtils._mMboxPlayer.addMusicData(C,true);}else{FileUtils._mMboxPlayer.clearList();FileUtils._mMboxPlayer.resetList(C,true);}}});}if(D.isAllItemChecked()){var C=[{songId:FileUtils._mMboxPlayerIndex++,songName:FileUtils.parseDirFromPath(A[0].path),fs_id:A[0].fs_id,link:Page.obtainDownloadURL(A[0])+"&use=1"}];for(var B=1,_=A.length;B<_;B++){C.push({songId:FileUtils._mMboxPlayerIndex++,songName:FileUtils.parseDirFromPath(A[B].path),fs_id:A[B].fs_id,link:Page.obtainDownloadURL(A[B])+"&use=1"});}if(A[0].dlink){if(FileUtils._mMboxPlayer==null){FileUtils._mMboxPlayer=new disk.ui.MusicBox(C);}else{if(!FileUtils._mMboxPlayer._mDisplay){FileUtils._mMboxPlayer._reInit();FileUtils._mMboxPlayer.clearList();FileUtils._mMboxPlayer.setVisible(true);FileUtils._mMboxPlayer.addMusicData(C,true);}else{FileUtils._mMboxPlayer.clearList();FileUtils._mMboxPlayer.resetList(C,true);}}}else{E(C);}return false;}if(D._mCheckedChildren.length==0){Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u5f53\u524d\u9009\u62e9\u5217\u8868\u4e3a\u7a7a\uff0c\u8bf7\u9009\u62e9\u97f3\u4e50\u6587\u4ef6",sticky:false});return false;}var F=0;for(_=D._mCheckedChildren.length;F<_;F++){if(D._mCheckedChildren[F]===true){break;}}C=[{songId:FileUtils._mMboxPlayerIndex++,songName:FileUtils.parseDirFromPath(A[F].path),fs_id:A[F].fs_id,link:Page.obtainDownloadURL(A[0])+"&use=1"}];for(B=F+1,_=A.length;B<_;B++){if(D._mCheckedChildren[B]===true){C.push({songId:FileUtils._mMboxPlayerIndex++,songName:FileUtils.parseDirFromPath(A[B].path),fs_id:A[B].fs_id,link:Page.obtainDownloadURL(A[B])+"&use=1"});}}if(A[0].dlink){if(FileUtils._mMboxPlayer==null){FileUtils._mMboxPlayer=new disk.ui.MusicBox(C);}else{if(!FileUtils._mMboxPlayer._mDisplay){FileUtils._mMboxPlayer._reInit();FileUtils._mMboxPlayer.clearList();FileUtils._mMboxPlayer.setVisible(true);FileUtils._mMboxPlayer.addMusicData(C,true);}else{FileUtils._mMboxPlayer.clearList();FileUtils._mMboxPlayer.resetList(C,true);}}}else{E(C);}},main:function(){var G=this,F=$("#fileActionHeader");this.killFrame();var B=Page.getCookie("BDCLND");if(B&&B.length>0){FileUtils.BDCLND_TOKEN=B;}this.newUserFromShareLink();this.installLogFeature();FileUtils.bindDownloadClient();if(Page.inViewMode(Page.VIEW_HOME)){this._mToolbarMenuItems[Page.MENU_RENAME]=document.getElementById("barCmdRename");this._mToolbarMenuItems[Page.MENU_DELETE]=document.getElementById("barCmdDelete");this._mToolbarMenuItems[Page.MENU_SHARE]=document.getElementById("barCmdShareAll");this._mToolbarMenuItems[Page.MENU_PRINT]=document.getElementById("barCmdPrint");this._mToolbarMenuItems[Page.MENU_REVISION_LIST]=document.getElementById("barCmdRevision");this._mToolbarMenuItems[Page.MENU_COPY]=document.getElementById("barCmdCopy");this._mToolbarMenuItems[Page.MENU_MOVE]=document.getElementById("barCmdMove");this._mToolbarMenuItems[Page.MENU_UPLOAD]=document.getElementById("barCmdUpload");this._mToolbarMenuItems[Page.MENU_NEW_FOLDER]=document.getElementById("barCmdNewFolder");this._mToolbarMenuItems[Page.MENU_SELL_FILE_BIG]=document.getElementById("barCmdSellFile");this._mToolbarMenuItems[Page.MENU_DEVICE_OPEN]=document.getElementById("barCmdOpenDevice");this._mToolbarMenuItems[Page.MENU_BAR_SELL_FILE]=document.getElementById("barSellFile");this._mToolbarMenuItems[Page.MENU_ANOTHER_DOWNLOAD]=document.getElementById("barCmdDownload");this._mToolbarMenuItems[Page.MENU_PLAY_ALL]=document.getElementById("barCmdPlayAll");this._mToolbarMenuItems[Page.MENU_NEW_OFFLINE]=document.getElementById("barCmdNewOffline");this._mToolbarMenuItems[Page.MENU_OFFLINE_LIST]=document.getElementById("barCmdOffline");this._mToolbarMenuItems[Page.MENU_DEVICE]=document.getElementById("barPushToDevice");this._mToolbarMenuItems[Page.MENU_EDIT_PIC]=document.getElementById("barCmdEdit");}else{if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){this._mToolbarMenuItems[Page.MENU_DOWNLOAD]=document.getElementById("barCmdDownload");this._mToolbarMenuItems[Page.MENU_TRANSFER]=document.getElementById("barCmdTransfer");this._mToolbarMenuItems[Page.MENU_ALLFILEDOWNLOAD]=document.getElementById("barAllCmdDownload");this._mToolbarMenuItems[Page.MENU_ALLFILETRANSFER]=document.getElementById("barAllCmdTransfer");}else{if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){this._mToolbarMenuItems[Page.MENU_CANCEL_SHARE]=document.getElementById("barCmdCancelShare");}else{if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){this._mToolbarMenuItems[Page.MENU_RESTORE]=document.getElementById("barCmdRestore");this._mToolbarMenuItems[Page.MENU_PERSIST_REMOVE]=document.getElementById("barCmdPersistDelete");this._mToolbarMenuItems[Page.MENU_CLEAR_ALL]=document.getElementById("barCmdPersistClear");}}}}if($.browser.msie){if($.browser.version==6){$('a[href="javascript:;"]').click(function(_){_.preventDefault();});$('a[href="javascript:;"]').live("click",function(_){_.preventDefault();});}}if(!Page.inViewMode(Page.VIEW_PROPERTY_OTHER)&&!Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){FileUtils.sendUserReport(this.compilePingBack());}if(Page.inViewMode(Page.VIEW_PROPERTY_OTHER)){this.resolvePublicSharingIcon();$("#cancelButton").click(function(){FileUtils.cancelShareInView({shareid_list:$.stringify([FileUtils.share_id])});});if(encodeURI(disk.getParam("third"))){u_href=$("a.link-usern").attr("href")+"&third="+encodeURI(disk.getParam("third"));$("a.link-usern").attr("href",u_href);}}if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)||Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){$(document).ready(function(){FileUtils.onPersonalPageTabChange("share");});}var C=function(B){if(this.className.indexOf("disabled")!=-1){return;}var A=this.getAttribute("_i");if(A==null){throw new Error("Menu Not Registered");}A=parseInt(A);var _=G.dispatchActionPerformed(A,this,B);if(!_){if(disk.DEBUG){console.log("Suppress a download event, hand it over");}return false;}return true;};for(var A=0,_=this._mToolbarMenuItems.length;A<_;A++){if(this._mToolbarMenuItems[A]==null){continue;}$(this._mToolbarMenuItems[A]).attr("_i",A);$(this._mToolbarMenuItems[A]).click(C);}$("#barDropdownTriggerMore").mouseenter(function(){$(this).parents("p:first").siblings(".pull-down-menu").css("left",$(this).offset().left-$("#fileActionHeader").offset().left+parseInt($("#fileActionHeader").parent().css("marginLeft"),10)).show();$(this).parents("p:first").siblings(".pull-down-menu").find("a").css("text-align","center");}).mouseleave(function(){$(this).parents("p:first").siblings(".pull-down-menu").hide();});$("#barPushToDeviceMore").mouseenter(function(_){$(this).parents("p:first").siblings(".device-menu").css({left:$(this).offset().left-$("#fileActionHeader").offset().left+parseInt($("#fileActionHeader").parent().css("marginLeft"),10),top:33}).show();Page.obtain().installDevice();}).mouseleave(function(){$(this).parents("p:first").siblings(".device-menu").hide();});$("#barCmdOpenDevice").mouseenter(function(_){if($(this).find("ul").length){$(this).find("ul").show();}else{$(this).append('<ul class="device-bar-more"><li><a alt="pushDevice" href="javascript:;">\u63a8\u9001\u4efb\u52a1\u5217\u8868</a></li><li><a alt="addDevice" href="javascript:;" >\u6dfb\u52a0\u8bbe\u5907</a></li></ul>');$(this).find("ul").show();}}).mouseleave(function(){$(this).find("ul").hide();}).bind({click:function(A){var _=A.target.getAttribute("alt");switch(_){case"pushDevice":Page.obtain().performOpenDevice();break;case"addDevice":Page.obtain().performAddDevice();break;default:break;}}});$("#fileActionHeader .pull-down-menu,#fileActionHeader .device-menu").mouseenter(function(){$(this).show();}).mouseleave(function(){$(this).hide();});$("#barCmdPublic, #barCmdMore, #userActions, #barUserInfo").hover(function(){if($(this).hasClass("disabled")==false){$(this).addClass("b-img-over");}},function(){$(this).removeClass("b-img-over");});$(".abtn,.bbtn,.cbtn,.ibtn,.ubtn,.robin-b-ic-query").click(function(){this.blur();});var D=function(){if(FileUtils.isListViewLocked()){return;}if(FileUtils.getViewMode()!=FileUtils.VIEW_LIST){return;}if(Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)||Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)){FileUtils._shareDropdownDrawerTrigger(null,true,200);}if(FileUtils._mPrecedeSortHandler==null||FileUtils._mPrecedeSortHandler!=this){$(".indicator").removeClass("desc").removeClass("asc");}$(this).toggleClass("desc");var _=$(this).hasClass("desc");if(_){$(this).removeClass("asc");}else{$(this).addClass("asc");}if(this.id.indexOf("time")!=-1){FileUtils.sortBy(FileUtils.SORT_BY_TIME,_);}else{if(this.id.indexOf("size")!=-1){FileUtils.sortBy(FileUtils.SORT_BY_SIZE,_);}else{if(this.id.indexOf("remaining")!=-1){FileUtils.sortBy(FileUtils.SORT_BY_REMAINING,_);}else{if(this.id.indexOf("vCnt")!=-1){FileUtils.sortBy(FileUtils.SORT_BY_VCNT,_);}else{if(this.id.indexOf("tCnt")!=-1){FileUtils.sortBy(FileUtils.SORT_BY_TCNT,_);}else{if(this.id.indexOf("dCnt")!=-1){FileUtils.sortBy(FileUtils.SORT_BY_DCNT,_);}else{FileUtils.sortBy(FileUtils.SORT_BY_NAME,_);}}}}}}FileUtils._mPrecedeSortHandler=this;FileUtils.getLocalCache().markDirty(true);return false;};if(Page.inViewMode(Page.VIEW_SHARE_PROPERTY_OWN)||Page.inViewMode(Page.VIEW_HOME_PAGE_SLAVE)){var E;if((E=disk.getParam("view"))&&E!=="share"){}else{FileUtils._mSortTriggers=[document.getElementById("nameCompareTrigger"),document.getElementById("timeCompareTrigger"),document.getElementById("vCntCompareTrigger"),document.getElementById("tCntCompareTrigger"),document.getElementById("dCntCompareTrigger")];FileUtils._mSortTriggers[0].onclick=FileUtils._mSortTriggers[1].onclick=FileUtils._mSortTriggers[2].onclick=FileUtils._mSortTriggers[3].onclick=FileUtils._mSortTriggers[4].onclick=D;}}else{if(document.getElementById("remainingCompareTrigger")){FileUtils._mSortTriggers=[document.getElementById("nameCompareTrigger"),document.getElementById("sizeCompareTrigger"),document.getElementById("timeCompareTrigger"),document.getElementById("remainingCompareTrigger")];FileUtils._mSortTriggers[0].onclick=FileUtils._mSortTriggers[1].onclick=FileUtils._mSortTriggers[2].onclick=FileUtils._mSortTriggers[3].onclick=D;}else{FileUtils._mSortTriggers=[document.getElementById("nameCompareTrigger"),document.getElementById("sizeCompareTrigger"),document.getElementById("timeCompareTrigger")];FileUtils._mSortTriggers[0].onclick=FileUtils._mSortTriggers[1].onclick=FileUtils._mSortTriggers[2].onclick=D;}}if(Page.inViewMode(Page.VIEW_RECYCLE_BIN)){FileUtils._mSortTriggers.push(document.getElementById("remainingCompareTrigger"));FileUtils._mSortTriggers[3].onclick=D;}$("#module-path").click(function(_){if(FileUtils._mQuerying){return false;}if(FileUtils.isListViewLocked()){return false;}disk.util.HistoryManager.getDefault().navigate(FileUtils.MODULE_DIR,null);_.preventDefault();_.stopPropagation();return false;});$("#module-type").click(function(_){if(FileUtils._mQuerying){return false;}if(FileUtils.isListViewLocked()){return false;}disk.util.HistoryManager.getDefault().navigate(FileUtils.MODULE_CATEGORY,null);_.preventDefault();_.stopPropagation();return false;});$("#barCmdViewList").click(function(){if(FileUtils.isListViewLocked()){return;}FileUtils.FLAG_USER_CHANGED_MODE=true;FileUtils.switchViewMode(FileUtils.VIEW_LIST);FileUtils.USER_VIEW_MODE=FileUtils.VIEW_LIST;return false;});$("#barCmdViewSmall").click(function(){if(FileUtils.isListViewLocked()){return;}FileUtils.FLAG_USER_CHANGED_MODE=true;FileUtils.switchViewMode(FileUtils.VIEW_GRID_ICON);FileUtils.USER_VIEW_MODE=FileUtils.VIEW_GRID_ICON;return false;});disk.util.HistoryManager.getDefault().listen(FileUtils.MODULE_SEARCH,function(A,_){if(typeof A.key=="undefined"){A.key="";}if(Page.inViewMode(Page.VIEW_HOME)){$("#tab-home").addClass("on");$("#aside-menu a.b-no-ln").removeClass("on");}$("#barCmdPlayAll").addClass("none");if(!_){$("#barCmdNewFolder").addClass("none");}G.performGlobalSearch(A.key,_);FileUtils.setModule(FileUtils.MODULE_DIR);if((FileUtils.getViewMode()!=FileUtils.USER_VIEW_MODE)){FileUtils.switchViewMode(FileUtils.USER_VIEW_MODE);}});disk.util.HistoryManager.getDefault().listen(FileUtils.MODULE_NOTI,function(A,_){if(_===true){return;}});disk.util.HistoryManager.getDefault().listen(FileUtils.MODULE_CATEGORY,function(A,_){if(disk.DEBUG){console.log(">>>>>>>>>switch to category");}if(FileUtils.isListViewLocked()){return;}if(_===true){return;}if(typeof A.type=="undefined"){A.type="";}else{$(".b-list-3 a","#aside").removeClass("on");$(".b-list-3 a[cat="+A.type+"]").addClass("on");}if(!_){$("#barCmdNewFolder").addClass("none");}G.performCategory(A.type);FileUtils.setModule(FileUtils.MODULE_CATEGORY);});$(".type-a-mus").click(function(_){Page.obtain().performType(0);_.preventDefault();return false;});$(".type-a-pic").click(function(_){if($(this).attr("href")!="/disk/timeline"){Page.obtain().performType(1);}else{window.location.href="/disk/timeline";}_.preventDefault();return false;});$(".type-a-mov").click(function(_){Page.obtain().performType(2);_.preventDefault();return false;});$(".type-a-doc").click(function(_){Page.obtain().performType(3);_.preventDefault();return false;});$(".type-a-app").click(function(_){Page.obtain().performType(6);_.preventDefault();return false;});$(".type-a-oth").click(function(_){Page.obtain().performType(5);_.preventDefault();return false;});Page.changeUnionLogin();this.watchCDNOfPCS();},installAwardIntrDialog:function(){var _=localStorage.getItem(FileUtils.AWARD_DIALOG_INSTALL+"_"+FileUtils.sysUID.replace(/@/g,""));if(_){return;}$.getScript("/res/static/js/buss/award_intr.js?t=201606291532",function(){if(typeof disk.ui.AwardIntr=="undefined"){if(disk.DEBUG){console.log("loaded awardIntr dialog failed");}return;}else{$.ajax({type:"POST",timeout:3000,url:disk.api.RestAPI.TASK_QUERY+"?detail=1&t="+(new Date().getTime()),dataType:"json",success:function(_){if(_&&_.errno==0){FileUtils.showAwardIntrDialog(_);}else{return false;}}}).error(function(){return false;});}});},installSellDialog:function(A){if(FileUtils.third!=0){if(typeof disk.util.bindBDPass=="undefined"){ark.use({url:["/ccres/static/js/buss/bindBDPass.js","/ccres/static/css/bind_pass.css"],noDependency:false,enforceUrl:true},function(_){disk.util.bindBDPass.bindDialog();});}else{disk.util.bindBDPass.bindDialog();}return;}function _(){var B=new disk.ui.SellDialog();B.setVisible(true);if(A){return;}var _=FileUtils.getListViewCheckedItems();B.pushFileList(_);}if(!disk.ui.SellDialog){Utilities.useToast({toastMode:disk.ui.Toast.MODE_LOADING,position:disk.ui.Panel.TOP,msg:"\u8d44\u6e90\u52a0\u8f7d\u4e2d&hellip;",sticky:false});ark.use({url:["/ppres/static/css/send_box.css","/ppres/static/js/buss/send_box.js","/res/static/css/sell_dialog.css","/res/static/js/util/form_helper.js","/res/static/js/buss/dialog/yun_sell_dialog_tpl.js","/res/static/js/buss/dialog/sell_dialog.js"],noDependency:true,enforceUrl:true},function(){disk.Context.getService(disk.Context.SERVICE_TOAST).setVisible(false);_();});}else{_();}},installDevice:function(){var A=FileUtils.getListViewCheckedItems(),B=function(){if(_+1){clearTimeout(_+1);}if(FileUtils._mPushDevice==null){ark.use({url:["/buss/dialog/push_device_dialog.js","/dialog/push-yun-device-dialog.css"],noDependency:false},function(){if(typeof disk.ui.PushDeviceDialog=="function"){FileUtils._mPushDevice=new disk.ui.PushDeviceDialog();FileUtils._mPushDevice.build(A);}else{Utilities.useToast({toastMode:disk.ui.Toast.MODE_CAUTION,msg:"\u8bbe\u5907\u63a8\u9001\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5",sticky:false});}});}else{FileUtils._mPushDevice.rebuild(A);}},_=setTimeout(function(){B();},600);},installBTDialog:function(){$.getScript("/res/static/js/buss/dialog/createoffline_bt_dialog.js?t=201606291532",function(){if(typeof disk.ui.ResolveBTDialog=="undefined"){if(disk.DEBUG){console.warn("loaded ResolveBTDialog failed");}return;}else{if(FileUtils.getFlagHaveBTPlugs()){if(FileUtils.bt_paths&&FileUtils.bt_paths.length>0&&Page.inViewMode(Page.VIEW_HOME)){if(disk.DEBUG){console.log("btpaths: ",FileUtils.bt_paths);}FileUtils.bt_paths=FileUtils.bt_paths.replace(/&quot;/g,'"');var _=null;try{_=$.parseJSON(FileUtils.bt_paths);}catch(A){if(disk.DEBUG){console.warn("bt_paths error");}}if(disk.DEBUG){console.log(_);}if(_&&(_ instanceof Array)&&_.length>0){if(disk.DEBUG){console.log("start resolve bt list");}disk.ui.ResolveBTList.init(_);}}}}});},installLogFeature:function(){FileUtils._mDiskLog=new disk.FELog({url:disk.api.RestAPI.ANALYTICS,logObjectName:"fe_log",baseParam:{page:Page.inViewMode(),clienttype:0},sendBaseParamTag:false});}};(function(){function _(_){if(_){this.url=""||_.url;this.logObjectName="fe_log_"||_.logObjectName;this.baseParam=null||_.baseParam;this.sendBaseParamTag=_.sendBaseParamTag||true;}else{this.url="";this.logObjectName="fe_log_";this.baseParam=null;this.sendBaseParamTag=true;}this.UrlLength=900;}_.prototype={send:function(E){var H,G=E.url||this.url,D=new Date().getTime(),A={};if(this.sendBaseParamTag){for(H in this.baseParam){A[H]=(typeof this.baseParam[H]=="function")?this.baseParam[H]():this.baseParam[H];}}var F={};for(H in E){if(H!="url"){F[H]=(typeof E=="function")?E[H]():E[H];}}var C=this._getRequestUrl(D,G,A,F);for(var B=0,_=C.length;B<_;B++){this._request(D,B,C[B]);}},_request:function(B,_,C){var D=this.logObjectName+"_"+B+"_"+_;window[D]=new Image();var A=window[D];A.onload=(A.onerror=function(){window[D]=null;});A.src=C;A=null;},_getRequestUrl:function(C,L,F,M){var D,J=[],E=[];if(F){for(D in F){E.push(D+"="+F[D]);}}E=E.join("&");E=(E=="")?"":"&"+E;var B=L+"?_lsid="+C+"&_lsix=1"+E,H=1;for(D in M){if(Object.prototype.toString.apply(M[D])==="[object Array]"){var G=M[D],I=[],A=B.length+D.length+2;for(var K=0,_=G.length;K<_;K++){A+=G[K].length+1;if(A>this.UrlLength){J.push(B+"&"+D+"="+I.join());H++;I=[];A=B.length+D.length+2;B=L+"?_lsid="+C+"&_lsix="+H+E;K--;}else{I.push(G[K]);}}if(I.length>0){B+="&"+D+"="+I.join();}}else{if(B.length+D.length>this.UrlLength){J.push(B);H++;B=L+"?_lsid="+C+"&_lsix="+H+E;}B+="&"+D+"="+M[D];}}J.push(B);return J;}};disk.FELog=_;})();